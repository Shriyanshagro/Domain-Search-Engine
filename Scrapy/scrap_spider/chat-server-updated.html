<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1.0">
<meta id="appname" name="apple-mobile-web-app-title" content="FastMail Blog">
<meta name="theme-color" content="#44557e">
<meta name="description" content="We've had a couple of persistent problems with our XMPP chat server since upgrading to Ejabberd (3.0 pre-release with patches) last year.">
<title>Chat server updated | FastMail Blog</title>

<meta property="og:image" content="https://www.fastmail.com/static/images/app-icon-256.png">
<meta property="og:type" content="website">
<meta property="og:site_name" content="FastMail Blog">
<meta property="og:title" content="Chat server updated">
<meta property="og:description" content="We've had a couple of persistent problems with our XMPP chat server since upgrading to Ejabberd (3.0 pre-release with patches) last year.">
<meta property="og:url" content="https://blog.fastmail.com/2012/08/07/chat-server-updated/">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.fastmail.com/static/images/app-icon-256.png">
<meta name="twitter:site" content="@FastMailFM">
<meta name="twitter:creator" content="@FastMailFM">
<meta name="twitter:url" content="https://blog.fastmail.com/2012/08/07/chat-server-updated/">
<meta name="twitter:title" content="Chat server updated">
<meta name="twitter:description" content="We've had a couple of persistent problems with our XMPP chat server since upgrading to Ejabberd (3.0 pre-release with patches) last year.">

<link rel="canonical" href="https://blog.fastmail.com/2012/08/07/chat-server-updated/">
<link rel="alternate" type="application/rss+xml" title="FastMail Blog" href="https://blog.fastmail.com/feed/">

<link rel="apple-touch-icon" sizes="152x152" href="https://www.fastmail.com/static/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.fastmail.com/static/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.fastmail.com/static/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.fastmail.com/static/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.fastmail.com/static/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.fastmail.com/static/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="https://www.fastmail.com/static/favicons/apple-touch-icon-57x57.png">
<link rel="shortcut icon" sizes="196x196" href="https://www.fastmail.com/static/favicons/touch-icon-196x196.png">
<link rel="shortcut icon" sizes="64x64" href="https://www.fastmail.com/static/favicons/icon-64x64.png">
<link rel="shortcut icon" sizes="32x32" href="https://www.fastmail.com/static/favicons/icon-32x32.png">

<link rel="stylesheet" type="text/css" href="https://www.fastmail.com/static/styles/main.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400italic,700">
<script type="text/javascript" src="https://www.fastmail.com/static/scripts/fontloaded.js"></script>
</head>
<body>

<div id="header" class="fixed">
<div id="home"><a href="https://www.fastmail.com/"><img src="https://www.fastmail.com/static/images/logo.png" width="176" height="44" alt="FastMail"></a></div>
<ul id="nav">
<li><b>Blog</b></li>
<li><a href="https://www.fastmail.com/help/">Support</a></li>
<li><a href="https://www.fastmail.com/signup/">Sign up</a></li>
<li><a href="https://www.fastmail.com/">Our service</a></li>
</ul>
</div>

<div id="page">
<div id="bg"></div>

<div class="article">

<h1><a href='https://blog.fastmail.com/2012/08/07/chat-server-updated/'>Chat server updated</a></h1>
<p class="blog-author">Bron Gondwana &ndash;  7 August 2012</p>
<p>We've had a couple of persistent problems with our XMPP chat server
since upgrading to Ejabberd (3.0 pre-release with patches) last year.</p>

<ol>
<li>"Malformed XML" errors.  We suspect these were due to bugs with
handling SSL.</li>
<li>Missing IP address and SSL information in the LoginLog.</li>
<li>ChatLog backend died, and chat logging stopped.</li>
</ol>

<p>We have our awesome intern Samuel back again this year, and though he's
working with a different department this time - I managed to grab some
of his time to work with me on fixing these long standing issues!</p>

<p>We think we've fixed number 1 - at least it hasn't been seen since
updating the upstream libraries.</p>

<p>We're positive we've fixed number 2, by making sure the correct
information is passed directly to the authentication functions rather
than looking for it in the session object (which isn't populated in time
to be useful)</p>

<p>And as for number 3 - a restart fixed it.  I'm now monitoring the log
files to look for what might cause it to die.  Unfortunately, by the
time we looked at it the logs had already rotated away, so there was no
evidence left!  I'll make sure we catch the problem next time, if it
happens again. <br />
 TL;DR - chat server is updated and should be more stable and give
better information than before.</p>

<p> </p>


<div class="blog-footer">

<p class="blog-footerPrev">«︎ <a href="https://blog.fastmail.com/2012/07/16/now-enforcing-ssltls-encryption-on-all-imappopsmtpldap-connections/">Now enforcing SSL/TLS encryption on all IMAP/POP/SMTP/LDAP connections</a></p>


<p class="blog-footerNext"><a href="https://blog.fastmail.com/2012/09/06/fastmail-fm-certificate-updated/">*.fastmail.fm certificate updated</a> »︎</p>


<p class="blog-footerThanks">Thanks for reading the FastMail Blog: news, views and the occasional rant from the FastMail team. Want to keep up to date? Subscribe to our <a href="/feed/">RSS feed</a>, or sign up below and weʼll email you every time we post something new.</p>

<form method="post" action="https://www.listbox.com/subscribe/" style="text-align:center">
    <input type="hidden" name="action" value="subscribe">
    <input type="hidden" name="list_id" value="273399">
    <input type="hidden" name="redirect" value="listbox">
    <input type="text" class="text" name="username" placeholder="Email address" style="margin-bottom:7px;width:250px;">
    <button type="submit" class="button suggestedAction" style="margin-left:3px;padding: 6px 24px 7px;">Subscribe</button>
</form>

</div>

<div id="breadcrumbs">
<div style="float:right">
    <a href="/">Latest News</a>
    &nbsp;&nbsp;
    <a href="/archive/">Archive</a>
</div>
</div>

</div> <!-- End div.article -->

</div> <!-- End div#page -->

<div id="footer"><div class="content">
    <div class="left">Copyright &copy; 1999&ndash;2016 FastMail Pty Ltd.</div>
    <div class="right"><a href="https://www.fastmail.com/help/legal/privacy.html">Privacy policy</a> <a href="https://www.fastmail.com/help/legal/tos.html">Terms of service</a></div>
</div></div>
</body>
</html>
