<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/QAPage">
<head>

<title>sql - Best way to get identity of inserted row? - Stack Overflow</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/Sites/stackoverflow/img/favicon.ico?v=4f32ecc8f43d">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon.png?v=c78bd457575a">
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content="stackoverflow.com"/>
    <meta property="og:type" content="website" />    
    <meta property="og:image" itemprop="image primaryImageOfPage" content="http://cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon@2.png?v=73d79a89bded&a" />
    <meta name="twitter:title" property="og:title" itemprop="title name" content="Best way to get identity of inserted row?" />
    <meta name="twitter:description" property="og:description" itemprop="description" content="What is the best way to get identity of inserted row?

I know about @@IDENTITY and IDENT_CURRENT and SCOPE_IDENTITY but don&#39;t understand the pros and cons attached to each.

Can someone please expl..." />
    <meta property="og:url" content="http://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row"/>
    <link rel="canonical" href="http://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row" />

    
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=547d6ef0a2b2"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/Sites/stackoverflow/all.css?v=fa9dc9346d8c">

            <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Best way to get identity of inserted row?&#39;" href="/feeds/question/42648">
            <meta name="twitter:app:country" content="US" />
            <meta name="twitter:app:name:iphone" content="Stack Exchange iOS" />
            <meta name="twitter:app:id:iphone" content="871299723" />
            <meta name="twitter:app:url:iphone" content="se-zaphod://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row" />
            <meta name="twitter:app:name:ipad" content="Stack Exchange iOS" />
            <meta name="twitter:app:id:ipad" content="871299723" />
            <meta name="twitter:app:url:ipad" content="se-zaphod://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row" />
            <meta name="twitter:app:name:googleplay" content="Stack Exchange Android">
            <meta name="twitter:app:url:googleplay" content="http://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row">
            <meta name="twitter:app:id:googleplay" content="com.stackexchange.marvin">
        <script>
        
            StackExchange.ready(function () {
                    
                    StackExchange.using("snippets", function () {
                        StackExchange.snippets.initSnippetRenderer();
                    });
                    

                StackExchange.using("postValidation", function () {
                    StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
                });

                
                StackExchange.question.init({showAnswerHelp:true,totalCommentCount:0,shownCommentCount:0,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:42648});

                styleCode();

                    StackExchange.realtime.subscribeToQuestion('1', '42648');
                                                                    StackExchange.using("gps", function () { StackExchange.gps.trackOutboundClicks('#content', '.post-text'); });

            });
        </script>


    <script>
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","networkMetaHostname":"meta.stackexchange.com","serverTime":1462484717,"routeName":"Questions/Show","styleCode":true,"enableUserHovercards":true,"snippets":{"enabled":true,"domain":"stacksnippets.net"},"site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","recaptchaAudioLang":"en","enableNewTagCreationWarning":true,"insertSpaceAfterNameTabCompletion":false,"id":1,"enableSocialMediaInSharePopup":true},"user":{"fkey":"a13af72b54e2677d414be5d78af7b54f","rep":0,"isAnonymous":true,"isAnonymousNetworkWide":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"8aed2ce2a6d6","js/moderator.en.js":"c03231fe5b71","js/full-anon.en.js":"9fec08f4a58f","js/full.en.js":"1110056cfd6f","js/wmd.en.js":"2ca30b0296e2","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"e6f0e5e9e0cc","js/help.en.js":"c8004cc0095d","js/tageditor.en.js":"9c6df10dabc4","js/tageditornew.en.js":"347247692997","js/inline-tag-editing.en.js":"943c7090ea55","js/revisions.en.js":"2faaeaae2529","js/review.en.js":"a377ed440f19","js/tagsuggestions.en.js":"b278f9a0b23b","js/post-validation.en.js":"736d4bad187d","js/explore-qlist.en.js":"e71f14781288","js/events.en.js":"889adbe9ddc4","js/keyboard-shortcuts.en.js":"68cd1278bc11","js/external-editor.en.js":"692898ad9a5b","js/external-editor.en.js":"692898ad9a5b","js/snippet-javascript.en.js":"9ebbcd127425","js/snippet-javascript-codemirror.en.js":"5a662ef07414"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
    </script>
    
        <script>
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page new-topbar">
    <noscript><div id="noscript-padding"></div></noscript>
    
        <script>(function () { var old = $.fn.contents; $.fn.contents = function () { try { return old.apply(this, arguments); } catch (e) { return $([]); } } })()</script>
        <iframe id="adzerk-user-match" width="0" height="0" frameborder="0" scrolling="no" onload="window.AUMIframeDone=true"
                src="https://ssum-sec.casalemedia.com/usermatch?s=183712&amp;cb=https%3A%2F%2Fengine.adzerk.net%2Fudb%2F22%2Fsync%2Fi.gif%3FpartnerId%3D1%26userId%3D"
                style="display: none;" marginheight="0" marginwidth="0"></iframe>




    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>





<div class="topbar">
    <div class="topbar-wrapper">

        <div class="js-topbar-dialog-corral">


<div class="topbar-dialog siteSwitcher-dialog dno">
    <div class="header">
        <h3><a href="//stackoverflow.com">current community</a></h3>
    </div>
    <div class="modal-content current-site-container">
        <ul class="current-site">
                <li>
                        <div class="related-links">
                    <a href="http://chat.stackoverflow.com" class="js-gps-track"     data-gps-track="site_switcher.click({ item_type:6 })"
>chat</a>
            </div>




    <a href="//stackoverflow.com"
       class="current-site-link site-link js-gps-track"
       data-id="1"
       data-gps-track="
        site_switcher.click({ item_type:3 })">
        <div class="site-icon favicon favicon-stackoverflow" title="Stack Overflow"></div>
        Stack Overflow
    </a>

                </li>
                <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    



    <a href="http://meta.stackoverflow.com"
       class="site-link js-gps-track"
       data-id="552"
       data-gps-track="
            site.switch({ target_site:552, item_type:3 }),
        site_switcher.click({ item_type:4 })">
        <div class="site-icon favicon favicon-stackoverflowmeta" title="Meta Stack Overflow"></div>
        Meta Stack Overflow
    </a>

                </li>
                            <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    <a class="site-link js-gps-track"
                       href="//careers.stackoverflow.com?utm_source=stackoverflow.com&amp;utm_medium=site-ui&amp;utm_campaign=multicollider"
                            data-gps-track="site_switcher.click({ item_type:9 })"
>
                        <div class="site-icon favicon favicon-careers" title="Stack Overflow Careers"></div>
                        Stack Overflow Careers
                    </a>
                </li>
        </ul>
    </div>
    <div class="header" id="your-communities-header">
        <h3>
your communities        </h3>
            
    </div>
    <div class="modal-content" id="your-communities-section">
            
            <div class="call-to-login">
<a href="https://stackoverflow.com/users/signup?ssrc=site_switcher&amp;returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f42648%2fbest-way-to-get-identity-of-inserted-row" class="login-link js-gps-track"     data-gps-track="site_switcher.click({ item_type:10 })"
>Sign up</a> or <a href="https://stackoverflow.com/users/login?ssrc=site_switcher&amp;returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f42648%2fbest-way-to-get-identity-of-inserted-row" class="login-link js-gps-track"     data-gps-track="site_switcher.click({ item_type:11 })"
>log in</a> to customize your list.
            </div>
    </div>
    <div class="header">
        <h3><a href="//stackexchange.com/sites">more stack exchange communities</a></h3>
        <a href="http://blog.stackoverflow.com" class="fr">company blog</a>
    </div>
    <div class="modal-content">
            <div class="child-content"></div>
    </div>
</div>
        </div>

        <div class="network-items">

            <a href="//stackexchange.com"
               class="topbar-icon icon-site-switcher yes-hover js-site-switcher-button js-gps-track"
               data-gps-track="site_switcher.show"
               title="A list of all 155 Stack Exchange sites">
                <span class="hidden-text">Stack Exchange</span>
            </a>

    <a href="#"
       class="topbar-icon icon-inbox yes-hover js-inbox-button"
       title="Recent inbox messages">
        <span class="hidden-text">Inbox</span>
        <span class="unread-count" style="display:none"></span>
    </a>
    <a href="#"
       class="topbar-icon icon-achievements yes-hover js-achievements-button "
       data-unread-class=""
       title="Recent achievements: reputation, badges, and privileges earned">
        <span class="hidden-text">Reputation and Badges</span>
        <span class="unread-count" style="display:none">
            
        </span>
    </a>
        </div>

        <div class="topbar-links">

                <div class="links-container">
                <span class="topbar-menu-links">
                                    <a href="https://stackoverflow.com/users/signup?ssrc=head&returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f42648%2fbest-way-to-get-identity-of-inserted-row" class="login-link">sign up</a>
                                <a href="https://stackoverflow.com/users/login?ssrc=head&returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f42648%2fbest-way-to-get-identity-of-inserted-row" class="login-link">log in</a>

                        <a href="/tour">tour</a>
                            <a href="#" class="icon-help js-help-button" title="Help Center and other resources">
        help
        <span class="triangle"></span>
    </a>
    <div class="topbar-dialog help-dialog js-help-dialog dno">
        <div class="modal-content">
            <ul>
                                    <li>
                        <a href="/tour" class="js-gps-track" data-gps-track="help_popup.click({ item_type:1 })">
                            Tour
                            <span class="item-summary">
                                Start here for a quick overview of the site
                            </span>
                        </a>
                    </li>
                <li>
                    <a href="/help" class="js-gps-track" data-gps-track="help_popup.click({ item_type:4 })">
                        Help Center
                        <span class="item-summary">
                            Detailed answers to any questions you might have
                        </span>
                    </a>
                </li>
                    <li>
                        <a href="//meta.stackoverflow.com" class="js-gps-track" data-gps-track="help_popup.click({ item_type:2 })">
                            Meta
                            <span class="item-summary">
                                Discuss the workings and policies of this site
                            </span>
                        </a>
                    </li>
                <li>
                    <a href="http://stackoverflow.com/company/about" class="js-gps-track" data-gps-track="help_popup.click({ item_type:6 })">
                        About Us
                        <span class="item-summary">
                            Learn more about Stack Overflow the company
                        </span>
                    </a>
                </li>
                <li>
                    <a href="https://business.stackoverflow.com/?ref=topbar_help" class="js-gps-track" data-gps-track="help_popup.click({ item_type:7 })">
                        Business
                        <span class="item-summary">
                            Learn more about hiring developers or posting ads with us
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </div>

                    </span>
                </div>

            <div class="search-container">
                <form id="search" action="/search" method="get" autocomplete="off">
                    <input name="q" type="text" placeholder="Search Q&amp;A" value="" tabindex="1" autocomplete="off" maxlength="240" />
                </form>
            </div>

        </div>
    </div>
</div>
    <script>
        StackExchange.ready(function() { StackExchange.topbar.init(); });
    </script>

    <div class="container">
        <div id="header">
            <br class="cbt">
            <div id="hlogo">
                <a href="/" >
                    Stack Overflow
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs">
                    <ul>
                        <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-jobs" href="/jobs">Jobs</a></li>
                        <li><a id="nav-tags" href="/tags">Tags</a></li>
                        <li><a id="nav-users" href="/users">Users</a></li>
                        <li><a id="nav-badges" href="/help/badges">Badges</a></li>
                                            </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content" class="snippet-hidden">
            

<div itemscope itemtype="http://schema.org/Question">
    <link itemprop="image" href="//cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon.png?v=c78bd457575a">

<div id="herobox">
    <div id="hero-content">
            <div id="close"><a title="click to minimize">_</a></div>
        <div id="blurb">
            Stack Overflow is a community of 4.7 million programmers, just like you, helping each other.
            <br/>
                <br/>Join them; it only takes a minute:<br/>
            <br/>
            <a href="/users/signup?ssrc=hero&amp;returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f42648%2fbest-way-to-get-identity-of-inserted-row" id="tell-me-more" class="button">Sign up</a>
        </div>
        <div id="desc">
            <b>Join the Stack Overflow community to:</b>
            <ol id="hiw">
                <li id="q">Ask programming questions
                </li>
                <li id="an">Answer and help your peers
                </li>
                <li id="b">Get recognized for your expertise
                </li>
            </ol>
        </div>
        <div style="clear: both"></div>
    </div>
    <script>
        StackExchange.ready(function () {

            var location = 0;
            if ($("body").hasClass("questions-page")) {
                location = 1;;
            } else if ($("body").hasClass("question-page")) {
                location = 1;;
            } else if ($("body").hasClass("faq-page")) {
                location = 5;;
            } else if ($("body").hasClass("home-page")) {
                location = 3;;
            }

            $('#tell-me-more').click(function () {
                StackExchange.using("gps", function () {
                    StackExchange.gps.track("hero.action", { hero_action_type: 'cta', location: location }, true);
                });
            });
            $('#herobox #close').click(function () {
                StackExchange.using("gps", function () {
                    StackExchange.gps.track("hero.action", { hero_action_type: "minimize", location: location }, true);
                });
                $.cookie("hero", "mini", { path: "/", expires: 365 });
                $.ajax({
                    url: "/hero-mini",
                    success: function (data) {
                        $("#herobox").fadeOut("fast", function () {
                            $("#herobox").replaceWith(data);
                            $("#herobox-mini").fadeIn("fast");
                        });
                    }
                });
                return false;
            });
        });

    </script>
</div>
			<div id="question-header">
                <h1 itemprop="name"><a href="/questions/42648/best-way-to-get-identity-of-inserted-row" class="question-hyperlink">Best way to get identity of inserted row?</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="42648"  id="question">

    <div class="everyonelovesstackoverflow" id="careers1">
        </div>    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="42648">
        <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">540</span>
        <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>

        <a class="star-off" href="#">favorite</a>
        <div class="favoritecount"><b>194</b></div>


</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="text">

<p>What is the best way to get identity of inserted row?</p>

<p>I know about <code>@@IDENTITY</code> and <code>IDENT_CURRENT</code> and <code>SCOPE_IDENTITY</code> but don't understand the pros and cons attached to each.</p>

<p>Can someone please explain the differences and when I should be using each?</p>
    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/sql" class="post-tag" title="show questions tagged &#39;sql&#39;" rel="tag">sql</a> <a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a> <a href="/questions/tagged/tsql" class="post-tag" title="show questions tagged &#39;tsql&#39;" rel="tag">tsql</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/q/42648" title="short permalink to this question" class="short-link" id="link-post-42648">share</a><span class="lsep">|</span><a href="/posts/42648/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/42648/revisions" title="show all edits to this post">edited <span title="2011-10-04 12:00:17Z" class="relativetime">Oct 4 '11 at 12:00</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/447156/soner-g%c3%b6n%c3%bcl"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/8348bcf40f55bc5818651824369caff1?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/447156/soner-g%c3%b6n%c3%bcl">Soner G&#246;n&#252;l</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1</span>
        </div>
    </div>
</div>    </td>
    <td class="post-signature owner">
        <div class="user-info user-hover">
    <div class="user-action-time">
        asked <span title="2008-09-03 21:32:02Z" class="relativetime">Sep 3 '08 at 21:32</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/1583/oded"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/Au4eT.png?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1583/oded">Oded</a><span class="mod-flair" title="moderator">&#9830;</span>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 326,184" dir="ltr">326k</span><span title="50 gold badges"><span class="badge1"></span><span class="badgecount">50</span></span><span title="553 silver badges"><span class="badge2"></span><span class="badgecount">553</span></span><span title="758 bronze badges"><span class="badge3"></span><span class="badgecount">758</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
                
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-42648" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-42648" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>        </table>
</div>

			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								8 Answers
                                <span style="display:none;" itemprop="answerCount">8</span>
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/42648/best-way-to-get-identity-of-inserted-row?answertab=active#tab-top" data-nav-xhref="" title="Answers with the latest activity first" data-value="active">
            active</a>
        <a href="/questions/42648/best-way-to-get-identity-of-inserted-row?answertab=oldest#tab-top" data-nav-xhref="" title="Answers in the order they were provided" data-value="oldest">
            oldest</a>
        <a class="youarehere" href="/questions/42648/best-way-to-get-identity-of-inserted-row?answertab=votes#tab-top" data-nav-xhref="" title="Answers with the highest score first" data-value="votes">
            votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="42655"></a>
<div id="answer-42655" class="answer accepted-answer" data-answerid="42655"  itemscope itemtype="http://schema.org/Answer" itemprop="acceptedAnswer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="42655">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">698</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>



        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>

</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<ul>
<li><p><a href="http://msdn.microsoft.com/en-us/library/ms187342.aspx"><code>@@IDENTITY</code></a> returns the last identity value generated for any table in the current session, across all scopes.  <strong>You need to be careful here</strong>, since it's across scopes.  You could get a value from a trigger, instead of your current statement.</p></li>
<li><p><a href="http://msdn.microsoft.com/en-us/library/ms190315.aspx"><code>SCOPE_IDENTITY()</code></a> returns the last identity value generated for any table in the current session and the current scope.  <strong>Generally what you want to use</strong>.</p></li>
<li><p><a href="http://msdn.microsoft.com/en-us/library/ms175098.aspx"><code>IDENT_CURRENT('tableName')</code></a> returns the last identity value generated for a specific table in any session and any scope.  This lets you specify which table you want the value from, in case the two above aren't quite what you need (<strong>very rare</strong>).  Also, as @<a href="http://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row#42665">Guy Starbuck</a> mentioned, "You could use this if you want to get the current IDENTITY value for a table that you have not inserted a record into."</p></li>
<li><p>The <a href="http://msdn.microsoft.com/en-us/library/ms177564.aspx"><code>OUTPUT</code> clause</a> of the <code>INSERT</code> statement will let you access every row that was inserted via that statement.  Since it's scoped to the specific statement, it's <strong>more straightforward</strong> than the other functions above.  However, it's a little <strong>more verbose</strong> (you'll need to insert into a table variable/temp table and then query that) and it gives results even in an error scenario where the statement is rolled back.  That said, if your query uses a parallel execution plan, this is the <strong>only guaranteed method</strong> for getting the identity (short of turning off parallelism). However, it is executed <em>before</em> triggers and cannot be used to return trigger-generated values.</p></li>
</ul>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/42655" title="short permalink to this answer" class="short-link" id="link-post-42655">share</a><span class="lsep">|</span><a href="/posts/42655/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/42655/revisions" title="show all edits to this post">edited <span title="2016-04-12 13:30:23Z" class="relativetime">Apr 12 at 13:30</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/1366467/ninita"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/MkO2g.jpg?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1366467/ninita">Ninita</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">756</span><span title="8 silver badges"><span class="badge2"></span><span class="badgecount">8</span></span><span title="23 bronze badges"><span class="badge3"></span><span class="badgecount">23</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-09-03 21:38:23Z" class="relativetime">Sep 3 '08 at 21:38</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/2688/bdukes"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/f1df0c370bbfd32568f4914d9c771e9d?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/2688/bdukes">bdukes</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 78,849" dir="ltr">78.8k</span><span title="13 gold badges"><span class="badge1"></span><span class="badgecount">13</span></span><span title="108 silver badges"><span class="badge2"></span><span class="badgecount">108</span></span><span title="138 bronze badges"><span class="badge3"></span><span class="badgecount">138</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-42655" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="7"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-2098400" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="supernova">30</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">known bug with SCOPE_IDENTITY() returning the wrong values: <a href="http://blog.sqlauthority.com/2009/03/24/sql-server-2008-scope_identity-bug-with-multi-processor-parallel-plan-and-solution/" rel="nofollow">blog.sqlauthority.com/2009/03/24/&hellip;</a> the work around is to not run the INSERT in a Multi Processor Parallel Plan or use the OUTPUT clause</span>
                    &ndash;&nbsp;<a href="/users/65223/km"
                       title="64,166 reputation"
                       class="comment-user">KM.</a>
                <span class="comment-date" dir="ltr"><span title="2010-01-28 14:59:50Z" class="relativetime-clean">Jan 28 '10 at 14:59</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-7034140" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="hot">23</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">since this is the accepted answer, please add the output clause to your answer as this is the preferred way to do this in the newer versions fo SQL Server.</span>
                    &ndash;&nbsp;<a href="/users/9034/hlgem"
                       title="65,453 reputation"
                       class="comment-user">HLGEM</a>
                <span class="comment-date" dir="ltr"><span title="2011-05-20 14:50:41Z" class="relativetime-clean">May 20 '11 at 14:50</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-11648173" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">3</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy"><a href="http://support.microsoft.com/kb/2019779" rel="nofollow">support.microsoft.com/kb/2019779</a></span>
                    &ndash;&nbsp;<a href="/users/16076/mitch-wheat"
                       title="206,395 reputation"
                       class="comment-user">Mitch Wheat</a>
                <span class="comment-date" dir="ltr"><span title="2012-02-12 01:52:47Z" class="relativetime-clean">Feb 12 '12 at 1:52</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-11724422" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Almost every time I have ever wanted &#39;identity&#39;, I have wanted to know the key(s) of the record(s) I just inserted.  If that is your situation, you want to use the OUTPUT clause.  If you want something else, apply the effort to read and understand bdukes response.</span>
                    &ndash;&nbsp;<a href="/users/929277/jerry"
                       title="790 reputation"
                       class="comment-user">jerry</a>
                <span class="comment-date" dir="ltr"><span title="2012-02-15 15:48:37Z" class="relativetime-clean">Feb 15 '12 at 15:48</span></span>
                    <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-40225522" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="hot">21</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">To save others from panicing, the bug mentioned above was fixed in  Cumulative Update 5 for SQL Server 2008 R2 Service Pack 1.</span>
                    &ndash;&nbsp;<a href="/users/284598/gatechthomas"
                       title="1,128 reputation"
                       class="comment-user">GaTechThomas</a>
                <span class="comment-date" dir="ltr"><span title="2014-09-08 17:09:19Z" class="relativetime-clean">Sep 8 '14 at 17:09</span></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-42655" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link  dno"
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   ></a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link " title="expand to show all comments on this post" href=# onclick="">show <b>7</b> more comments</a>
        </div>         
    </td>
</tr>    </table>
</div>
<div class="everyonelovesstackoverflow" id="careers3">
        </div>
  
<a name="6073578"></a>
<div id="answer-6073578" class="answer" data-answerid="6073578"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="6073578">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">84</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I believe the safest and most accurate method of retrieving the inserted id would be  using the output clause.</p>

<p>for example (taken from the following <a href="http://msdn.microsoft.com/en-us/library/ms177564.aspx">MSDN</a> article)</p>

<pre><code>USE AdventureWorks2008R2;
GO
DECLARE @MyTableVar table( NewScrapReasonID smallint,
                           Name varchar(50),
                           ModifiedDate datetime);
INSERT Production.ScrapReason
    OUTPUT INSERTED.ScrapReasonID, INSERTED.Name, INSERTED.ModifiedDate
        INTO @MyTableVar
VALUES (N'Operator error', GETDATE());

--Display the result set of the table variable.
SELECT NewScrapReasonID, Name, ModifiedDate FROM @MyTableVar;
--Display the result set of the table.
SELECT ScrapReasonID, Name, ModifiedDate 
FROM Production.ScrapReason;
GO
</code></pre>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/6073578" title="short permalink to this answer" class="short-link" id="link-post-6073578">share</a><span class="lsep">|</span><a href="/posts/6073578/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/6073578/revisions" title="show all edits to this post">edited <span title="2011-05-20 15:11:28Z" class="relativetime">May 20 '11 at 15:11</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/2688/bdukes"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/f1df0c370bbfd32568f4914d9c771e9d?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/2688/bdukes">bdukes</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 78,849" dir="ltr">78.8k</span><span title="13 gold badges"><span class="badge1"></span><span class="badgecount">13</span></span><span title="108 silver badges"><span class="badge2"></span><span class="badgecount">108</span></span><span title="138 bronze badges"><span class="badge3"></span><span class="badgecount">138</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2011-05-20 14:43:54Z" class="relativetime">May 20 '11 at 14:43</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/70454/orry"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/b4a48beb862d7af43467b7a93901e98a?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/70454/orry">Orry</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1,084</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="9 silver badges"><span class="badge2"></span><span class="badgecount">9</span></span><span title="12 bronze badges"><span class="badge3"></span><span class="badgecount">12</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-6073578" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-7034092" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">3</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Yes this is the correct method going forward, only use one of the others if you are not on SQL Server 2008 (we skipped 2005 so not sure if OUTPUT was available then)</span>
                    &ndash;&nbsp;<a href="/users/9034/hlgem"
                       title="65,453 reputation"
                       class="comment-user">HLGEM</a>
                <span class="comment-date" dir="ltr"><span title="2011-05-20 14:48:26Z" class="relativetime-clean">May 20 '11 at 14:48</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-7034638" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@HLGEM There&#39;s an <a href="http://msdn.microsoft.com/en-us/library/ms177564%28v=SQL.90%29.aspx" rel="nofollow">MSDN page for <code>OUTPUT</code> in SQL Server 2005</a>, so looks like it&#39;s just SQL Server 2000 and earlier that are without it</span>
                    &ndash;&nbsp;<a href="/users/2688/bdukes"
                       title="78,849 reputation"
                       class="comment-user">bdukes</a>
                <span class="comment-date" dir="ltr"><span title="2011-05-20 15:14:17Z" class="relativetime-clean">May 20 '11 at 15:14</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-8163465" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">4</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">woohoo! OUTPUT CLAUSE rocks :)  That will simplify my current task. Didn&#39;t know that statement before. Thank you guys!</span>
                    &ndash;&nbsp;<a href="/users/324135/swisscoder"
                       title="656 reputation"
                       class="comment-user">SwissCoder</a>
                <span class="comment-date" dir="ltr"><span title="2011-07-28 17:40:53Z" class="relativetime-clean">Jul 28 '11 at 17:40</span></span>
                    <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-51328302" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">For a really concise example to just get the inserted ID, have a look at: <a href="http://stackoverflow.com/a/10999467/2003325">stackoverflow.com/a/10999467/2003325</a></span>
                    &ndash;&nbsp;<a href="/users/2003325/luke"
                       title="187 reputation"
                       class="comment-user">Luke</a>
                <span class="comment-date" dir="ltr"><span title="2015-07-29 07:29:33Z" class="relativetime-clean">Jul 29 '15 at 7:29</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-6073578" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="42669"></a>
<div id="answer-42669" class="answer" data-answerid="42669"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="42669">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">56</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I'm saying the same thing as the other guys, so everyone's correct, I'm just trying to make it more clear.</p>

<p><code>@@IDENTITY</code> returns the id of the last thing that was inserted by your client's connection to the database.<br />
Most of the time this works fine, but sometimes a trigger will go and insert a new row that you don't know about, and you'll get the ID from this new row, instead of the one you want</p>

<p><code>SCOPE_IDENTITY()</code> solves this problem. It returns the id of the last thing that <em>you inserted</em> in the SQL code <em>you sent</em> to the database. If triggers go and create extra rows, they won't cause the wrong value to get returned. Hooray</p>

<p><code>IDENT_CURRENT</code> returns the last ID that was inserted by anyone. If some other app happens to insert another row at an unforunate time, you'll get the ID of that row instead of your one.</p>

<p>If you want to play it safe, always use <code>SCOPE_IDENTITY()</code>. If you stick with <code>@@IDENTITY</code> and someone decides to add a trigger later on, all your code will break.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/42669" title="short permalink to this answer" class="short-link" id="link-post-42669">share</a><span class="lsep">|</span><a href="/posts/42669/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-09-03 21:44:50Z" class="relativetime">Sep 3 '08 at 21:44</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/234/orion-edwards"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/3a9ff49a9e689dcbfc8242f05180cc31?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/234/orion-edwards">Orion Edwards</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 68,107" dir="ltr">68.1k</span><span title="40 gold badges"><span class="badge1"></span><span class="badgecount">40</span></span><span title="169 silver badges"><span class="badge2"></span><span class="badgecount">169</span></span><span title="245 bronze badges"><span class="badge3"></span><span class="badgecount">245</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-42669" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-42669" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="16273230"></a>
<div id="answer-16273230" class="answer" data-answerid="16273230"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="16273230">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">27</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>The best (read: safest) way to get the identity of a newly-inserted row is by using the <code>output</code> clause. <strong>Any other method is not guaranteed to return the correct ID when using parallelism</strong> - even if you aren't using parallelism <em>now</em>, writing your SQL like this will ensure you don't have to change it should you move to a parallel environment (e.g. SQL server cluster).</p>

<pre><code>create table TableWithIdentity
           ( IdentityColumnName int identity(1, 1) not null primary key,
             ... )

-- type of this table's column must match the type of the
-- identity column of the table you'll be inserting into
declare @IdentityOutput table ( ID int )

insert TableWithIdentity
     ( ... )
output inserted.IdentityColumnName into @IdentityOutput
values
     ( ... )

select @IdentityValue = (select ID from @IdentityOutput)
</code></pre>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/16273230" title="short permalink to this answer" class="short-link" id="link-post-16273230">share</a><span class="lsep">|</span><a href="/posts/16273230/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2013-04-29 07:22:55Z" class="relativetime">Apr 29 '13 at 7:22</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/70345/ian-kemp"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/pkw6V.png?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/70345/ian-kemp">Ian Kemp</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 10,602" dir="ltr">10.6k</span><span title="7 gold badges"><span class="badge1"></span><span class="badgecount">7</span></span><span title="49 silver badges"><span class="badge2"></span><span class="badgecount">49</span></span><span title="73 bronze badges"><span class="badge3"></span><span class="badgecount">73</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-16273230" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-16273230" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="42652"></a>
<div id="answer-42652" class="answer" data-answerid="42652"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="42652">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">8</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p><a href="http://msdn.microsoft.com/en-us/library/aa933167(SQL.80).aspx">MSDN</a></p>

<blockquote>
  <p>@@IDENTITY, SCOPE_IDENTITY, and IDENT_CURRENT are similar functions in that they return the last value inserted into the IDENTITY column of a table.</p>
  
  <p>@@IDENTITY and SCOPE_IDENTITY will return the last identity value generated in any table in the current session. However, SCOPE_IDENTITY returns the value only within the current scope; @@IDENTITY is not limited to a specific scope.</p>
  
  <p>IDENT_CURRENT is not limited by scope and session; it is limited to a specified table. IDENT_CURRENT returns the identity value generated for a specific table in any session and any scope. For more information, see IDENT_CURRENT.</p>
</blockquote>

<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/aa933217(SQL.80).aspx">IDENT_CURRENT</a> is a function which takes a table as a argument.</li>
<li><a href="http://msdn.microsoft.com/en-us/library/aa933167(SQL.80).aspx">@@IDENTITY</a> may return confusing result when you have an trigger on the table</li>
<li><a href="http://msdn.microsoft.com/en-us/library/aa259185(SQL.80).aspx">SCOPE_IDENTITY</a> is your hero most of the time.</li>
</ul>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/42652" title="short permalink to this answer" class="short-link" id="link-post-42652">share</a><span class="lsep">|</span><a href="/posts/42652/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2008-09-03 21:37:02Z" class="relativetime">Sep 3 '08 at 21:37</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/2361/jakub-%c5%a0turc"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/66f2beb2b2f73911a208fee4e1e9ab20?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/2361/jakub-%c5%a0turc">Jakub Šturc</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 16,843" dir="ltr">16.8k</span><span title="18 gold badges"><span class="badge1"></span><span class="badgecount">18</span></span><span title="67 silver badges"><span class="badge2"></span><span class="badgecount">67</span></span><span title="93 bronze badges"><span class="badge3"></span><span class="badgecount">93</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-42652" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-42652" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="42665"></a>
<div id="answer-42665" class="answer" data-answerid="42665"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="42665">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">7</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p><strong>@@IDENTITY</strong> is the last identity inserted using the current SQL Connection.  This is a good value to return from an insert stored procedure, where you just need the identity inserted for your new record, and don't care if more rows were added afterward.</p>

<p><strong>SCOPE_IDENTITY</strong> is the last identity inserted using the current SQL Connection, and in the current scope -- that is, if there was a second IDENTITY inserted based on a trigger after your insert, it would not be reflected in SCOPE_IDENTITY, only the insert you performed. Frankly, I have never had a reason to use this.</p>

<p><strong>IDENT_CURRENT(tablename)</strong> is the last identity inserted regardless of connection or scope.  You could use this if you want to get the current IDENTITY value for a table that you have not inserted a record into.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/42665" title="short permalink to this answer" class="short-link" id="link-post-42665">share</a><span class="lsep">|</span><a href="/posts/42665/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2008-09-03 21:42:55Z" class="relativetime">Sep 3 '08 at 21:42</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/2194/guy-starbuck"><div class="gravatar-wrapper-32"><img src="https://i.stack.imgur.com/O7TGw.jpg?s=32&amp;g=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/2194/guy-starbuck">Guy Starbuck</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 16,647" dir="ltr">16.6k</span><span title="4 gold badges"><span class="badge1"></span><span class="badgecount">4</span></span><span title="39 silver badges"><span class="badge2"></span><span class="badgecount">39</span></span><span title="53 bronze badges"><span class="badge3"></span><span class="badgecount">53</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-42665" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-7034171" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You should never use @@identity for this purpose. If someone adds a trigger later, you will lose data integrity. @@identiy is an extremely dangerous practice.</span>
                    &ndash;&nbsp;<a href="/users/9034/hlgem"
                       title="65,453 reputation"
                       class="comment-user">HLGEM</a>
                <span class="comment-date" dir="ltr"><span title="2011-05-20 14:51:57Z" class="relativetime-clean">May 20 '11 at 14:51</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-21219290" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">&quot;value for a table that you have &lt;&lt;not&gt;&gt; inserted a record into.&quot; Really?</span>
                    &ndash;&nbsp;<a href="/users/1176903/abdul-saboor"
                       title="1,712 reputation"
                       class="comment-user">Abdul Saboor</a>
                <span class="comment-date" dir="ltr"><span title="2013-02-26 10:07:41Z" class="relativetime-clean">Feb 26 '13 at 10:07</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-42665" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="29353469"></a>
<div id="answer-29353469" class="answer" data-answerid="29353469"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="29353469">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">6</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Add</p>

<pre><code>SELECT CAST(scope_identity() AS int);
</code></pre>

<p>to the end of your insert sql statement, then</p>

<pre><code>NewId = command.executescalar()
</code></pre>

<p>will retrieve it.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/29353469" title="short permalink to this answer" class="short-link" id="link-post-29353469">share</a><span class="lsep">|</span><a href="/posts/29353469/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/29353469/revisions" title="show all edits to this post">edited <span title="2015-07-27 06:41:28Z" class="relativetime">Jul 27 '15 at 6:41</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/1671066/micha-wiedenmann"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1671066/micha-wiedenmann">Micha Wiedenmann</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">5,310</span><span title="6 gold badges"><span class="badge1"></span><span class="badgecount">6</span></span><span title="33 silver badges"><span class="badge2"></span><span class="badgecount">33</span></span><span title="68 bronze badges"><span class="badge3"></span><span class="badgecount">68</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2015-03-30 18:25:01Z" class="relativetime">Mar 30 '15 at 18:25</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/4546567/jim"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/66a267c406188dbb42029d49a46134ec?s=32&amp;d=identicon&amp;r=PG" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/4546567/jim">Jim</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">61</span><span title="1 silver badge"><span class="badge2"></span><span class="badgecount">1</span></span><span title="2 bronze badges"><span class="badge3"></span><span class="badgecount">2</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-29353469" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-29353469" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>

  
<a name="1545927"></a>
<div id="answer-1545927" class="answer" data-answerid="1545927"  itemscope itemtype="http://schema.org/Answer">
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="1545927">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">5</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p><strong>ALWAYS</strong> use scope_identity(), there's NEVER a need for anything else.</p>
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/1545927" title="short permalink to this answer" class="short-link" id="link-post-1545927">share</a><span class="lsep">|</span><a href="/posts/1545927/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2009-10-09 20:35:00Z" class="relativetime">Oct 9 '09 at 20:35</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/47161/erikkallen"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/f04d2d6ecd3c3d93ebf5aeb8d21cd8e9?s=32&amp;d=identicon&amp;r=PG&amp;f=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/47161/erikkallen">erikkallen</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 21,213" dir="ltr">21.2k</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="57 silver badges"><span class="badge2"></span><span class="badgecount">57</span></span><span title="99 bronze badges"><span class="badge3"></span><span class="badgecount">99</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-1545927" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0"
                       data-canpost="false"
                       data-cansee="true"
                       data-comments-unavailable="false"
                       data-addlink-disabled="true">



    <tr id="comment-1403065" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="warm">9</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Not quite <i>never</i> but 99 times out of 100, you&#39;ll use Scope_Identity().</span>
                    &ndash;&nbsp;<a href="/users/6898/cjm"
                       title="7,575 reputation"
                       class="comment-user">CJM</a>
                <span class="comment-date" dir="ltr"><span title="2009-10-09 20:44:25Z" class="relativetime-clean">Oct 9 '09 at 20:44</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-1403243" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">For what have you ever used anything else?</span>
                    &ndash;&nbsp;<a href="/users/47161/erikkallen"
                       title="21,213 reputation"
                       class="comment-user">erikkallen</a>
                <span class="comment-date" dir="ltr"><span title="2009-10-09 21:31:14Z" class="relativetime-clean">Oct 9 '09 at 21:31</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2098305" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="warm">7</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">if you insert several rows with an INSERT-SELECT, you would need to capture the multiple IDs using the OUTPUT clause</span>
                    &ndash;&nbsp;<a href="/users/65223/km"
                       title="64,166 reputation"
                       class="comment-user">KM.</a>
                <span class="comment-date" dir="ltr"><span title="2010-01-28 14:48:22Z" class="relativetime-clean">Jan 28 '10 at 14:48</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2105598" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@KM: Yes, but I referred to scope_identity vs @@identity vs ident_current. OUTPUT is a completely different class and often useful.</span>
                    &ndash;&nbsp;<a href="/users/47161/erikkallen"
                       title="21,213 reputation"
                       class="comment-user">erikkallen</a>
                <span class="comment-date" dir="ltr"><span title="2010-01-29 11:10:33Z" class="relativetime-clean">Jan 29 '10 at 11:10</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-40012040" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Check out Orry&#39;s ( <a href="http://stackoverflow.com/a/6073578/2440976">stackoverflow.com/a/6073578/2440976</a>)  answer to this question - in parallelism, and just as a best practice, you would be wise to follow his setup... just brilliant!</span>
                    &ndash;&nbsp;<a href="/users/2440976/dan-b"
                       title="744 reputation"
                       class="comment-user">Dan B</a>
                <span class="comment-date" dir="ltr"><span title="2014-09-01 21:06:40Z" class="relativetime-clean">Sep 1 '14 at 21:06</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-1545927" data-rep=50 data-anon=true>

                <a class="js-add-link comments-link disabled-link "
                   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."
                   >add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href=# onclick=""></a>
        </div>         
    </td>
</tr>    </table>
</div>
				    <div class="question-status">
        <h2>                    <b>protected</b> by <a href="/users/-1/community">Community</a><span class="mod-flair" title="moderator">&#9830;</span> <span dir="ltr"><span title="2015-10-28 22:40:00Z" class="relativetime">Oct 28 '15 at 22:40</span></span>
</h2>
        <p>
Thank you for your interest in this question. 
Because it has attracted low-quality or spam answers that had to be removed, posting an answer now requires 10 <a href="/help/whats-reputation">reputation</a> on this site.
<br /><br />
Would you like to answer one of these <a href="/unanswered?fromProtectedNotice=true">unanswered questions</a> instead?
</p>
    </div>





						<h2 class="bottom-notice" data-loc="1">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/sql" class="post-tag" title="show questions tagged &#39;sql&#39;" rel="tag">sql</a> <a href="/questions/tagged/sql-server" class="post-tag" title="show questions tagged &#39;sql-server&#39;" rel="tag">sql-server</a> <a href="/questions/tagged/tsql" class="post-tag" title="show questions tagged &#39;tsql&#39;" rel="tag">tsql</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
						    <div class="module question-stats">
			        <table id="qinfo">
			            <tr>
			                <td>
			                    <p class="label-key">asked</p>
			                </td>
			                <td style="padding-left: 10px">
			                    <p class="label-key" title="2008-09-03 21:32:02Z"><b>7 years ago</b></p>
			                </td>
			            </tr>
			            <tr>
			                <td>
			                    <p class="label-key">viewed</p>
			                </td>

			                <td style="padding-left: 10px">
			                    <p class="label-key">
			                        <b>368144 times</b>
			                    </p>
			                </td>
			            </tr>
			                <tr>
			                    <td>
			                        <p class="label-key">active</p>
			                    </td>
			                    <td style="padding-left: 10px">
			                        <p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2016-04-12 13:30:23Z">23 days ago</a></b></p>
			                    </td>
			                </tr>
			        </table>
			    </div>
			<div class="module community-bulletin" data-tracker="cb=1">
    <div class="related">
                <div class="bulletin-title">
                    Blog
                </div>
                <hr />
    <div class="spacer">
        <div class="bulletin-item-type">
                <a href="http://blog.stackoverflow.com/2016/05/welcoming-stack-overflows-new-cmo-adrianna-burrows/" class="question-hyperlink">
<div class="favicon favicon-stackexchangemeta" title="Meta Stack Exchange"></div>                </a>
            </div>
                <div class="bulletin-item-content">
                    <a href="http://blog.stackoverflow.com/2016/05/welcoming-stack-overflows-new-cmo-adrianna-burrows/" class="question-hyperlink">Welcoming Stack Overflow’s New CMO – Adrianna Burrows</a>
                </div>
                <br class="cbt" />
            </div>
    </div>
</div>			
			<div class="everyonelovesstackoverflow" id="careers2">
        </div>
        <div id="hireme">
            <script>
;"use strict";(function(n){function it(n,i,r){var u=t.createElement("script"),e="onreadystatechange",o="onload",f="readyState",s=!1;u.async=!0;u.src=n;typeof i=="function"&&(u[o]=u[e]=function(){s||u[f]&&u[f]!=="loaded"&&u[f]!=="complete"||(s=!0,typeof i=="function"&&i(u),u[o]=u[e]=null,r&&u.parentNode.removeChild(u))});ft.appendChild(u)}function rt(n){var i=t.createElement("link");i.type="text/css";i.rel="stylesheet";i.href=n;et.appendChild(i)}function ct(){var n=i.StackExchange,t="options",r="user";return n&&n[t]&&n[t][r]&&n[t][r].accountId}function lt(n){var t,i;return n=ot(f.hash?f.hash.substr(1):"",n||{}),t=n.ac||n.accountId||ct(),t&&(n.ac=t),n.tags||(i=tt(),i.length>0&&(n.tags=i.join(";"))),n.host=f.host.replace(/\.internal$/,""),n}function at(n,t,i,u){var c=h(n);if(c===null)return function(){};var e=null,f=null,l=r(),a=function a(){g(c)?(s(e),u(!1,r()-l)):f=o(a,t)};return f=o(a,t),i!==undefined&&(e=o(function(){s(f);u(!0,r()-l)},i)),function(){s(f);s(e)}}function vt(n){var u=f.hash.indexOf("large=1")!==-1,e=y(),o=u||!e||n,s=o?1:2,h=a(["hireme","clc-sb"],v),t=[s+"="+h],r=a(["careers1","clc-tlb"],v),i;return r&&t.push("5="+r),i=a(["careers3","clc-mlb"],v),i&&t.push("6="+i),t.join("&")}function ut(n,t){var e=!!h("#careersadsdoublehigh"),s=k({},u,{zones:u.zones||vt(e)}),f=lt(s),o;n&&(f.azt=1);t&&(f.lw=t);typeof i.innerWidth=="number"&&(f.bw=i.innerWidth);b&&(f.ver=b);o=p()-(e+0);o>0&&(f.az="1");var c=st(f,["zones","ip","ac","eng","prov","tags","theme","at","remote","seed","lw","azt","sysadmin","bw","nocpm","jobview","cpview","ver","host","cp","az"]),a=w+"?"+c;l=r();it(a)}function yt(n){function h(){f.forEach(rt);e.forEach(function(n){return pt(n,t[n],s,o)});typeof i.clc_after_load=="function"&&i.clc_after_load()}var t=n.cr,u=n.h,f=n.st,e=Object.keys(t),o=l?r()-l:0,s="//"+u+"/ct";h()}function pt(n,t,i,r){var s=t.cl,c=t.cn,f=t.an,l=t.tr,o=(s||[]).join(" "),u=h("#"+n);u&&(o&&(u.className+=" "+o),u.innerHTML=c.replace("&pt=0","&pt="+(r||0)),u.onmousedown=function(n){for(var t=n.target,r,o,s;t.tagName!=="A"&&t!==u;)t=t.parentNode;t!==u&&(r=[],f&&r.push("an="+f),o=[].filter.call(t.attributes,function(n){return/^data-/.test(n.name)}),o.length>0&&o.forEach(function(n){var t=n.name.replace(/^data-/,"");r.push(e(t)+"="+e(n.value))}),r.push("tr="+l),s="",r.length>0&&(s="?"+r.join("&")),t.href=i+s)})}function wt(n){var i=t.createElement("a");return i.href=n,i.host}function bt(){var i,n;y()?(n=at("#sidebar "+c,20,i,ut),o(function(){var r=h(c),i;g(r)||(r.parentNode.removeChild(r),typeof n=="function"&&n(),i=t.createElement("img"),i.src="//"+wt(w)+"/to.gif",i.style.display="none",t.body.appendChild(i))},2e3)):ut()}var w=n.u,u=n.o,b=n.c,y,p;u=u||{};var k=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},i=window,f=i.location,e=i.encodeURIComponent,d=i.decodeURIComponent,t=i.document,ft=t.body,et=t.getElementsByTagName("head")[0],o=i.setTimeout,s=i.clearTimeout,c="[id^=adzerk].everyonelovesstackoverflow",l=0,r=function(){return(new Date).getTime()},ot=function(n,t){return n.split(/\&/g).reduce(function(n,t){var i=t.split("=");return n[d(i[0])]=d(i[1]),n},t||{})},st=function(n,t){return Object.keys(n).filter(function(n){return t.indexOf(n)!==-1}).map(function(t){return e(t)+"="+e(n[t])}).join("&")},g=function(n){return n.innerHTML.replace(/\s+$/g,"")},nt=t.querySelectorAll.bind(t),h=t.querySelector.bind(t),ht=t.getElementById.bind(t),a=function(n,t){return n.filter(t)[0]},tt=function(){return[].map.call(nt(".post-taglist .post-tag"),function(n){return n.textContent})},v=function(n){return!!ht(n)};y=function(){return p()>0};p=function(){return nt(c).length};i.clc=k(window.clc||{},{init:yt,load:bt,ls:it,as:rt,tags:tt})}).call(null, {"c":"955d59b","u":"//clc.stackoverflow.com/p.js"});"use strict";var allowedHosts=["stackoverflow.com","serverfault.com"];(allowedHosts[0]==="*"||allowedHosts.indexOf(location.hostname)!==-1)&&window.clc.load();            </script>
        </div>
			<div class="module" id="chat-feature">
    

    
<h4><a href="http://chat.stackoverflow.com" id="h-chat-link">Visit Chat</a></h4>

<div class="related" id="ad502-rooms"></div>
<script>
// <!--
    StackExchange.ready(
    function () {
        var options = {
            chatUrl: 'http://chat.stackoverflow.com',
            reloadUrl: '/api/recent-chat',
            preloadData: {"activeUsers":132,"activeRooms":40,"rooms":[{"name":"JavaScript","id":17,"lastPost":1462468559,"posts":3355820,"users":[{"name":"Todo Pertin","id":5992646,"emailhash":"!https://i.stack.imgur.com/pbsDy.jpg?s=128\u0026g=1","lastPost":1462468503},{"name":"Krush","id":3842561,"emailhash":"73e749f3bb4ecd64ab41127406c891e4","lastPost":1462468498},{"name":"Kendall Frey","id":785745,"emailhash":"f9fc3249a341a64ee2721637915cd301","lastPost":1462468492},{"name":"Jacque Goupil","id":2813263,"emailhash":"fa58c516577bcbd4ef082553dedad4a5","lastPost":1462468081},{"name":"ssube","id":129032,"emailhash":"e8bea8f9e6972dfd3113d67da68e6933","lastPost":1462468063},{"name":"corvid","id":1150599,"emailhash":"!https://i.stack.imgur.com/ndWQ0.jpg?s=128\u0026g=1","lastPost":1462467822},{"name":"ton.yeung","id":860947,"emailhash":"!https://i.stack.imgur.com/WLi8a.png?s=128\u0026g=1","lastPost":1462467813}],"messages":[{"date":1462468559,"user":"Todo Pertin","userid":5992646}],"singleImage":false,"tags":["ecmascript","es6","javascript","nodejs","promises"]},{"name":"PHP","id":11,"lastPost":1462468560,"posts":2322232,"users":[{"name":"DaveRandom","id":889949,"emailhash":"8609c7056e725f9e8c03c594b831353e","lastPost":1462468560},{"name":"PeeHaa","id":508666,"emailhash":"!https://i.stack.imgur.com/0dpOE.png?s=128\u0026g=1","lastPost":1462468553},{"name":"Jeeves","id":5764893,"emailhash":"!https://i.stack.imgur.com/dINlb.png?s=128\u0026g=1","lastPost":1462468506},{"name":"Anmol Raghuvanshi Version 2.0","id":3605516,"emailhash":"!https://i.stack.imgur.com/lXtaD.jpg?s=128\u0026g=1","lastPost":1462468472},{"name":"Saitama","id":4332216,"emailhash":"!https://i.stack.imgur.com/FvoEN.jpg?s=128\u0026g=1","lastPost":1462468285},{"name":"bwoebi","id":2153758,"emailhash":"3659fff22e890aaa5d7b03e799f9047f","lastPost":1462468263},{"name":"Paul Crovella","id":3942918,"emailhash":"!https://i.stack.imgur.com/Rup3Y.jpg?s=128\u0026g=1","lastPost":1462468133}],"messages":[{"date":1462468560,"user":"DaveRandom","userid":889949}],"singleImage":false,"tags":["php"]}]} 
        };

        StackExchange.chatAd.init(options);
    });
// -->
</script>

</div>  
    
            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">
<div class="spacer">
	<a href="/q/4396887" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">4</div>
	</a>
	<a href="/questions/4396887/appropriate-uses-of-the-identity-in-tsql" class="question-hyperlink">Appropriate Uses of the `IDENTITY` in TSQL</a>
</div><div class="spacer">
	<a href="/q/14047111" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">2</div>
	</a>
	<a href="/questions/14047111/how-to-get-last-record-inserted-when-millions-of-transactions-are-taking-place" class="question-hyperlink">How to get last record inserted when millions of transactions are taking place?</a>
</div><div class="spacer">
	<a href="/q/14344286" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">1</div>
	</a>
	<a href="/questions/14344286/ms-sql-auto-increased-key-conflict" class="question-hyperlink">MS SQL: Auto-increased key conflict</a>
</div><div class="spacer">
	<a href="/q/12148125" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">1</div>
	</a>
	<a href="/questions/12148125/return-id-from-insert-statement" class="question-hyperlink">Return ID from insert statement</a>
</div><div class="spacer">
	<a href="/q/15688590" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">1</div>
	</a>
	<a href="/questions/15688590/how-to-retrieve-last-entry-primarykey" class="question-hyperlink">how to retrieve last entry primarykey?</a>
</div><div class="spacer">
	<a href="/q/21854603" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">0</div>
	</a>
	<a href="/questions/21854603/setting-ownership-in-a-transaction-sql" class="question-hyperlink">Setting ownership in a transaction SQL</a>
</div><div class="spacer">
	<a href="/q/34052779" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">0</div>
	</a>
	<a href="/questions/34052779/accessing-dataset-tables" class="question-hyperlink">accessing dataset tables</a>
</div><div class="spacer">
	<a href="/q/346659" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted large">178</div>
	</a>
	<a href="/questions/346659/what-are-the-most-common-sql-anti-patterns" class="question-hyperlink">What are the most common SQL anti-patterns?</a>
</div><div class="spacer">
	<a href="/q/10999396" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">87</div>
	</a>
	<a href="/questions/10999396/how-do-i-use-an-insert-statements-output-clause-to-get-the-identity-value" class="question-hyperlink">How do I use an INSERT statement&#39;s OUTPUT clause to get the identity value?</a>
</div><div class="spacer">
	<a href="/q/17993606" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">16</div>
	</a>
	<a href="/questions/17993606/sql-server-return-the-value-of-identity-column-after-insert-statement" class="question-hyperlink">Sql Server return the value of identity column after insert statement</a>
</div>					<div class="spacer more">
				<a href="/questions/linked/42648">see more linked questions…</a>
			</div>
	</div>
</div>

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
                    <div class="related js-gps-related-questions" data-tracker="rq=1">
                        <div class="spacer">
<a href="/q/18932" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">745
    </div>
</a><a href="/questions/18932/how-can-i-remove-duplicate-rows" class="question-hyperlink">How can I remove duplicate rows?</a>
</div>
<div class="spacer">
<a href="/q/452859" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes large">732
    </div>
</a><a href="/questions/452859/inserting-multiple-rows-in-a-single-sql-query" class="question-hyperlink">Inserting multiple rows in a single SQL query?</a>
</div>
<div class="spacer">
<a href="/q/653714" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes large">928
    </div>
</a><a href="/questions/653714/insert-results-of-a-stored-procedure-into-a-temporary-table" class="question-hyperlink">Insert results of a stored procedure into a temporary table</a>
</div>
<div class="spacer">
<a href="/q/1177449" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">326
    </div>
</a><a href="/questions/1177449/best-approach-to-remove-time-part-of-datetime-in-sql-server" class="question-hyperlink">Best approach to remove time part of datetime in SQL Server</a>
</div>
<div class="spacer">
<a href="/q/1179758" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">393
    </div>
</a><a href="/questions/1179758/function-vs-stored-procedure-in-sql-server" class="question-hyperlink">Function vs. Stored Procedure in SQL Server</a>
</div>
<div class="spacer">
<a href="/q/1435536" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">0
    </div>
</a><a href="/questions/1435536/inserting-rows-into-a-table-with-a-predefined-identity" class="question-hyperlink">Inserting rows into a table with a predefined identity</a>
</div>
<div class="spacer">
<a href="/q/1615284" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">5
    </div>
</a><a href="/questions/1615284/sql-server-get-inserted-record-identity-value-when-using-a-views-instead-of-t" class="question-hyperlink">SQL Server - Get Inserted Record Identity Value when Using a View&#39;s Instead Of Trigger</a>
</div>
<div class="spacer">
<a href="/q/2043259" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">327
    </div>
</a><a href="/questions/2043259/sql-server-how-to-join-to-first-row" class="question-hyperlink">SQL Server: How to Join to first row</a>
</div>
<div class="spacer">
<a href="/q/4117676" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">48
    </div>
</a><a href="/questions/4117676/inserting-rows-into-a-table-with-one-identity-column-only" class="question-hyperlink">Inserting rows into a table with one IDENTITY column only</a>
</div>
<div class="spacer">
<a href="/q/33475092" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">0
    </div>
</a><a href="/questions/33475092/insert-new-row-with-current-identity-as-value" class="question-hyperlink">Insert new row with current Identity as value</a>
</div>

                    </div>
				</div>
            
<div id="hot-network-questions" class="module">
    <h4>
        <a href="//stackexchange.com/questions?tab=hot" 
           class="js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:1, location:11 })">
            Hot Network Questions
        </a>
    </h4>
    <ul>
            <li >
                <div class="favicon favicon-mathematica" title="Mathematica Stack Exchange"></div><a href="http://mathematica.stackexchange.com/questions/114445/listplot-with-colors" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:387 }); posts_hot_network.click({ item_type:2, location:11 })">
                    ListPlot with colors
                </a>

            </li>
            <li >
                <div class="favicon favicon-travel" title="Travel Stack Exchange"></div><a href="http://travel.stackexchange.com/questions/67702/as-a-tourist-can-i-try-firearms-in-california" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:273 }); posts_hot_network.click({ item_type:2, location:11 })">
                    As a tourist, can I try firearms in California?
                </a>

            </li>
            <li >
                <div class="favicon favicon-salesforce" title="Salesforce Stack Exchange"></div><a href="http://salesforce.stackexchange.com/questions/120710/formula-field-image-between-numbers" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:459 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Formula field image BETWEEN numbers
                </a>

            </li>
            <li >
                <div class="favicon favicon-electronics" title="Electrical Engineering Stack Exchange"></div><a href="http://electronics.stackexchange.com/questions/232035/why-are-there-so-many-relays-used-in-a-car-instead-of-transistors" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:135 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why are there so many relays used in a car, instead of transistors?
                </a>

            </li>
            <li >
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/1773167/evaluate-the-following-limit" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Evaluate the following limit:
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-security" title="Information Security Stack Exchange"></div><a href="http://security.stackexchange.com/questions/122412/find-matching-phone-numbers-without-actually-knowing-them" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:162 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Find matching phone numbers without actually knowing them
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-vi" title="Vi and Vim Stack Exchange"></div><a href="http://vi.stackexchange.com/questions/7641/edit-a-directory-inside-vim" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:599 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Edit a directory inside Vim
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-money" title="Personal Finance &amp; Money Stack Exchange"></div><a href="http://money.stackexchange.com/questions/63737/the-price-dropped-on-an-item-i-purchased-8-days-ago-what-can-i-do" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:93 }); posts_hot_network.click({ item_type:2, location:11 })">
                    The price dropped on an item I purchased 8 days ago. What can I do?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-mathematica" title="Mathematica Stack Exchange"></div><a href="http://mathematica.stackexchange.com/questions/114427/how-to-measure-the-slit-size-from-given-image-using-mathematica" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:387 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How to measure the slit size from given image using mathematica?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="http://english.stackexchange.com/questions/323707/heard-a-native-saying-did-you-see-where-she-had-a-baby-refering-to-facebook" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Heard a native saying: &quot;did you see where she had a baby??&quot; refering to Facebook
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-stackoverflow" title="Stack Overflow"></div><a href="http://stackoverflow.com/questions/37048006/why-would-one-use-macro0-0" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:1 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why would one use MACRO+0 !=0
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-philosophy" title="Philosophy Stack Exchange"></div><a href="http://philosophy.stackexchange.com/questions/33972/how-could-both-occams-razor-and-complex-theories-like-quantum-mechanics-be-corr" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:265 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How could both Occam&#39;s Razor and complex theories like Quantum Mechanics be correct at the same time?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-stackoverflow" title="Stack Overflow"></div><a href="http://stackoverflow.com/questions/37051199/should-this-be-called-some-special-case-of-object-slicing" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:1 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Should this be called some special case of object slicing?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/1773110/is-there-another-way-to-compute-this-limit" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is there another way to compute this limit?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="http://english.stackexchange.com/questions/323033/proper-way-to-address-a-very-small-group-that-includes-both-sexes" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Proper way to address a very small group that includes both sexes
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-travel" title="Travel Stack Exchange"></div><a href="http://travel.stackexchange.com/questions/67753/can-i-put-new-wrist-watch-in-checked-or-carry-on-bag" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:273 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Can I put new wrist watch in checked or carry-on bag?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-aviation" title="Aviation Stack Exchange"></div><a href="http://aviation.stackexchange.com/questions/27386/how-much-force-is-needed-to-tow-an-airliner" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:528 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How much force is needed to tow an airliner?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-space" title="Space Exploration Stack Exchange"></div><a href="http://space.stackexchange.com/questions/15130/deluge-system-refresh-rates" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:508 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Deluge system refresh rates
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="http://english.stackexchange.com/questions/323769/is-there-a-specific-word-describing-black-boxes-covering-confidential-data-on-pa" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is there a specific word describing black boxes covering confidential data on papers being prepared for public access?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-ux" title="User Experience Stack Exchange"></div><a href="http://ux.stackexchange.com/questions/93689/why-do-most-smartphones-not-have-a-physical-keyboard" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:102 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why do most smartphones not have a physical keyboard?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-salesforce" title="Salesforce Stack Exchange"></div><a href="http://salesforce.stackexchange.com/questions/120741/help-on-trigger-logic" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:459 }); posts_hot_network.click({ item_type:2, location:11 })">
                    help on trigger logic
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-blender" title="Blender Stack Exchange"></div><a href="http://blender.stackexchange.com/questions/52030/why-are-some-blender-ui-elements-blue" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:502 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why are some Blender UI elements blue?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-worldbuilding" title="Worldbuilding Stack Exchange"></div><a href="http://worldbuilding.stackexchange.com/questions/41204/how-might-a-collective-such-as-the-borg-develop" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:579 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How might a collective such as The Borg develop?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-academia" title="Academia Stack Exchange"></div><a href="http://academia.stackexchange.com/questions/67897/i-dont-want-to-kill-any-more-mice-but-my-advisor-insists-that-i-must-in-order" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:415 }); posts_hot_network.click({ item_type:2, location:11 })">
                    I don&#39;t want to kill any more mice, but my advisor insists that I must in order to get my PhD
                </a>

            </li>
    </ul>

        <a href="#" 
           class="show-more js-show-more js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:3, location:11 })">
            more hot questions
        </a>
</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text">
        <a href="/feeds/question/42648" title="feed of this question and its answers">
            <span class="feed-icon"></span>question feed
        </a>
    </div>
</div>	<script>
StackExchange.ready(function(){$.get('/posts/42648/ivc/ef8f');});
</script>
<noscript>
    <div><img src="/posts/42648/ivc/ef8f" class="dno" alt="" width="0" height="0"></div>
</noscript><div style="display:none" id="prettify-lang">lang-sql</div></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                    <a href="http://stackoverflow.com/company/about">about us</a>
                        <a href="/tour">tour</a>
                    <a href="/help">help</a>
                    <a href="http://blog.stackoverflow.com?blb=1">blog</a>
                        <a href="http://chat.stackoverflow.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackoverflow.com/company/work-here">work here</a>
                    <a href="http://stackexchange.com/mediakit">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.stackoverflow.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="//stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="//serverfault.com" title="system and network administrators">Server Fault</a></li>
                        <li><a href="//superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="//webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="//askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="//webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="//gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="//tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="//programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="//unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems">Unix &amp; Linux</a></li>
                        <li><a href="//apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="//wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Development</a></li>
                        <li><a href="//gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="//electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="//android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="//security.stackexchange.com" title="information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="//dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="//drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="//sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="//ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="//mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                        <li><a href="//salesforce.stackexchange.com" title="Salesforce administrators, implementation experts, developers and anybody in-between">Salesforce</a></li>
                        <li><a href="//expressionengine.stackexchange.com" title="administrators, end users, developers and designers for ExpressionEngine&#174; CMS">ExpressionEngine&#174; Answers</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="//scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="//graphicdesign.stackexchange.com" title="Graphic Design professionals, students, and enthusiasts">Graphic Design</a></li>
                        <li><a href="//movies.stackexchange.com" title="movie and tv enthusiasts">Movies &amp; TV</a></li>
                        <li><a href="//cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="//diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                        <li><a href="//money.stackexchange.com" title="people who want to be financially literate">Personal Finance &amp; Money</a></li>
                        <li><a href="//academia.stackexchange.com" title="academics and those enrolled in higher education">Academia</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (9)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="//skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="//judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="//travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="//christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="//gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="//bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="//rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="//stats.stackexchange.com" title="people interested in statistics, machine learning, data analysis, data mining, and data visualization">Cross Validated (stats)</a></li>
                        <li><a href="//cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="//physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="//mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                        <li><a href="//chemistry.stackexchange.com" title="scientists, academics, teachers and students">Chemistry</a></li>
                        <li><a href="//biology.stackexchange.com" title="biology researchers, academics, and students">Biology</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (5)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="//stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="//meta.stackexchange.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Exchange</a></li>
                        <li><a href="//area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="//careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>
            <div id="copyright">
                site design / logo &#169; 2016 Stack Exchange Inc; user contributions licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc by-sa 3.0</a> 
                with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="svnrev">
                rev 2016.5.5.3548
            </div>
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Stack Overflow works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>
        <script> setTimeout(function() { $("#adzerk-user-match").remove(); }, 2000);</script>

    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-5620270-1');
                        ga('set', 'dimension2', '|sql|sql-server|tsql|');         ga('send', 'pageview');
        var _qevents = _qevents || [],
            _comscore = _comscore || [];
        (function () {
            var ssl='https:'==document.location.protocol,
                s=document.getElementsByTagName('script')[0],
                qc=document.createElement('script');
            qc.async=true;
            qc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
            s.parentNode.insertBefore(qc, s);
            var sc=document.createElement('script');
            sc.async=true;
            sc.src=(ssl?'https://sb':'http://b') + '.scorecardresearch.com/beacon.js';
            s.parentNode.insertBefore(sc, s);
        })();
        _comscore.push({ c1: "2", c2: "17440561" });
        _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>
        
    
    </body>
</html>