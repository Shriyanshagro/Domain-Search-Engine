
<!doctype html><head>
    <title>IP Addresses Triage - SANS Internet Storm Center </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-control" content="no-cache" />
    <meta property="og:site_name" content="SANS Internet Storm Center" />
    <meta property="og:locale" content="en_US" />
    <meta name="DESCRIPTION" content="SANS Internet Storm Center - A global cooperative cyber threat / internet security monitor and alert system. Featuring daily handler diaries with summarizing and analyzing new threats to networks and internet security events."/>
    <meta name="AUTHOR" content="SANS Internet Storm Center"/>
    <meta name="KEYWORDS" content="isc, sans, internet, security, threat, worm, virus, phishing, hacking, vulnerability"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/iscfavicon.ico" />
    <link rel="canonical" href="https://isc.sans.edu%2Fforums%2Findex.html" />
    <link type="text/css" rel="stylesheet" href="/css/screen.css" /><!-- this is not the comment you are looking for 36ded6eb778 -->
</head><body class="isc">
<div id="container">
  <div id="topWrapper">
    <div class="g">
      <span class="threatLevel">
        Threat Level: <a href="/infocon.html">green</a>
      </span>
      <span class="currentHandler">
        Handler on Duty: <a title="Brad Duncan" href="/handler_list.html#brad-duncan">Brad Duncan</a>
      </span>
    </div>

  </div>
	<h1>
    <a href="/">SANS ISC: IP Addresses Triage - SANS Internet Storm Center  <span></span></a>
    <ul class="site-selector">
      <li class="site-switcher"><a href="#"><span class="hidden">SANS Site Network</span></a>
        <ul class="sites">
          <li class="current-site">Current Site</li>
          <li class="isc"><a href="https://isc.sans.edu">
            <span></span>
            Internet Storm Center
          </a></li>
          <li class="selector-help">Other SANS Sites
            <a href="https://www.sans.org/help/site-network"><span class="hidden">Help</span></a>
          </li>
          <li class="sti"><a href="http://www.sans.edu">
            <span></span>
            Graduate Degree Programs
          </a></li>
          <li class="sans"><a href="http://www.sans.org">
            <span></span>
            Security Training
          </a></li>
          <li class="giac"><a href="http://www.giac.org">
            <span></span>
            Security Certification
          </a></li>
          <li class="awareness"><a href="http://www.securingthehuman.org">
            <span></span>
            Security Awareness Training
          </a></li>
          <li class="pentest"><a href="http://pen-testing.sans.org">
            <span></span>
            Penetration Testing
          </a></li>
          <li class="ics"><a href="http://ics.sans.org">
            <span></span>
            Industrial Control Systems
          </a></li>
          <li class="cyber-defense"><a href="http://cyber-defense.sans.org">
            <span></span>
            Cyber Defense Foundations
          </a></li>
          <li class="forensics"><a href="http://computer-forensics.sans.org">
            <span></span>
            Computer Forensics
          </a></li>
          <li class="ssi"><a href="http://software-security.sans.org">
            <span></span>
            Software Security
          </a></li>
          <li class="sic"><a href="http://sic.sans.org">
            <span></span>
            Government OnSite Training
          </a></li>
        </ul>
      </li>
    </ul>
    SANS ISC InfoSec Forums
	</h1>
	<form id="headerSearch" name="searchform" action="/search.html" method="post">
        <input type="text" name="q" placeholder="Keyword, Domain, Port, IP or Header" />
        <input type="submit" value="Search" />
	</form>
    <form id="headerLogin" method="post" action="/login.html" name="loginform">
        <input type="hidden" name="token" value="dea921df6a0f3cae1c57c0c1de8735651e8acf85" />
        <input type="text" name="email" placeholder="Email" />
        <input type="password" name="pw" autocomplete="off" placeholder="Password" />
        <input type="submit" value="Log In" /><br />
        <a href="/register.html">Sign Up for Free!</a> &nbsp; <a href="/resetpassword.html">Forgot Password?</a>
	</form>
	<div id="smallHeaderLogin">
	    <a href="/login.html">Log In</a> or <a href="/register.html">Sign Up for Free</a>!
	</div>
	<div id="content">
		<div class="wrapper">
                                <div class="beforeForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/Forensicating+Docker+Part+1/20835/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/Why+Users+Fall+For+Ransomware/20867/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div>
                                <table class="postList">
                                <caption>IP Addresses Triage</caption>
                                        <tr class="postWrapper">
                                            <td class="content">
                                                <div class="ss-container">
                                                    <ul class="ss-share">
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-facebook" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20865" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-twitter" title="Share on Twitter" href="http://twitter.com/share?text=IP%20Addresses%20Triage&amp;url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20865&amp;via=SANS_ISC" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-google" title="Share on Google+" href="http://plus.google.com/share?url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20865" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div><p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--></p>

<div style="font-family:'Helvetica Neue';font-size:12px;">Last week, I was in Germany to attend the <a href="https://www.troopers.de">TROOPERS</a> security conference and I had the opportunity to follow <a href="https://twitter.com/christruncer">Chris Truncer</a>&rsquo;s talk about passive intelligence gathering. Passive intelligence is a must-do when you need to collect information about a target (when working from the offensive side) or an attacker (from the defensive side). It helps to collect as much information as possible and relies often on OSINT (Open Source INTelligence -&nbsp;publicly available data). From a defensive point of view, the first step is to collect logs (as much as you can). And what do we find in logs? Mostly&nbsp;IP addresses! We can have tons of IP addresses collected every day. The next step is to get more information about them and it is often a pain. During his talk, Chris presented his&nbsp;tool (called Just-Metadata) that&nbsp;helps to collect and manage information on IP addresses. This is performed via&nbsp;two phases:</div>

<ul>
	<li style="font-family: 'Helvetica Neue'; font-size: 12px;">Phase 1: collect information about the IP addresses</li>
	<li style="font-family: 'Helvetica Neue'; font-size: 12px;">Phase 2: analyze the gathered data and get interesting information</li>
</ul>

<div style="font-family:'Helvetica Neue';font-size:12px;">When I tested the tool, I was surprised to not see any module for DShield! As we have a nice database of IP addresses and reputation, why not use it from Just-Metadata? The tool being very modular, it was&nbsp;easy to add an extra&nbsp;module&nbsp;to gather information from our database and a simple reporting module.&nbsp;Here is a list of the current available gathering modules:</div>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
[&gt;] Please enter a command: list gather&#10;Shodan =&gt; Requests Shodan for information on provided IPs&#10;GeoInfo =&gt; This script gathers geographical information about the loaded&#10;           IP addresses&#10;DShield =&gt; This module checks DShield for hits on loaded IPs&#10;Whois =&gt; This module gathers whois information&#10;FeedLists =&gt; This module checks IPs against potential threat lists&#10;MyWOT =&gt; Requests MyWOT for domain reputation information on provided domains&#10;VirusTotal =&gt; This module checks VirusTotal for hits on loaded IPs&#10;All =&gt; Invokes all of the above IntelGathering modules&#10;</pre>

<div style="font-family:'Helvetica Neue';font-size:12px;">And modules to analyze the collected data:</div>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
[&gt;] Please enter a command: list analysis&#10;TopNetBlocks =&gt; Returns the top &quot;X&quot; number of most seen whois CIDR netblocks&#10;Keys =&gt; Returns IP Addresses with shared public keys (SSH, SSL)&#10;FeedHits =&gt; Lists IPs being tracked in threat lists&#10;DShield =&gt; Returns IP addresses with results in DShield&#10;PortSearch =&gt; Returns the top &quot;X&quot; number of most used ports&#10;TopPorts =&gt; Returns the top &quot;X&quot; number of most used ports&#10;Country =&gt; Search for IPs by country of origin&#10;MyWOTDomains =&gt; Parse mywot domain reputation results&#10;GeoInfo =&gt; Analyzes IPs geographical/ISP information&#10;Virustotal =&gt; Returns IP addresses with results in VirusTotal&#10;All =&gt; Invokes all of the above Analysis modules&#10;</pre>

<div style="font-family:'Helvetica Neue';font-size:12px;">How does it work? Create (or generate) a text file containing the IP addresses to analyze and load it into Just-Metadata:</div>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
[&gt;] Please enter a command: load ip.txt&#10;[*] Loaded 5 systems&#10;[&gt;] Please enter a command: gather all&#10;Querying Shodan for information about 120.27.31.143&#10;Querying Shodan for information about 77.247.182.246&#10;Querying Shodan for information about 193.169.52.214&#10;Querying Shodan for information about 46.4.120.238&#10;Querying Shodan for information about 101.200.0.122&#10;Getting info on... 120.27.31.143&#10;Getting info on... 77.247.182.246&#10;Getting info on... 193.169.52.214&#10;Getting info on... 46.4.120.238&#10;Getting info on... 101.200.0.122&#10;Information found on 120.27.31.143&#10;Information found on 77.247.182.246&#10;No information within DShield for 193.169.52.214&#10;No information within DShield for 46.4.120.238&#10;Information found on 101.200.0.122&#10;Gathering whois information about 120.27.31.143&#10;Gathering whois information about 77.247.182.246&#10;Gathering whois information about 193.169.52.214&#10;Gathering whois information about 46.4.120.238&#10;Gathering whois information about 101.200.0.122&#10;Grabbing list of TOR exit nodes..&#10;Grabbing attacker IP list from the Animus project...&#10;Grabbing EmergingThreats list...&#10;Grabbing AlienVault reputation list...&#10;Grabbing Blocklist.de info...&#10;Grabbing DragonResearch&#39;s SSH list...&#10;Grabbing DragonResearch&#39;s VNC list...&#10;Grabbing NoThinkMalware list...&#10;Grabbing NoThinkSSH list...&#10;Grabbing Feodo list...&#10;Grabbing antispam spam list...&#10;Grabbing malc0de list...&#10;Grabbing MalwareBytes list...&#10;Information found on 120.27.31.143&#10;Information found on 77.247.182.246&#10;Information found on 193.169.52.214&#10;Information found on 46.4.120.238&#10;Information found on 101.200.0.122&#10;[&gt;] Please enter a command: save&#10;State saved to disk at metadata03212016_150606.state</pre>

<div style="font-family:'Helvetica Neue';font-size:12px;">Then, you can use analyzis modules to build intelligence from the collected data. Here is a sample&nbsp;output of my DShield module:</div>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
[&gt;] Please enter a command: analyse dshield 10&#10;**********************************************************************&#10;                    IPs and Detected Counts&#10;**********************************************************************&#10;101.200.0.122: 832 count(s)&#10;120.27.31.143: 596 count(s)&#10;77.247.182.246: 186 count(s)&#10;**********************************************************************&#10;                    IPs and Attacked Targets&#10;**********************************************************************&#10;101.200.0.122: 270 target(s)&#10;120.27.31.143: 119 target(s)&#10;77.247.182.246: 7 target(s)&#10;**********************************************************************&#10;                    IPs and Detected Risk&#10;**********************************************************************&#10;</pre>

<div style="font-family:'Helvetica Neue';font-size:12px;">I sent a pull request to Chris yesterday and he already merge it. The tool is available on his <a href="https://github.com/ChrisTruncer/Just-Metadata">github</a>&nbsp;repository.&nbsp;It&#39;s easy to set up, does not have lot of dependencies and&nbsp;it runs smoothly in&nbsp;a Docker container.</div>

<p><span style="font-size:12px;">Xavier Mertens<br />
ISC Handler - Freelance Security Consultant<br />
<a href="https://pgp.mit.edu/pks/lookup?op=get&amp;search=0x881F7C8E873FCB38">PGP Key</a></span></p>
</div>
                                                <div>Tags: dshield, intelligence, osint</div>
                                            </td><td class="user">
                                            Xme<br />
                                                <img src="/gravatar_cache/cache/isc/a7cc8e162752a120d82325fbbf3b5e79" /><br />
                                                <span>144 Posts</span><br /><span>ISC Handler</span></td>
                                        </tr>
                                        <tr class="postFooter">
                                            <td class="actions">
                                                <a href="/forums/diary/reply/20865/">Reply</a>
                                        <a href="/forums/diary/subscribe/20865/">Subscribe</a>
                                            </td>
                                            <td class="time">
                                                1 month  ago
                                            </td>
                                        </tr>
                                </table>
                                <div class="afterForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/Forensicating+Docker+Part+1/20835/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/Why+Users+Fall+For+Ransomware/20867/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div><p><a href="/register.html">Sign Up for Free</a> or <a href="/login.html">Log In</a> to start participating in the conversation!</p>
        </div>
    </div>
    <div id="navigation">
        <ul>
            <li><a href="/contact.html">Contact Us</a>
                <ul>
                    <li class="first"><a href="/about.html">About Us</a></li>
                    <li><a href="/handler_list.html">Handlers</a></li>
                    <li><a href="/events">Events</a></li>
                </ul>
            </li>
            <li><a href="/diaryarchive.html">Diary</a></li>
            <li><a href="/podcast.html">Podcasts</a></li>
            <li><a href="/jobs">Jobs</a></li>
            <li><a href="/newssummary.html">News</a></li>
            <li><a href="/tools/">Tools</a>
                <ul>
                    <li class="first"><a href="/howto.html">DShield Sensor</a></li>
                    <li><a href="/404project/">404Project</a></li>
                    <li><a href="/glossary.html">InfoSec Glossary</a></li>
                    <li><a href="/webhoneypot/index.html">Webhoneypot</a></li>
                    <li><a href="/fightback.html">Fightback</a></li>
                </ul>
            </li>
            <li><a href="/reports.html">Data</a>
                <ul>
                    <li><a href="/ssh.html">SSH Scanning Activity</a></li>
                    <li><a href="/crls.html">SSL CRL Activity</a></li>
                    <li><a href="/port.html">TCP/UDP Port Activity</a></li>
                    <li><a href="/httpheaders/">HTTP Header Activity</a></li>
                    <li><a href="/threatfeed.html">Threat Feeds Activity</a></li>
                    <li><a href="/threatmap.html">Threat Feeds Map</a></li>
                    <li><a href="/suspicious_domains.html">Suspicious Domains</a></li>
                    <li><a href="/presentations/">Presentations &amp; Papers</a></li>
                    <li><a href="/links.html">Useful InfoSec Links</a></li>
                    <li><a href="/poll.html">InfoSec Poll Results</a></li>
                </ul>
            </li>
            <li class="active"><a href="/forums/">Forums</a>
                <ul>
                    <li><a href="/forums/Auditing/">Auditing</a></li>
                    <li><a href="/forums/Diary+Discussions/">Diary Discussions</a></li>
                    <li><a href="/forums/Forensics/">Forensics</a></li>
                    <li><a href="/forums/General+Discussion/">General Discussions</a></li>
                    <li><a href="/forums/Industry+News/">Industry News</a></li>
                    <li><a href="/forums/Network+Security/">Network Security</a></li>
                    <li><a href="/forums/Penetration+Testing/">Penetration Testing</a></li>
                    <li><a href="/forums/Software+Security/">Software Security</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="sidebar">
        <p>Subscribe to the Internet Storm Center <a href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A">YouTube Channel</a></p>
        <iframe width="160" height="600" src="https://www.sans.org/banners/isc_ss.php" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>
	</div>
</div>
<div id="footer">
	<ul id="socialIconsFoot">
        <li><a href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A">YouTube<span></span></a></li>
        <li class="twitter"><a href="http://twitter.com/sans_isc">Twitter<span></span></a></li>
        <li class="linkedin"><a href="http://www.linkedin.com/groups?gid=35470">LinkedIn<span></span></a></li>
        <li class="rss"><a href="/xml.html">ISC Feed<span></span></a></li>
	</ul>
	<a class="sans" href="https://www.sans.edu/"><span></span></a>
	<ul id="footLinks">
        <li><a href="http://www.cafepress.com/stormcenter">Shop</a></li>
        <li><a href="/linkback.html">Link To Us</a></li>
        <li><a href="/about.html">About Us</a></li>
        <li><a href="/handler_list.html">Handlers</a></li>
        <li><a href="/privacy.html">Privacy Policy</a></li>
        <li><a href="#top">Back To Top</a></li>
	</ul>
	<strong>Developers:</strong> We have an <a href="/api/">API</a> for you! &nbsp; <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="/images/cc.png" /></a>
</div>
</body></html>