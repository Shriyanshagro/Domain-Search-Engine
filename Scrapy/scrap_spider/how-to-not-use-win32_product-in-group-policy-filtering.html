<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,requiresActiveX=false" />
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	
	<title>How to NOT Use Win32_Product in Group Policy Filtering | Ask the Directory Services Team</title>

	<meta name="description" content="Microsoft&#039;s official enterprise support blog for AD DS and more">

	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="https://blogs.technet.microsoft.com/askds/xmlrpc.php">
	<!-- Move Favicons To Child Theme Functions -->
	<!--<link rel="shortcut icon" href="https://blogs.technet.microsoft.com/askds/wp-content/themes/cloud-platform/images/favicon.ico" />-->
	<meta name="msvalidate.01" content="01EEB8C34FE4A6AA047F3FA8A590C583" />
	<link rel="alternate" type="application/rss+xml" title="Ask the Directory Services Team &raquo; Feed" href="https://blogs.technet.microsoft.com/askds/feed/" />
<link rel="alternate" type="application/rss+xml" title="Ask the Directory Services Team &raquo; Comments Feed" href="https://blogs.technet.microsoft.com/askds/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Ask the Directory Services Team &raquo; How to NOT Use Win32_Product in Group Policy Filtering Comments Feed" href="https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/feed/" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How to NOT Use Win32_Product in Group Policy Filtering" />
<meta property="og:url" content="https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/" />
<meta property="og:description" content="" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="How to NOT Use Win32_Product in Group Policy Filtering" />
<meta name="twitter:url" content="https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/" />
<meta name="twitter:description" content="" />
<link rel='stylesheet' id='sfmsb-style-css'  href='https://blogs.technet.microsoft.com/askds/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/css/style.css?ver=3.3.3' type='text/css' media='all' />
<link rel='stylesheet' id='sfmsb-icons-css'  href='https://blogs.technet.microsoft.com/askds/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/css/icons.css?ver=3.3.3' type='text/css' media='all' />
<link rel='stylesheet' id='wds_msdn-parent-style-css'  href='https://blogs.technet.microsoft.com/askds/wp-content/themes/msdn-network-parent/style.min.css?ver=06182015' type='text/css' media='all' />
<link rel='stylesheet' id='wds_cloud_platform-child-style-css'  href='https://blogs.technet.microsoft.com/askds/wp-content/themes/cloud-platform/style.min.css?ver=05262014' type='text/css' media='all' />
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-includes/js/jquery/jquery.js?ver=1.11.1'></script>
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/js/front-widget.js?ver=3.3.3'></script>
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-content/themes/msdn-network-parent/js/social-counts.min.js?ver=4.1.5'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.technet.microsoft.com/askds/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.technet.microsoft.com/askds/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.1.5" />
<link rel='canonical' href='https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/' />
<link rel='shortlink' href='https://blogs.technet.microsoft.com/askds/?p=427' />
<script type="text/javascript">
    jQuery( window ).load(
        function() {
            if (!document.getElementById("gajs"))
            {
                window._gaq = window._gaq || [];
                                var pluginUrl ='//www.google-analytics.com/plugins/ga/inpage_linkid.js';
                window._gaq.push(['_require', 'inpage_linkid', pluginUrl]);
                window._gaq.push(['_setAccount', 'UA-65691138-1']);
                                window._gaq.push(['_trackPageview']);
                                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.id = 'gajs';
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            }
        });
</script>
			<!-- Begin Custom CSS --><style type="text/css" id="wds-custom-css">
			.entry-content blockquote {
    border: 0;
    padding: 0 0 0 0px;
    margin: 0 0 15px 20px;
}
.entry-content blockquote p {
    font-size: 14px;
    line-height: 1.5;
}.home .blog-title {
  margin: 10px 0 20px;
  font-size: 29px;
}

.network-home-highlights-wrapper {
  font-size: 14px;
  font-family: WOL_Reg, 'Segoe UI', Tahoma, Arial, sans-serif;
}
.network-home-highlights-wrapper .entry-title {
  font-size: 16px;
}
.network-home-highlights-wrapper .blog-source {
  font-size: 12px;
}

.widget .widget-title {
  color: #2a2a2a;
  font-size: 16px;
}

.widget-link-list {
  list-style-type: none;
  margin: 0 0 30px 0;
  padding: 0;
}
.widget-link-list li {
  margin: 0 0 7px 0;
  padding: 0;
}

.widget-link-list img {
	margin: 0; 
	padding: 0;
}

.widget .widget-rss-link {
  position: relative;
}
.widget .widget-rss-link a {
  display: block;
  position: absolute;
  top: -39px;
  right: 0;
  width: 14px;
  height: 14px;
}
.widget .widget-rss-link a img {
  padding: 0;
}

/*Main Navigation*/
.main-navigation {
	font-size: 13px;
}
.main-navigation ul {
	/* subnav adjacent item gap - allows subnav to not appear connected to adjacent menu items */
	display: block;
	table-layout: auto;
}

.main-navigation ul li {
	display: block; /* subnav adjacent item gap */
}

.main-navigation ul,
.main-navigation li {
	background: #00368a;
	margin: 0;
}
.main-navigation ul li {
	padding: 0;
}
.main-navigation li a {
	height: 60px;
	padding: 5px 30px 6px 10px;
}

.main-navigation .menu > .menu-item {
	border-bottom: 1px solid #fff; /* subnav adjacent item gap */
}
.main-navigation .menu > .menu-item.active {
	background: #01265f;
	border-bottom-color: #01265f;
}

.main-navigation li:hover {
  background: #01265f;
}

.main-navigation ul .sub-menu {
	margin-top: 1px; /* subnav adjacent item gap */
}

.main-navigation li .sub-menu li a {
	line-height: 1.3em;
}

.sub-menu.active li {
	background: #01265f;
}

.sub-menu.active li:hover{
  background: #00368a;
}
/*End Main Navigation*/

.child-level-below-nav .blog-title a {
  color: #00368a;
}

a:visited,
h2.entry-title a:visited {
  color: #969696;
}

a:hover,
h2.entry-title a:hover {
  color: #004185;
}

.child-level-below-nav .blog-title {
  font-size: 3.9rem;
}

h1.entry-title {
  font-size: 2.6rem;
  margin-bottom: 8px;
}
h2.entry-title {
  font-size: 2rem;
  margin-bottom: 8px;
}
h2.entry-title a {
  color: #0072c6;
}

.entry-meta {
  margin-bottom: 8px;
}

.post-info {
  margin-bottom: 0;
}

.entry-summary {
  margin-top: 0;
}

.social-icons-wrap ul {
  margin-top: 12px;
}

.wds-ratings-stars.current-rating,
.wds-ratings-stars.current-rating.wds-ratings-active,
.wds-ratings-stars.wds-ratings-active {
  color: #f4b93f;
}

/* Begin tabs and container for sxp */
	.layout-region.content .sxp-title {font-size: 1.333em/*16px*/;}
	.sxp-feed p.sxp-time-author-comments {margin: 4px 0 -8px;}
	.sxp-feed {margin-top: 30px;}
  .right-sidebar .sxp-feed {margin: 0 0 15px 0;}
	.sxp-feed:first-child {margin-top: 0;}
	.sxp-feed p {margin: 12px 0 0;}
  .right-sidebar .sxp-feed p {margin: 0;}
	.sxp-feed .sxp-time {color: #707070;}
	.sxp-feed .sxp-comments {margin-left: 21px; padding-left: 16px; background: url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/7282.icon-comments.png') 0 4px no-repeat;}
	.sxp-container {padding: 0 20px;}
  .right-sidebar .sxp-container {padding: 0;}
	#sxp-feed-container-all {}
	#sxp-feed-container-news {display: none;}  
	#sxp-feed-container ul {padding: 0 0 0 15px;}
	#sxp-feed-container-parent {position: relative; border: solid 1px #ccc; border-width: 0 1px 1px; padding: 0 0 20px;}
	#sxp-tabs {margin: 0 0 30px; width: 100%; background: #00368a; height: 32px; padding: 0 !important; border-bottom: solid 1px #ccc; font-size: 14px;}
	#sxp-tabs li {list-style-type: none; height: 32px; position: relative; float: left; border: solid #CCC; border-width: 0 1px 1px 0;}
	#sxp-tabs a {color: #fff; background: #00368a; height: 100%; line-height: 34px; padding: 0 20px; display: block; margin-left: 0;}
	#sxp-tabs a:hover {text-decoration: none;}
	#sxp-tabs a:first-child + a {left: -3px;}
	#sxp-tabs a:hover {background: #01265f;}
	#sxp-tabs .selected {margin-top: -4px; height: 36px;}
	#sxp-tabs .selected a, #sxp-tabs .selected a:hover {background: #01265f;}
	#sxp-tabs .selected span {z-index: 805; position: absolute; bottom: -7px; width: 100%; height: 7px; background: transparent url('https://msdnshared.blob.core.windows.net/media/2015/11/jj157208.server-management-selected-tail(en-us,MSDN.10).png') no-repeat 50% 0;}
	#all-rss-link {float: right; margin: 0 15px 0 0; padding: 0 15px 0 0; position: relative; top: -21px; }
	#all-rss-link span {margin: 0 0 0 4px; display: inline-block; background: url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/2110.metroRSS.png') 0 0; height: 14px; width: 14px;}
  #all-rss-link a { font-size: 13px; color: #00749e; }
  #all-rss-link a:hover { text-decoration: underline; }
  #all-rss-link a:visited { color: #707070; }
	.feedPager {border-top: solid 1px #ccc; margin: 30px 0 20px; padding: 12px 0;}
	.feedPager a.pagerLink.currentPage {font-weight: bold; color: #000;}
	.feedPager a.pagerLink.currentPage:hover {cursor: default;}
	.feedPager a.pagerLink {margin-left: 15px;}
	.feedPager a.pagerLink:first-child {margin-left: 0;}
	.content-fragment.raw-html:first-child .user-defined-markup {overflow: visible;}
/* End tabs and container for sxp */

/*Social Tile links*/
.sidebar-tiles {
  clear: both;
    list-style: none;
    margin: 0;
    overflow: hidden;
    padding: 0
}
.sidebar-tiles li {
  float: left;
  margin: 0 5px 5px 0;
  padding: 0;
}
.sidebar-tiles a {
    background: #424242;
    color: #fff;
    display: block;
    font-size: 11px;
    margin: 0;
    padding: 54px 10px 0 5px;
    width: 70px;
    height: 70px;
    text-decoration: none;
    line-height: 13px;
    width: 65px;
}
.sidebar-tiles a.sidebar-tile-subscribe {
  background: #ea700d url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/0045.icon-tile-rss.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-twitter {
  background: #55acee url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/twitter-tile.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-facebook {
  background: #3b5998 url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/2055.facebook.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-comments {
  background: #006bc2 url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5415.icon-comments-large.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-contact {
  background: #00368a url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5340.icon-email-large.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-home {
  background: #00368a url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5417.home.png') 50% 50% no-repeat;
}
.sidebar-tiles a:hover {
  color: #fff;
  background-color: #01265f;
}

@media (min-width:37.5em){ /*medium*/
  .home .blog-title {
    margin: -10px 0 20px;
    font-size: 39px;
  }
  .main-navigation ul {
  	height: 121px;
  }
}
@media (min-width:60em){ /*large*/
  .main-navigation ul {
  	height: 58px;
  }
}	

/*Child specific styles*/

.child-level-below-nav h2.blog-title {
  margin: 10px 0 8px;
  padding: 0;
  font-size: 29px;
}

.child-level-below-nav .child-below-nav-right img {
  float: none;
  top: auto;
  margin: 23px 0 0;
}
.site-content {
  margin: 2rem auto 0; /* need space after site logo */
}

.sidebar-btn {
  margin: 0 0 13px 0;
  color: #fff;
}
.sidebar-btn-purple {
  background-color: #68217a;
}
.sidebar-btn-green {
  background-color: #009E49;
}
.sidebar-btn-cyan {
  background-color: #0072C6;
}
.sidebar-btn a {
  line-height: 34px; 
  font-family: 'Segoe UI Semibold','Segoe UI',Tahoma,Helvetica,Sans-Serif;
  padding: 0 30px 0 35px;
  display: table-cell;
  vertical-align: middle;
  background: url('http://cdn3.visualstudio.com/Areas/VisualStudio/Themes/VStudio/Content/Images/arrowWhite.png') no-repeat right center;
  border-right: 10px solid transparent; 
  color: #fff;
}
.sidebar-btn a:hover {
  text-decoration: underline;
  color: #fff;
}


@media (min-width:37.5em){ 
  .child-level-below-nav h2.blog-title {
    margin: 10px 0 8px;
    padding: 0;
    font-size: 39px;
  }
}
@media (min-width:48.125em){
  .child-level-below-nav .child-below-nav-right img {
    float: none;
    top: auto;
    margin: 23px 0 0;
  }
  #secondary {
      float: right;
      width: 23.5492%;
  }
  #tag-wrap,
  .comments-area {
      clear: left;
      width: 74.5164%;
  }
  .comments-area .comment-list {
      clear: left;
  }
}
@media (min-width:60em){ 

}			</style><!-- End Custom CSS -->
						<link rel="shortcut icon" href="https://blogs.technet.microsoft.com/askds/wp-content/themes/cloud-platform/images/favicon-technet.png" >
		<meta property="Search.Network" name="Search.Network" content="ceblognetwork" />
</head>

<body class="single single-post postid-427 single-format-standard msdn-2188 group-blog">
	<div id="top-link"></div>

	
<div class="site-header-wrap">
	<header id="masthead" class="site-header" role="banner">
		<div class="top-breadcrumb-wrap-child">

			<div class="top-breadcrumbs"><a href ="https://blogs.technet.microsoft.com/serverandtools">Server & Tools Blogs</a> > <a href ="https://blogs.technet.microsoft.com/server-management">Server &amp; Management Blogs</a> > Ask the Directory Services Team</div>
			<div class="utility-breadcrumbs">
				<nav id="site-utility-navigation" class="utility-navigation" role="navigation">
					<div class="menu-utility-nav-container">
						<ul id="menu-utility-nav" class="menu">
															<li class="menu-item"><a href="https://blogs.technet.microsoft.com/wp-login.php?aadsso_action=login">Sign in</a></li>
													</ul>
					</div>
				</nav>
			</div>
		</div>

		<a href="#togglemenu" class="header-mobile-dropdown-toggle-child">Menu</a>
		<div class="header-mobile-dropdown-child-level">
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<a class="skip-link screen-reader-text" href="#content">
					Skip to content				</a>
								<div class="menu-server-and-management-blogs-main-menu-container"><ul id="menu-server-and-management-blogs-main-menu-1" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-33"><a href="#">All About Windows Server</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113"><a href="https://blogs.technet.microsoft.com/windowsserver/">Windows Server</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-123"><a href="https://blogs.technet.microsoft.com/sbs/">Windows Server Essentials</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-143"><a href="https://blogs.technet.microsoft.com/askperf/">Ask the Performance Team</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-153"><a href="https://blogs.technet.microsoft.com/askpfeplat/">Ask Premier Field Engineering (PFE) Platforms</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-652"><a href="https://blogs.technet.microsoft.com/askcore/">Ask the Core Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-43"><a href="#">Cloud Platform Blogs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-223"><a href="https://blogs.technet.microsoft.com/server-cloud/">Server &amp; Cloud</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-661"><a href="https://azure.microsoft.com/blog/">Microsoft Azure</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-214"><a href="https://blogs.technet.microsoft.com/privatecloud/">Building Clouds</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-204"><a href="https://blogs.technet.microsoft.com/in_the_cloud/">Brad Anderson &#8211; In the Cloud</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-53"><a href="#">Datacenter Management</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-233"><a href="https://blogs.technet.microsoft.com/systemcenter/">Hybrid Cloud IT Management</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-653"><a href="https://blogs.technet.microsoft.com/msoms/">Operations Management Suite (OMS)</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-243"><a href="https://blogs.technet.microsoft.com/scvmm/">System Center Virtual Machine Manager</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-253"><a href="https://blogs.technet.microsoft.com/servicemanager/">System Center Service Manager</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-263"><a href="https://blogs.technet.microsoft.com/momteam/">System Center Operations Manager</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-283"><a href="https://blogs.technet.microsoft.com/orchestrator/">System Center Orchestrator</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-63"><a href="#">Client Management</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-293"><a href="https://blogs.technet.microsoft.com/configurationmgr/">System Center Configuration Manager</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-303"><a href="https://blogs.technet.microsoft.com/servicemanager/">System Center Service Manager</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-313"><a href="https://blogs.technet.microsoft.com/mmpc/">Malware Protection Center</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-323"><a href="https://blogs.technet.microsoft.com/microsoftintune/">Microsoft Intune</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-333"><a href="https://blogs.technet.microsoft.com/sus/">Server Update Services</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-343"><a href="https://blogs.technet.microsoft.com/enterprisemobility/">Enterprise Mobility</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-73"><a href="#">Virtualization, VDI &amp; Remote Desktop</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-353"><a href="https://blogs.technet.microsoft.com/virtualization/">Virtualization Team</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-363"><a href="http://blogs.msdn.microsoft.com/virtual_pc_guy/">Ben Armstrong&#8217;s Virtualization</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-364"><a href="https://blogs.technet.microsoft.com/josebda/tag/hyper-v/">Jose Barreto on Hyper-V</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-374"><a href="http://blogs.msdn.microsoft.com/rds/">Remote Desktop Services</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-394"><a href="https://blogs.technet.microsoft.com/askcore/tag/hyper-v/">Ask the Core Team on Hyper-V</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-403"><a href="https://blogs.technet.microsoft.com/enterprisemobility/">Enterprise Mobility</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-83"><a href="#">File &amp; Storage &amp; High Availability</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-404"><a href="https://blogs.technet.microsoft.com/filecab/">File &amp; Storage</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-413"><a href="https://blogs.technet.microsoft.com/josebda/">Jose Barreto</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-414"><a href="https://blogs.technet.microsoft.com/askcore/tag/failover-cluster/">Ask the Core Team on Failover Cluster</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-423"><a href="http://blogs.msdn.microsoft.com/clustering/">Clustering &amp; High Availability</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-93"><a href="#">Windows Server Management</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-433"><a href="http://blogs.msdn.microsoft.com/powershell/">PowerShell</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-443"><a href="https://blogs.technet.microsoft.com/heyscriptingguy/">Hey Scripting Guy (PowerShell)</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-463"><a href="https://blogs.technet.microsoft.com/networking/">Networking</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-103"><a href="#">Identity, Access &amp; Security</a>
<ul class="sub-menu">
	<li id="menu-item-666" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-666"><a href="https://blogs.technet.microsoft.com/datacentersecurity/">Datacenter and Private Cloud Security</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-473"><a href="https://blogs.technet.microsoft.com/askds/">Ask Directory Services</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-483"><a href="https://blogs.technet.microsoft.com/ad/">Active Directory</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-493"><a href="https://blogs.technet.microsoft.com/enterprisemobility/">Enterprise Mobility</a></li>
</ul>
</li>
</ul></div>			</nav> <!-- #site-navigation -->
					</div>

		<div class="child-level-below-nav">

			<div class="child-below-nav-wrapper">

				<div class="child-below-nav-left">

						<div class="blog-name">
		<div class="inner-name-wrapper">
			<h2 class="blog-title"><a href="https://blogs.technet.microsoft.com/askds">Ask the Directory Services Team</a></h2>
					</div>
	</div>

					<p class="blog-description">Microsoft&#039;s official enterprise support blog for AD DS and more </p>

				</div>

				<div class="child-below-nav-right">
									</div>

			</div>

			
		</div>
		<link rel="alternate" type="application/rss+xml" title="Ask the Directory Services Team &raquo; Feed" href="https://blogs.technet.microsoft.com/askds/feed/" />
<link rel="alternate" type="application/rss+xml" title="Ask the Directory Services Team &raquo; Comments Feed" href="https://blogs.technet.microsoft.com/askds/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Ask the Directory Services Team &raquo; How to NOT Use Win32_Product in Group Policy Filtering Comments Feed" href="https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/feed/" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How to NOT Use Win32_Product in Group Policy Filtering" />
<meta property="og:url" content="https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/" />
<meta property="og:description" content="" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="How to NOT Use Win32_Product in Group Policy Filtering" />
<meta name="twitter:url" content="https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/" />
<meta name="twitter:description" content="" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.technet.microsoft.com/askds/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.technet.microsoft.com/askds/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.1.5" />
<link rel='canonical' href='https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/' />
<link rel='shortlink' href='https://blogs.technet.microsoft.com/askds/?p=427' />
<script type="text/javascript">
    jQuery( window ).load(
        function() {
            if (!document.getElementById("gajs"))
            {
                window._gaq = window._gaq || [];
                                var pluginUrl ='//www.google-analytics.com/plugins/ga/inpage_linkid.js';
                window._gaq.push(['_require', 'inpage_linkid', pluginUrl]);
                window._gaq.push(['_setAccount', 'UA-65691138-1']);
                                window._gaq.push(['_trackPageview']);
                                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.id = 'gajs';
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            }
        });
</script>
			<!-- Begin Custom CSS --><style type="text/css" id="wds-custom-css">
			.entry-content blockquote {
    border: 0;
    padding: 0 0 0 0px;
    margin: 0 0 15px 20px;
}
.entry-content blockquote p {
    font-size: 14px;
    line-height: 1.5;
}.home .blog-title {
  margin: 10px 0 20px;
  font-size: 29px;
}

.network-home-highlights-wrapper {
  font-size: 14px;
  font-family: WOL_Reg, 'Segoe UI', Tahoma, Arial, sans-serif;
}
.network-home-highlights-wrapper .entry-title {
  font-size: 16px;
}
.network-home-highlights-wrapper .blog-source {
  font-size: 12px;
}

.widget .widget-title {
  color: #2a2a2a;
  font-size: 16px;
}

.widget-link-list {
  list-style-type: none;
  margin: 0 0 30px 0;
  padding: 0;
}
.widget-link-list li {
  margin: 0 0 7px 0;
  padding: 0;
}

.widget-link-list img {
	margin: 0; 
	padding: 0;
}

.widget .widget-rss-link {
  position: relative;
}
.widget .widget-rss-link a {
  display: block;
  position: absolute;
  top: -39px;
  right: 0;
  width: 14px;
  height: 14px;
}
.widget .widget-rss-link a img {
  padding: 0;
}

/*Main Navigation*/
.main-navigation {
	font-size: 13px;
}
.main-navigation ul {
	/* subnav adjacent item gap - allows subnav to not appear connected to adjacent menu items */
	display: block;
	table-layout: auto;
}

.main-navigation ul li {
	display: block; /* subnav adjacent item gap */
}

.main-navigation ul,
.main-navigation li {
	background: #00368a;
	margin: 0;
}
.main-navigation ul li {
	padding: 0;
}
.main-navigation li a {
	height: 60px;
	padding: 5px 30px 6px 10px;
}

.main-navigation .menu > .menu-item {
	border-bottom: 1px solid #fff; /* subnav adjacent item gap */
}
.main-navigation .menu > .menu-item.active {
	background: #01265f;
	border-bottom-color: #01265f;
}

.main-navigation li:hover {
  background: #01265f;
}

.main-navigation ul .sub-menu {
	margin-top: 1px; /* subnav adjacent item gap */
}

.main-navigation li .sub-menu li a {
	line-height: 1.3em;
}

.sub-menu.active li {
	background: #01265f;
}

.sub-menu.active li:hover{
  background: #00368a;
}
/*End Main Navigation*/

.child-level-below-nav .blog-title a {
  color: #00368a;
}

a:visited,
h2.entry-title a:visited {
  color: #969696;
}

a:hover,
h2.entry-title a:hover {
  color: #004185;
}

.child-level-below-nav .blog-title {
  font-size: 3.9rem;
}

h1.entry-title {
  font-size: 2.6rem;
  margin-bottom: 8px;
}
h2.entry-title {
  font-size: 2rem;
  margin-bottom: 8px;
}
h2.entry-title a {
  color: #0072c6;
}

.entry-meta {
  margin-bottom: 8px;
}

.post-info {
  margin-bottom: 0;
}

.entry-summary {
  margin-top: 0;
}

.social-icons-wrap ul {
  margin-top: 12px;
}

.wds-ratings-stars.current-rating,
.wds-ratings-stars.current-rating.wds-ratings-active,
.wds-ratings-stars.wds-ratings-active {
  color: #f4b93f;
}

/* Begin tabs and container for sxp */
	.layout-region.content .sxp-title {font-size: 1.333em/*16px*/;}
	.sxp-feed p.sxp-time-author-comments {margin: 4px 0 -8px;}
	.sxp-feed {margin-top: 30px;}
  .right-sidebar .sxp-feed {margin: 0 0 15px 0;}
	.sxp-feed:first-child {margin-top: 0;}
	.sxp-feed p {margin: 12px 0 0;}
  .right-sidebar .sxp-feed p {margin: 0;}
	.sxp-feed .sxp-time {color: #707070;}
	.sxp-feed .sxp-comments {margin-left: 21px; padding-left: 16px; background: url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/7282.icon-comments.png') 0 4px no-repeat;}
	.sxp-container {padding: 0 20px;}
  .right-sidebar .sxp-container {padding: 0;}
	#sxp-feed-container-all {}
	#sxp-feed-container-news {display: none;}  
	#sxp-feed-container ul {padding: 0 0 0 15px;}
	#sxp-feed-container-parent {position: relative; border: solid 1px #ccc; border-width: 0 1px 1px; padding: 0 0 20px;}
	#sxp-tabs {margin: 0 0 30px; width: 100%; background: #00368a; height: 32px; padding: 0 !important; border-bottom: solid 1px #ccc; font-size: 14px;}
	#sxp-tabs li {list-style-type: none; height: 32px; position: relative; float: left; border: solid #CCC; border-width: 0 1px 1px 0;}
	#sxp-tabs a {color: #fff; background: #00368a; height: 100%; line-height: 34px; padding: 0 20px; display: block; margin-left: 0;}
	#sxp-tabs a:hover {text-decoration: none;}
	#sxp-tabs a:first-child + a {left: -3px;}
	#sxp-tabs a:hover {background: #01265f;}
	#sxp-tabs .selected {margin-top: -4px; height: 36px;}
	#sxp-tabs .selected a, #sxp-tabs .selected a:hover {background: #01265f;}
	#sxp-tabs .selected span {z-index: 805; position: absolute; bottom: -7px; width: 100%; height: 7px; background: transparent url('https://msdnshared.blob.core.windows.net/media/2015/11/jj157208.server-management-selected-tail(en-us,MSDN.10).png') no-repeat 50% 0;}
	#all-rss-link {float: right; margin: 0 15px 0 0; padding: 0 15px 0 0; position: relative; top: -21px; }
	#all-rss-link span {margin: 0 0 0 4px; display: inline-block; background: url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/2110.metroRSS.png') 0 0; height: 14px; width: 14px;}
  #all-rss-link a { font-size: 13px; color: #00749e; }
  #all-rss-link a:hover { text-decoration: underline; }
  #all-rss-link a:visited { color: #707070; }
	.feedPager {border-top: solid 1px #ccc; margin: 30px 0 20px; padding: 12px 0;}
	.feedPager a.pagerLink.currentPage {font-weight: bold; color: #000;}
	.feedPager a.pagerLink.currentPage:hover {cursor: default;}
	.feedPager a.pagerLink {margin-left: 15px;}
	.feedPager a.pagerLink:first-child {margin-left: 0;}
	.content-fragment.raw-html:first-child .user-defined-markup {overflow: visible;}
/* End tabs and container for sxp */

/*Social Tile links*/
.sidebar-tiles {
  clear: both;
    list-style: none;
    margin: 0;
    overflow: hidden;
    padding: 0
}
.sidebar-tiles li {
  float: left;
  margin: 0 5px 5px 0;
  padding: 0;
}
.sidebar-tiles a {
    background: #424242;
    color: #fff;
    display: block;
    font-size: 11px;
    margin: 0;
    padding: 54px 10px 0 5px;
    width: 70px;
    height: 70px;
    text-decoration: none;
    line-height: 13px;
    width: 65px;
}
.sidebar-tiles a.sidebar-tile-subscribe {
  background: #ea700d url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/0045.icon-tile-rss.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-twitter {
  background: #55acee url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/twitter-tile.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-facebook {
  background: #3b5998 url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/2055.facebook.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-comments {
  background: #006bc2 url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5415.icon-comments-large.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-contact {
  background: #00368a url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5340.icon-email-large.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-home {
  background: #00368a url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5417.home.png') 50% 50% no-repeat;
}
.sidebar-tiles a:hover {
  color: #fff;
  background-color: #01265f;
}

@media (min-width:37.5em){ /*medium*/
  .home .blog-title {
    margin: -10px 0 20px;
    font-size: 39px;
  }
  .main-navigation ul {
  	height: 121px;
  }
}
@media (min-width:60em){ /*large*/
  .main-navigation ul {
  	height: 58px;
  }
}	

/*Child specific styles*/

.child-level-below-nav h2.blog-title {
  margin: 10px 0 8px;
  padding: 0;
  font-size: 29px;
}

.child-level-below-nav .child-below-nav-right img {
  float: none;
  top: auto;
  margin: 23px 0 0;
}
.site-content {
  margin: 2rem auto 0; /* need space after site logo */
}

.sidebar-btn {
  margin: 0 0 13px 0;
  color: #fff;
}
.sidebar-btn-purple {
  background-color: #68217a;
}
.sidebar-btn-green {
  background-color: #009E49;
}
.sidebar-btn-cyan {
  background-color: #0072C6;
}
.sidebar-btn a {
  line-height: 34px; 
  font-family: 'Segoe UI Semibold','Segoe UI',Tahoma,Helvetica,Sans-Serif;
  padding: 0 30px 0 35px;
  display: table-cell;
  vertical-align: middle;
  background: url('http://cdn3.visualstudio.com/Areas/VisualStudio/Themes/VStudio/Content/Images/arrowWhite.png') no-repeat right center;
  border-right: 10px solid transparent; 
  color: #fff;
}
.sidebar-btn a:hover {
  text-decoration: underline;
  color: #fff;
}


@media (min-width:37.5em){ 
  .child-level-below-nav h2.blog-title {
    margin: 10px 0 8px;
    padding: 0;
    font-size: 39px;
  }
}
@media (min-width:48.125em){
  .child-level-below-nav .child-below-nav-right img {
    float: none;
    top: auto;
    margin: 23px 0 0;
  }
  #secondary {
      float: right;
      width: 23.5492%;
  }
  #tag-wrap,
  .comments-area {
      clear: left;
      width: 74.5164%;
  }
  .comments-area .comment-list {
      clear: left;
  }
}
@media (min-width:60em){ 

}			</style><!-- End Custom CSS -->
						<link rel="shortcut icon" href="https://blogs.technet.microsoft.com/askds/wp-content/themes/cloud-platform/images/favicon-technet.png" >
		<meta property="Search.Network" name="Search.Network" content="ceblognetwork" />
	</header>
	<!-- #masthead -->
</div>

<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

			
				
				<article id="post-427" class="post-427 post type-post status-publish format-standard hentry category-uncategorized tag-group-policy tag-ned-pyle tag-wmi">
	<header class="entry-header">
		<h1 class="entry-title">How to NOT Use Win32_Product in Group Policy Filtering</h1>
		<div class="rating-wrap">
		<div id="star-rating-427" class="wds-ratings" data-rating="5" data-userrating="0" data-postid="427">
			<div class="wds-ratings-inner-wrap">
				<div>
					<div class="wds-ratings-stars" data-stars="5"><span class="star-1">&#x2605;</span><span class="star-2">&#x2605;</span><span class="star-3">&#x2605;</span><span class="star-4">&#x2605;</span><span class="star-5">&#x2605;</span></div><div class="wds-ratings-stars" data-stars="4"><span class="star-1">&#x2605;</span><span class="star-2">&#x2605;</span><span class="star-3">&#x2605;</span><span class="star-4">&#x2605;</span></div><div class="wds-ratings-stars" data-stars="3"><span class="star-1">&#x2605;</span><span class="star-2">&#x2605;</span><span class="star-3">&#x2605;</span></div><div class="wds-ratings-stars" data-stars="2"><span class="star-1">&#x2605;</span><span class="star-2">&#x2605;</span></div><div class="wds-ratings-stars" data-stars="1"><span class="star-1">&#x2605;</span></div>
				</div>
			</div>
		</div>
		</div>	</header><!-- .entry-header -->

	<div class="entry-meta row">
		<div class="post-info">
			<span class="posted-on"><time class="entry-date published" datetime="2012-04-19T11:22:00+00:00">April 19, 2012</time><time class="updated" datetime="2015-06-25T23:46:27+00:00">June 25, 2015</time></span> <span class="byline">by <span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="87aaefad29f94e3cbba2dc5a79e16ee2" href="https://social.technet.microsoft.com/profile/NedPyle+%5BMSFT%5D">NedPyle [MSFT]</a></span></span> <span class="slashes comment-slashes">//</span> <a class="num-comments" href="https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/#comments">22 Comments</a>		</div>

		<div class="row">
			<div class="social-icons-wrap">
		<ul class="social-icons">
			<li class="social-icon facebook"><a data-social='{"type":"facebook", "url":"https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/", "text": "How to NOT Use Win32_Product in Group Policy Filtering"}' href="#" id="get_post_like_count">0</a></li>
			<li class="social-icon twitter"><a data-social='{"type":"twitter", "url":"https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/", "text": "How to NOT Use Win32_Product in Group Policy Filtering"}' href="#" id="post_tweet_count">0</a></li>
			<li class="social-icon linkedin"><a data-social='{"type":"linkedin", "url":"https://blogs.technet.microsoft.com/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/", "text": "How to NOT Use Win32_Product in Group Policy Filtering"}' href="#" id="get_post_linkedin_count">0</a></li>
		</ul>
	</div><!-- .social-icons-wrap -->
	<script type="text/javascript">
		// Get social counts
		window.msdnsocial.ajax( 'get_post_like_count,post_tweet_count,get_post_linkedin_count' );
	</script>
		</div>
	</div><!-- .entry-meta -->

	
	<div class="entry-content">
		<p>Hi all, <a href="http://blogs.technet.com/b/askds/archive/tags/Ned+Pyle/">Ned</a> here again. I have worked many <a href="http://blogs.technet.com/b/askds/archive/2009/09/23/so-you-have-a-slow-logon-part-1.aspx">slow boot and slow logon</a> cases over my career. The Directory Services support team here at Microsoft owns a sizable portion of those operations &#8211; user credentials, user profiles, logon and startup scripts, and of course, group policy processing. If I had to pick the initial finger pointing that customers routinely make, it&#8217;s GP. Perhaps it&#8217;s because group policy is the least well-understood part of the process, or maybe because it&#8217;s the one with the most administrative fingers in the pie. When it comes down to reality though, group policy is more often <i>not</i> the culprit. Our new changes in Windows 8 will <a href="http://blogs.technet.com/b/askds/archive/2012/04/06/group-policy-management-improvements-in-windows-server-quot-8-quot-beta.aspx">help you make that determination</a> much quicker now.</p>
<p>Today I am going to talk about one of those times that GPO <i>is</i> the villain. Well, sort of&#8230; he&#8217;s at least an enabler. More appropriately, the optional WMI Filtering portion of group policy using the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa394378(v=vs.85).aspx">Win32_Product</a> class. Win32_Product has been around for many years and is both an inventory and administrative tool. It allows you to see all the installed MSI packages on a computer, install new ones, reinstall them, remove them, and configure them. When used correctly, it&#8217;s a valuable option for scripters and Windows PowerShell junkies.</p>
<p>Unfortunately, Win32_Product also has some unpleasant behaviors. It uses a provider DLL that validates the consistency of every installed MSI package on the computer &#8211; or off of it, if using a remote administrative install point. <a href="http://support.microsoft.com/kb/974524">That makes it very, very slow</a>.</p>
<p>Where people trip up usually is group policy WMI filters. Perhaps the customer wants to apply managed Internet Explorer policy based on the IE version. Maybe they want to set <a href="http://technet.microsoft.com/en-us/library/dd723678(v=WS.10).aspx">AppLocker</a> or <a href="http://technet.microsoft.com/en-us/library/cc728085(v=ws.10).aspx">Software Restriction</a> policies only if the client has a certain program installed. Perhaps even use &#8211; yuck &#8211; <a href="http://technet.microsoft.com/en-us/library/cc738151(v=ws.10).aspx">Software Installation</a> policy in a more controlled fashion.</p>
<p>Today I talk about some different options. <a href="http://blogs.technet.com/b/askds/archive/tags/Mike+Stephens/">Mike</a> didn&rsquo;t write this but he had some good thoughts when we talked about this offline so he gets some credit here too. A little bit. Tiny amount, really. Hardly worth mentioning.</p>
<p>If you have no idea what group policy WMI filters are, start here:</p>
<ul>
<li><a href="http://blogs.technet.com/b/askds/archive/2008/09/11/fun-with-wmi-filters-in-group-policy.aspx">Fun with WMI Filters in Group Policy</a></li>
<li><a href="http://blogs.technet.com/b/askds/archive/2012/02/11/friday-mail-sack-get-off-my-lawn-edition.aspx#wmi">Multiple WMI Filters</a></li>
<li><a href="http://blogs.technet.com/b/askds/archive/2008/05/16/bulk-exporting-and-importing-wmi-filters-for-group-policy.aspx">Bulk exporting and importing WMI Filters</a></li>
</ul>
<p>Back? Great, let&#8217;s get to it.</p>
<h1>Don&rsquo;t use Win32_Product</h1>
<p>The Win32_Product WMI class is part of the CIMV2 namespace and implements the MSI provider (msiprov.dll and associated msi.mof) to list and validate<i> </i>installed installation packages. You will see MsiInstaller event 1035 in the Application log for each application queried by the class:</p>
<blockquote>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Source: <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">MsiInstaller</span></span> <br />Event ID: <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">1035</span></span> <br />Description: <br /><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">Windows Installer reconfigured the product. Product Name: &lt;ProductName&gt;. Product Version: &lt;VersionNumber&gt;. Product Language: &lt;languageID&gt;. Reconfiguration success or error status: 0.</span></span></span></span></span></p>
</blockquote>
<p>And constantly repeated System events:</p>
<blockquote>
<p><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Event Source: <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">Service Control Manager</span></span> </span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Event ID: <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">7035</span></span> </span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Description: </span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000"><span style="background-image: none; line-height: 12pt; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">The Windows Installer service was successfully sent a start control.</span></span><span style="line-height: 12pt;"> </span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas; color: #000000;" face="Consolas" color="#000000">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Event Type: Information </span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Event Source: <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">Service Control Manager</span></span> </span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Event ID: <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">7036</span></span> </span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; list-style-type: disc; margin: 0in 0in 0pt 0.5in;"><span style="line-height: 12pt;"><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">Description: </span></span></span></p>
</blockquote>
<p>That validation piece is the real speed killer. So much, in fact, that it can lead to group policy processing taking many extra minutes in Windows XP when you use this class in a WMI filter &#8211; or even cause processing to time out and fail altogether.. This is even more likely when:</p>
<ul>
<li>The client contains many installed applications</li>
<li>Installation packages are sourced from remote file servers</li>
<li>Install packages used certificate validation and the user cannot access the certificate revocation list for that package</li>
<li>Your client hardware is&hellip; crusty.</li>
</ul>
<p>Furthermore, Windows Vista and later Windows versions cap WMI filters execution times at 30 seconds; if they fail to complete by then, they are treated as FALSE. On those OS versions, it will often appear that Win32_Product just doesn&rsquo;t work at all.</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/8713.image_327A473F.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/8713.image_5F00_327A473F.png"><img width="244" height="164" title="image" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/3010.image_thumb_1AE299CC.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/3010.image_5F00_thumb_5F00_1AE299CC.png" border="0" /></a></p>
</blockquote>
<p>What are your alternatives?</p>
<h1>Group Policy Preferences, maybe</h1>
<p>Depending on what you are trying to accomplish, Group Policy Preferences could be the solution. GPP includes item-level targeting that has fast, efficient filtering of just about any criteria you can imagine. If you are trying to set some computer-based settings that a user cannot change and don&rsquo;t mind preferences instead of managed policy settings, GPP is the way to go. As with all software, make sure you evaluate our latest patches to ensure it works as desired. As of this writing, those are:</p>
<ul>
<li>Win2008, Win2008 R2 &#8211; <a href="http://support.microsoft.com/kb/2653810">http://support.microsoft.com/kb/2653810</a></li>
<li>Win7 &#8211; <a href="http://support.microsoft.com/kb/2561285">http://support.microsoft.com/kb/2561285</a></li>
<li>WinXP, Win2003 &#8211; <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;982051">http://support.microsoft.com/default.aspx?scid=kb;EN-US;982051</a></li>
<li>WinVista &#8211; <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;2526870">http://support.microsoft.com/default.aspx?scid=kb;EN-US;2526870</a></li>
</ul>
<p>For instance, let&#8217;s say you have a plotting printer that Marketing cannot correctly use without special Contoso client software. Rather than using managed computer policy to control client printer installation and settings, you can use GPP Registry or Printer settings to modify the values needed.</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/5670.image_3F76B801.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/5670.image_5F00_3F76B801.png"><img width="409" height="396" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/5141.image_thumb_688156FD.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/5141.image_5F00_thumb_5F00_688156FD.png" border="0" /></a></p>
</blockquote>
<p>Then you can use Item Level Targeting to control the installation based on the specialty software&#8217;s presence and version.</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/3404.image_639EA341.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/3404.image_5F00_639EA341.png"><img width="399" height="197" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/7723.image_thumb_17D2CC88.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/7723.image_5F00_thumb_5F00_17D2CC88.png" border="0" /></a></p>
</blockquote>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/4503.image_0E799805.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/4503.image_5F00_0E799805.png"><img width="606" height="410" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/4064.image_thumb_697BD78B.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/4064.image_5F00_thumb_5F00_697BD78B.png" border="0" /></a></p>
</blockquote>
<p>Alternatively, you can use the registry and file system for your criteria, which works even if the software doesn&#8217;t install via MSI packages:</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/3021.image_649923CF.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/3021.image_5F00_649923CF.png"><img width="604" height="409" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/2844.image_thumb_0DA3C2CC.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/2844.image_5F00_thumb_5F00_0DA3C2CC.png" border="0" /></a></p>
</blockquote>
<h1>An alternative to Win32_Product</h1>
<h3></h3>
<p>What to do if you really, <i>really</i> need to use a WMI filter to determine MSI installed versions and names though? If you look around the Internet, you will find a couple of older proposed solutions that &#8211; to be frank &#8211; will not work for most customers.</p>
<ol>
<li>Use the Win32reg_AddRemovePrograms class instead.</li>
<li>Use a custom class (like described <a href="http://technet.microsoft.com/en-us/library/ee692772.aspx">here</a> and frequently copied/pasted on the Interwebz).</li>
</ol>
<p>The Win32reg_AddRemovePrograms is not present on most client systems though; it is a legacy class, first delivered by the old SMS 2003 management WMI system. I suspect one of the reasons the System Center folks discarded its use&nbsp;years ago for their own native inventory system was the same reason that the customer class above doesn&rsquo;t work in #2 &#8211; it didn&rsquo;t return 32-bit software installed on 64-bit computers. The class has not been updated since initial release 10 years ago.</p>
<p>#2 had the right idea though, at least as a valid customer workaround to avoid using Win32_Product: by creating your own WMI class using the generic registry provider to examine just the MSI uninstall registry keys, you can get a fast and simple query that reasonably detects installed software. Armed with the &#8220;how&#8221;, you can also extend this to any kind of registry queries you need, without risk of tanking group policy processing. To do this, you just need notepad.exe and a little understanding of WMI.</p>
<h2>Roll Your Own Class</h2>
<p>Windows Management Instrumentation uses <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa823192(v=vs.85).aspx">Managed Operation Framework</a> (MOF) files to describe the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa389234(v=vs.85).aspx">Common Information Model</a> (CIM) classes. You can create your own MOF files and compile them into the CIM repository using a simple command-line tool called <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa392389(v=vs.85).aspx">mofcomp.exe</a>.</p>
<p>You need to be careful here. This means that once you write your MOF you should validate it by using the <b>mofcomp.exe</b> <b>-check </b>argument on your standard client and server images. It also means that you should test this on those same machines using the <b>-class:createonly </b>argument (and <i>not</i> setting the <b>-autorecover</b> argument or <b>#PRAGMA AUTORECOVER</b> pre-processor) to ensure it doesn&#8217;t already exist. The last thing you want to do is break some other class.</p>
<p>When done testing, you&#8217;re ready to give it a go. Here is a sample MOF, wrapped for readability. Note the highlighted sections that describe what the MOF <span style="background-color: #ffff00;">examines</span> and what the group policy WMI filter can use as <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">query</span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span> </span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;"></span></span>criteria. Unlike the oft-copied sample, this one understands both the normal native architecture registry path as well as the Wow6432node path that covers 32-bit applications installed on a 64-bit system.</p>
<p><b><i>Start copy below =======&gt; <br /></i></b></p>
<p><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">// &#8220;AS-IS&#8221; sample MOF file for returning the two uninstall registry subkeys</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">// Unsupported, provided purely as a sample</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">// Requires compilation. Example: mofcomp.exe sampleproductslist.mof</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">// Implements sample classes: &#8220;SampleProductList&#8221; and &#8220;SampleProductlist32&#8243; </span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>(for 64-bit systems with 32-bit software)</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas; color: #000000;" face="Consolas" color="#000000">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">#PRAGMA AUTORECOVER</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas; color: #000000;" face="Consolas" color="#000000">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[dynamic, provider(&#8220;RegProv&#8221;),</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">ProviderClsid(&#8220;{fe9af5c0-d3b6-11ce-a5b6-00aa00680c3f}&#8221;),ClassContext(&#8220;<span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">local|HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall</span></span>&#8220;)]</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">class <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">SampleProductsList</span></span> {</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[key] string KeyName;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[read, propertycontext(&#8220;<span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayName</span></span>&#8220;)] string <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayName</span></span>;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[read, propertycontext(&#8220;<span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayVersion</span></span>&#8220;)] string <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayVersion</span></span>;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">};</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas; color: #000000;" face="Consolas" color="#000000">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[dynamic, provider(&#8220;RegProv&#8221;),</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">ProviderClsid(&#8220;{fe9af5c0-d3b6-11ce-a5b6-00aa00680c3f}&#8221;),ClassContext(&#8220;<span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">local|HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432node\\Microsoft\\Windows\\CurrentVersion\\Uninstall</span></span>&#8220;)]</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">class <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">SampleProductsList32</span></span> {</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[key] string KeyName;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[read, propertycontext(&#8220;<span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayName</span></span>&#8220;)] string <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayName</span></span>;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">[read, propertycontext(&#8220;<span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayVersion</span></span>&#8220;)] string <span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: aqua;"><span style="background-color: #00ffff;">DisplayVersion</span></span>;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;"><span><span style="font-family: consolas;" face="Consolas"><span style="color: #000000;" color="#000000">};</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; list-style-type: disc; margin: 0in 0in 0pt;">
<p><b><i>&lt;======= End copy above</i></b></p>
<p>Examining this should also give you interesting ideas about other registry-to-WMI possibilities, I imagine.</p>
<h2>Test Your Sample</h2>
<p>Copy this sample to a text file named with a <b>MOF</b> extension, store it in the %systemroot%\system32\wbem folder on a test machine, and then compile it from an administrator-elevated CMD prompt using <b>mofcomp.exe <i>filename</i></b>. For example:</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/5148.image_36AE61C8.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/5148.image_5F00_36AE61C8.png"><img width="509" height="151" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/7612.image_thumb_760C1558.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/7612.image_5F00_thumb_5F00_760C1558.png" border="0" /></a></p>
</blockquote>
<p>To test if the sample is working you can use WMIC.EXE to list the installed MSI packages. For example, here I am on a Windows 7 x64 computer with Office 2010 installed; that suite contains both 64 and 32-bit software so I can use both of my custom classes to list out all the installed software:</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/4064.image_11446E5A.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/4064.image_5F00_11446E5A.png"><img width="628" height="279" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/5732.image_thumb_07EB39D7.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/5732.image_5F00_thumb_5F00_07EB39D7.png" border="0" /></a></p>
</blockquote>
<p>Note that I did not specify a namespace in the sample MOF, which means it updates the <strong>\\root\default</strong> namespace, instead of the more commonly used <strong>\\root\cimv2</strong> namespace. This is intentional: the Windows XP implementation of registry provider is in the Default namespace, so this makes your MOF OS agnostic. It will work perfectly well on XP, 2003, 2008, Vista, 7, or even the Windows 8 family. Moreover, I don&rsquo;t like updating the CIMv2 namespace if I can avoid it &#8211; it already has enough classes and is a bit of a dumping ground.</p>
<h2>Deploy Your Sample</h2>
<p>Now I need a way to get this MOF file to all my computers. The easiest way is to return to Group Policy Preferences; create a GPP policy that copies the file and creates a scheduled task to run MOFCOMP at every boot up (you can change this scheduling later or even turn it off, once you are confident all your computers have the new classes).</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/8787.image_3089A5DE.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/8787.image_5F00_3089A5DE.png"><img width="586" height="275" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/0250.image_thumb_7290151F.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/0250.image_5F00_thumb_5F00_7290151F.png" border="0" /></a></p>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/8875.image_498806D4.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/8875.image_5F00_498806D4.png"><img width="557" height="460" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/0841.image_thumb_52779913.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/0841.image_5F00_thumb_5F00_52779913.png" border="0" /></a></p>
</blockquote>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/3073.image_3F566C67.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/3073.image_5F00_3F566C67.png"><img width="349" height="158" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/5226.image_thumb_2177E866.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/5226.image_5F00_thumb_5F00_2177E866.png" border="0" /></a></p>
</blockquote>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/5127.image_43CF7DDF.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/5127.image_5F00_43CF7DDF.png"><img width="408" height="259" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/4150.image_thumb_5F07D6E0.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/4150.image_5F00_thumb_5F00_5F07D6E0.png" border="0" /></a></p>
</blockquote>
<p>You can also install and compile the MOF manually, use psexec.exe, make it part of your standard OS image, deploy it using a software distribution system, or whatever. The example above is just that &#8211; an example.</p>
<p>Now that all your computers know about your new WMI class, you can create a group policy WMI filter that uses it. Here are a couple examples; note that I remembered to change the namespace from CIMv2 to DEFAULT!</p>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/7271.image_282D829A.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/7271.image_5F00_282D829A.png"><img width="429" height="113" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/1423.image_thumb_20A2132D.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/1423.image_5F00_thumb_5F00_20A2132D.png" border="0" /></a></p>
</blockquote>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/2313.image_5BF578EB.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/2313.image_5F00_5BF578EB.png"><img width="473" height="335" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/8345.image_thumb_79D68D9D.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/8345.image_5F00_thumb_5F00_79D68D9D.png" border="0" /></a></p>
</blockquote>
<blockquote>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/5611.image_0DEFAA27.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/5611.image_5F00_0DEFAA27.png"><img width="475" height="338" title="image" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/58/02/metablogapi/8838.image_thumb_36FA4923.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-58-02-metablogapi/8838.image_5F00_thumb_5F00_36FA4923.png" border="0" /></a></p>
</blockquote>
<p>You&#8217;re in business with a system that, while not optimal, is certainly is far better than Win32_Product. It&rsquo;s fast and lightweight, relatively easy to manage, and like all adequate solutions, designed not to make things worse in its efforts to make things different.</p>
<h1>And another idea (updated 4/23)</h1>
<p>AskDS contributor <a href="http://blogs.technet.com/b/askds/archive/tags/fabian+muller/">Fabian M&uuml;ller</a>&nbsp;had another idea that he uses with customers:</p>
<p>1.&nbsp;Define environment variables using GPP based on Registry Item-Level targeting filters or just deploy the variables during software installation phase, e.g. <b><i>%IEversion%= 9</i></b></p>
<p>2.&nbsp;Use this environment variable in WMI filters like this: <b><i>Root\CIMV2;SELECT VARIABLEVALUE FROM Win32_Environment WHERE NAME=&#8217;IEversion&#8217; AND VARIABLEVALUE=&#8217;9&#8242;</i></b></p>
<p>Disadvantage: First computer start or user logon will not pass the WMI filter since the ENV variable had to be created (if set by GPP). It would be better having this environment variable being created during softwareinstallation / deployment (or whatever software being deployed).</p>
<p>Advantage: The environment WMI&nbsp;query&nbsp;is very fast compared. And you can use it &ldquo;multi-purpose&rdquo;. For example,&nbsp;as part of CMD-based startup and logon scripts.</p>
<h1>An aside</h1>
<p>Software Installation policy is not designed to be an enterprise software management solution and neither are individual application self-update systems. SI works fine in a small business network as a &#8220;no frills&#8221; solution but doesn&rsquo;t offer real monitoring or remediation, and requires too much of the administrator to manage. If you are using these because of the old &#8220;we only fix IT when it&#8217;s broken&#8221; answer, one argument you might take to management is that you <i>are </i>broken and operating at great risk: you have no way to deploy non-Microsoft updates in a timely and reliable fashion.</p>
<p>Even though the free Windows Update and <a href="http://technet.microsoft.com/en-us/wsus/bb332157">Windows Software Update Service</a> support Windows, Office, SQL, and Exchange patching, it&rsquo;s probably not enough; anyone with more than five minutes in the IT industry knows that <b><i>all</i></b> of your software should be receiving periodic security updates. Does anyone here still think it&#8217;s safe to run <a href="http://www.adobe.com/support/security/">Adobe</a>, <a href="http://www.oracle.com/technetwork/topics/security/alerts-086861.html">Oracle</a>, or <a href="http://secunia.com/community/advisories/vendor/">thousands of other vendor products</a> without controlled, monitored, and managed patching? If your network doesn&#8217;t have a real software patching system, it&#8217;s like a building with no sprinklers or emergency exits: nothing to worry about&hellip; <i>until there&#8217;s a fire</i>. You wouldn&rsquo;t run computers without anti-virus protection, but the number of customers I speak to that have zero security patching strategy is very worrying.</p>
<p>It&#8217;s not 1998 anymore, folks. A software and patch management system isn&rsquo;t an option anymore if you have a business with more than a hundred computers; those days are done for everyone. <a href="http://www.forbes.com/sites/andygreenberg/2012/04/09/apple-snubs-firm-who-discovered-mac-botnet-tries-to-cut-off-its-server-monitoring-infections/">Even for Apple, although they haven&#8217;t realized it yet</a>. We make <a href="http://www.microsoft.com/en-us/server-cloud/system-center/default.aspx">System Center,</a> but there are other vendors out there too, and I&rsquo;d rather you bought a competing product than have no patch management at all.</p>
<p>Until next time,</p>
<p>- Ned &#8220;pragma-tism&#8221; Pyle</p>
				<div class="back-to-top-wrap"><a href="#top-link" class="back-to-top">Back to<br>top</a></div>
	</div><!-- .entry-content -->

	
</article><!-- #post-## -->

				
			
		</main><!-- #main -->
	</div><!-- #primary -->

		<div id="secondary" class="widget-area" role="complementary">
		
		<aside id="msdn_bing_social_search-5" class="widget msdn_bing_social_search">		<div class="-widget-msdn-blogs-social-search msdn-blogs-social-search">
			<div class="field-item search">
								<form id="-widget-search-allblogs-container">
					<span class="field-item-input">
						<input id="-widget-search-textbox-allblogs" name="search-textbox-allblogs" type="search" class="search-field" maxlength="64" size="45" autocomplete="off" title="">
						<input id="-widget-search-button-allblogs" name="search-button-allblogs" type="submit" class="search-submit" title="">
					</span>
				</form>
												<form id="-widget-search-thisblog-container">
					<span class="field-item-input">
						<input id="-widget-search-textbox-thisblog" name="search-textbox-thisblog" type="search" class="search-field" maxlength="64" size="45" autocomplete="off" title="Search this blog with Bing">
						<input id="-widget-search-button-thisblog" name="search-button-thisblog" type="submit" class="search-submit" title="Search this blog with Bing">
					</span>
				</form>
							</div>
						<div class="bing-social-search-option">
				<span class="bing-social-search-thisblog">
				<input type="radio" name="SearchTypeRadio" value="thisblog" id="-widget-thisblog"><label for="-widget-thisblog" id="-widget-thisblog-text">Search this blog</label></span>
				<span class="bing-social-search-allblogs">
				<input type="radio" name="SearchTypeRadio" value="allblogs" id="-widget-allblogs" checked="checked"><label for="-widget-allblogs" id="-widget-allblogs-text">Search all blogs</label></span>
			</div>
			<script type="text/javascript">
			jQuery(document).ready(function( $ ) {
				var $elmSearchAll = $('#-widget-search-allblogs-container').hide();
				var $elmSearchThis = $('#-widget-search-thisblog-container');

				// try to get the blog id, if we fail, then we aren't on a blog and just use the regular search approach

					$('#-widget-thisblog').click(function () {
						var self = $(this);
						if (self.is(':checked')) {
							$elmSearchAll.hide();
							$elmSearchThis.show();
						}
					});

					$('#-widget-allblogs').click(function () {
						var self = $(this);
						if (self.is(':checked')) {
							$elmSearchThis.hide();
							$elmSearchAll.show();
						}
					});
			});
			</script>
			
			<script type="text/javascript">window.$ = window.jQuery;</script>
							<script src="https://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=-widget-search-textbox-allblogs&btnid=-widget-search-button-allblogs&brand=msdn&refinement=109&resref&addEnglish&watermark&focusOnInit=false&beta=0&iroot&overrideWatermark=false&rn&rq" type="text/javascript" language="javascript"></script>
										<script src="https://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=-widget-search-textbox-thisblog&btnid=-widget-search-button-thisblog&brand=msdn&refinement&resref&addEnglish&watermark&focusOnInit=false&beta=0&iroot&overrideWatermark=false&rn=Ask%2Bthe%2BDirectory%2BServices%2BTeam&rq=site%3Ahttp%3A%2F%2Fblogs.technet.com%2Fb%2Faskds" type="text/javascript" language="javascript"></script>
				
		</div>
		</aside><aside id="text-3" class="widget widget_text"><h2 class="widget-title color-highlight-bg">Top Server &amp; Tools Blogs</h2>			<div class="textwidget"><div class="widget-rss-link">
	<a href="http://sxp.microsoft.com/feeds/3.0/ServerTools/ServerToolsTopPosts" target="_blank"><img src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/2110.metroRSS.png" /></a></div>

<ul class="widget-link-list">
    <li><a href="http://weblogs.asp.net/scottgu">ScottGu's Blog</a></li>
    <li><a href="https://blogs.technet.microsoft.com/in_the_cloud/">Brad Anderson&rsquo;s "In the Cloud" Blog</a></li>
    <li><a href="http://blogs.msdn.microsoft.com/bharry/">Brian Harry's Blog</a></li>
    <li><a href="https://blogs.msdn.microsoft.com/stevengu/">Steve "Guggs" Guggenheimer's Blog</a></li>
</ul></div>
		</aside><aside id="msdn-sharing-3" class="widget msdn-sharing"><h2 class="widget-title color-highlight-bg">Share This Post</h2><div class='social-share-icons-wrap'><a onclick="window.open(this.href, 'targetWindow', 'toolbar=no, location=no, status=no, menubar=no, scrollbars=yes, resizable=yes, top=400, left=400, width=600, height=300' ); return false;" class="social-sharing social-sharing-facebook facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblogs.technet.microsoft.com%2Faskds%2F2012%2F04%2F19%2Fhow-to-not-use-win32_product-in-group-policy-filtering%2F">Share</a><a onclick="window.open(this.href, 'targetWindow', 'toolbar=no, location=no, status=no, menubar=no, scrollbars=yes, resizable=yes, top=400, left=400, width=600, height=300' ); return false;" class="social-sharing social-sharing-twitter twitter" href="https://twitter.com/intent/tweet/?text=How+to+NOT+Use+Win32_Product+in+Group+Policy+Filtering&url=https%3A%2F%2Fblogs.technet.microsoft.com%2Faskds%2F2012%2F04%2F19%2Fhow-to-not-use-win32_product-in-group-policy-filtering%2F">Share</a><a onclick="window.open(this.href, 'targetWindow', 'toolbar=no, location=no, status=no, menubar=no, scrollbars=yes, resizable=yes, top=400, left=400, width=600, height=300' ); return false;" class="social-sharing social-sharing-linkedin linkedin" href="http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblogs.technet.microsoft.com%2Faskds%2F2012%2F04%2F19%2Fhow-to-not-use-win32_product-in-group-policy-filtering%2F&title=How+to+NOT+Use+Win32_Product+in+Group+Policy+Filtering&source=https://blogs.technet.microsoft.com/askds">Share</a><a onclick="" class="social-sharing social-sharing-email email" href="mailto:?subject=How to NOT Use Win32_Product in Group Policy Filtering&body=How to NOT Use Win32_Product in Group Policy Filtering https%3A%2F%2Fblogs.technet.microsoft.com%2Faskds%2F2012%2F04%2F19%2Fhow-to-not-use-win32_product-in-group-policy-filtering%2F">Share</a><a onclick="" class="social-sharing social-sharing-rss rss" href="https://blogs.technet.microsoft.com/askds/feed/">Share</a></div></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h2 class="widget-title color-highlight-bg">Recent Posts</h2>		<ul>
					<li>
				<a href="https://blogs.technet.microsoft.com/askds/2016/04/14/are-your-dcs-too-busy-to-be-monitored-ad-data-collector-set-solutions-for-long-report-compile-times-or-report-data-deletion/">Are your DCs too busy to be monitored?: AD Data Collector Set solutions for long report compile times or report data deletion</a>
							<span class="post-date">April 14, 2016</span>
						</li>
					<li>
				<a href="https://blogs.technet.microsoft.com/askds/2016/03/09/previewing-server-2016-tp4-temporary-group-memberships/">Previewing Server 2016 TP4: Temporary Group Memberships</a>
							<span class="post-date">March 9, 2016</span>
						</li>
					<li>
				<a href="https://blogs.technet.microsoft.com/askds/2016/01/11/does-your-logon-hang-after-a-password-change-on-win-8-1-2012-r2win10/">Does your logon hang after a password change on win 8.1 /2012 R2/win10?</a>
							<span class="post-date">January 11, 2016</span>
						</li>
					<li>
				<a href="https://blogs.technet.microsoft.com/askds/2015/12/08/speaking-in-ciphers-and-other-enigmatic-tonguesupdate/">Speaking in Ciphers and other Enigmatic tongues&hellip;update!</a>
							<span class="post-date">December 8, 2015</span>
						</li>
				</ul>
		</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h2 class="widget-title color-highlight-bg">Tags</h2><div class="tagcloud"><a href='https://blogs.technet.microsoft.com/askds/tag/adfs/' class='tag-link-4' title='15 topics' style='font-size: 9pt;'>ADFS</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/ad-lds/' class='tag-link-37' title='16 topics' style='font-size: 9.2954545454545pt;'>AD LDS</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/ad-replication/' class='tag-link-35' title='28 topics' style='font-size: 11.560606060606pt;'>AD Replication</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/audit/' class='tag-link-177' title='21 topics' style='font-size: 10.378787878788pt;'>audit</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/authentication/' class='tag-link-55' title='34 topics' style='font-size: 12.348484848485pt;'>Authentication</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/authorization/' class='tag-link-57' title='30 topics' style='font-size: 11.856060606061pt;'>Authorization</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/certificates/' class='tag-link-73' title='48 topics' style='font-size: 13.825757575758pt;'>Certificates</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/dfsn/' class='tag-link-33' title='45 topics' style='font-size: 13.530303030303pt;'>DFSN</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/dfsr/' class='tag-link-9' title='128 topics' style='font-size: 17.962121212121pt;'>DFSR</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/dfsr-debug-logging/' class='tag-link-84' title='29 topics' style='font-size: 11.757575757576pt;'>DFSR Debug Logging</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/dfsr-migration-or-upgrade/' class='tag-link-92' title='16 topics' style='font-size: 9.2954545454545pt;'>DFSR Migration or Upgrade</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/dfsr-performance/' class='tag-link-81' title='27 topics' style='font-size: 11.462121212121pt;'>DFSR Performance</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/disaster-recovery/' class='tag-link-26' title='22 topics' style='font-size: 10.575757575758pt;'>Disaster Recovery</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/dns/' class='tag-link-95' title='17 topics' style='font-size: 9.5909090909091pt;'>DNS</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/frs/' class='tag-link-108' title='21 topics' style='font-size: 10.378787878788pt;'>FRS</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/group-policy/' class='tag-link-30' title='70 topics' style='font-size: 15.401515151515pt;'>group policy</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/group-policy-preferences/' class='tag-link-91' title='22 topics' style='font-size: 10.575757575758pt;'>Group Policy Preferences</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/infrastructure/' class='tag-link-69' title='74 topics' style='font-size: 15.69696969697pt;'>infrastructure</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/jonathan-stephens/' class='tag-link-42' title='26 topics' style='font-size: 11.265151515152pt;'>Jonathan Stephens</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/kb-articles/' class='tag-link-74' title='104 topics' style='font-size: 17.075757575758pt;'>KB Articles</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/kerberos/' class='tag-link-19' title='39 topics' style='font-size: 12.939393939394pt;'>Kerberos</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/ldap/' class='tag-link-20' title='19 topics' style='font-size: 9.9848484848485pt;'>LDAP</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/mail-sack/' class='tag-link-49' title='60 topics' style='font-size: 14.810606060606pt;'>Mail Sack</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/mike-stephens/' class='tag-link-43' title='44 topics' style='font-size: 13.431818181818pt;'>Mike Stephens</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/ned-pyle/' class='tag-link-10' title='328 topics' style='font-size: 22pt;'>Ned Pyle</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/network/' class='tag-link-104' title='39 topics' style='font-size: 12.939393939394pt;'>network</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/other-blogs/' class='tag-link-40' title='93 topics' style='font-size: 16.583333333333pt;'>Other Blogs</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/passwords/' class='tag-link-39' title='18 topics' style='font-size: 9.7878787878788pt;'>Passwords</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/pki/' class='tag-link-6' title='49 topics' style='font-size: 13.924242424242pt;'>PKI</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/powershell/' class='tag-link-47' title='29 topics' style='font-size: 11.757575757576pt;'>PowerShell</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/profiles/' class='tag-link-13' title='17 topics' style='font-size: 9.5909090909091pt;'>Profiles</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/rob-greene/' class='tag-link-75' title='29 topics' style='font-size: 11.757575757576pt;'>Rob Greene</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/security/' class='tag-link-7' title='58 topics' style='font-size: 14.613636363636pt;'>Security</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/silly-rabbit/' class='tag-link-32' title='88 topics' style='font-size: 16.386363636364pt;'>Silly Rabbit</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/sysvol/' class='tag-link-38' title='15 topics' style='font-size: 9pt;'>SYSVOL</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/usmt/' class='tag-link-48' title='73 topics' style='font-size: 15.598484848485pt;'>USMT</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/usmt-behaviors/' class='tag-link-53' title='26 topics' style='font-size: 11.265151515152pt;'>USMT Behaviors</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/usmt-component-manifest-reference/' class='tag-link-160' title='20 topics' style='font-size: 10.181818181818pt;'>USMT Component Manifest Reference</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/windows-7/' class='tag-link-14' title='46 topics' style='font-size: 13.628787878788pt;'>Windows 7</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/windows-8/' class='tag-link-15' title='25 topics' style='font-size: 11.068181818182pt;'>Windows 8</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/windows-server-2008/' class='tag-link-134' title='45 topics' style='font-size: 13.530303030303pt;'>Windows Server 2008</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/windows-server-2008-r2/' class='tag-link-21' title='65 topics' style='font-size: 15.106060606061pt;'>Windows Server 2008 R2</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/windows-server-2012/' class='tag-link-23' title='19 topics' style='font-size: 9.9848484848485pt;'>windows server 2012</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/windows-vista/' class='tag-link-159' title='51 topics' style='font-size: 14.121212121212pt;'>Windows Vista</a>
<a href='https://blogs.technet.microsoft.com/askds/tag/windows-xp/' class='tag-link-96' title='25 topics' style='font-size: 11.068181818182pt;'>Windows XP</a></div>
</aside><aside id="msdn-archive-widget-3" class="widget msdn-archive-widget"><h2 class="widget-title color-highlight-bg">Archives</h2>	<li><a href='https://blogs.technet.microsoft.com/askds/2016/04/'>April 2016</a>&nbsp;(1)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2016/03/'>March 2016</a>&nbsp;(1)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2016/01/'>January 2016</a>&nbsp;(1)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2015/12/'>December 2015</a>&nbsp;(1)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2015/11/'>November 2015</a>&nbsp;(1)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2016/'>All of 2016</a>&nbsp;(3)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2015/'>All of 2015</a>&nbsp;(10)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2014/'>All of 2014</a>&nbsp;(9)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2013/'>All of 2013</a>&nbsp;(18)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2012/'>All of 2012</a>&nbsp;(62)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2011/'>All of 2011</a>&nbsp;(132)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2010/'>All of 2010</a>&nbsp;(150)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2009/'>All of 2009</a>&nbsp;(215)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2008/'>All of 2008</a>&nbsp;(122)</li>
	<li><a href='https://blogs.technet.microsoft.com/askds/2007/'>All of 2007</a>&nbsp;(19)</li>
</aside>
	</div><!-- #secondary -->

	<div id="tag-wrap"><h2 class="color-highlight-bg">Tags</h2><ul class="tag-list"><li><a href="https://blogs.technet.microsoft.com/askds/tag/group-policy/">group policy</a></li><li><a href="https://blogs.technet.microsoft.com/askds/tag/ned-pyle/">Ned Pyle</a></li><li><a href="https://blogs.technet.microsoft.com/askds/tag/wmi/">WMI</a></li></ul></div>
	
<div id="comments" class="comments-area">

		<div class="comments-head">
			</div>
			
		
			
			<ol class="comment-list">
				
			<li id="comment-1446" class="comment byuser comment-author-sgrinker even thread-even depth-1">
			<article id="div-comment-1446" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T21:10:18+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/801d732d364885bdad54c72f33d7bc1c?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">sgrinker</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Don&#39;t know about everyone else, but the links in the first paragraph seem to be a bit off&#8230; </p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1762" class="comment byuser comment-author-nedpyle-msft bypostauthor odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-1762" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T21:13:31+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Crikey, yeah they are fubar. Me fix now.</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-509" class="comment byuser comment-author-nedpyle-msft bypostauthor even thread-even depth-1">
			<article id="div-comment-509" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T21:31:35+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>That was the nuttiest Word doc freak out I have ever seen. It&#39;s like it shifted all my hyperlinks down by one from the original correct ones; I had to fix every one. </p>
<p>Thanks Steve!</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-2557" class="comment byuser comment-author-sgrinker odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-2557" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T21:38:44+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/801d732d364885bdad54c72f33d7bc1c?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">sgrinker</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Looks good now&#8230; &nbsp;I thought I was going nutty (or more so), or just needed some more caffeine! &nbsp;<img src="https://blogs.technet.microsoft.com/askds/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /></p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-2559" class="comment byuser comment-author-sgrinker even thread-even depth-1">
			<article id="div-comment-2559" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T21:40:31+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/801d732d364885bdad54c72f33d7bc1c?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">sgrinker</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>DOH! &nbsp;I take that back, looks like you have more gremlins at the end of the article. &nbsp;Time to submit a bug report to the Office Team! &nbsp; <img src="https://blogs.technet.microsoft.com/askds/wp-includes/images/smilies/icon_biggrin.gif" alt=":D" class="wp-smiley" /></p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-3109" class="comment byuser comment-author-sgrinker odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-3109" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T21:42:14+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/801d732d364885bdad54c72f33d7bc1c?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">sgrinker</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You can delete that last post&#8230; &nbsp;I missread a link</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1194" class="comment byuser comment-author-nedpyle-msft bypostauthor even thread-even depth-1">
			<article id="div-comment-1194" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T21:53:24+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I will leave it there as a warning to the others!!!</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-2390" class="comment byuser comment-author-jeffrey-s-patton odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-2390" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T22:48:07+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/b5a1e52eb89a1834d00f5e8cd88cce06?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">Jeffrey S. Patton</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This is a great article! Thank you for writing it! I&#39;ve not had to do anything as wonky as what you&#39;re describing thankfully, where I enjoyed it was the custom MOF. I&#39;ve never seen that before and now must do some reading. But your example solves an issue that I&#39;ve had for quite a while now. How to quickly return a list of 32 and 64bit software from a computer, without Win32_Product, because it&#39;s horrible. In my environment where there are over 200 applications installed on over 250 computers, doing a quick inventory on a given system is the exact opposite, and that&#39;s assuming it ever completes!</p>
<p>Thanks again!</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-468" class="comment byuser comment-author-nedpyle-msft bypostauthor even thread-even depth-1">
			<article id="div-comment-468" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-19T22:53:23+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>My pleasure, Jeffrey.</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1962" class="comment byuser comment-author-aem odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-1962" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T05:43:53+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/2ef9047b0cd3dbacfe7e61cd05c1d8f3?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">AEM</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Nice! Always informative. MOF ant that easy and I shy away from it all the time because there always seems to be an easier answer unless you are just looking for some nice reporting.</p>
<p>Happy to see da post starting to roll in, keep it up.</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-2300" class="comment byuser comment-author-samuel_b even thread-even depth-1">
			<article id="div-comment-2300" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T11:34:41+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/422fafc3b98f513c8c86b38b9a1d4e93?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">samuel_b</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>A very useful article but &quot;Win32reg_AddRemovePrograms&#8230;a legacy class&#8230;the System Center folks discarded it years ago&quot;. Is that strictly true? That class is still present in both 2007 and 2012 System Center Configuration Manager clients and is still collected as part of inventory. Your SampleProductsList class definition looks very similar to the Win32reg_AddRemovePrograms in Configuration.mof in the 2007 product. However, yes using that class alone does have its drawbacks when querying 32-bit software on 64-bit systems.</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1192" class="comment byuser comment-author-nedpyle-msft bypostauthor odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-1192" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T14:31:56+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Including it for backwards compatibility doesn&#39;t mean they are using it. They wrote a native non-WMI inventory system years ago. And, yes, it looks similar on purpose &#8211; there&#39;s no other way it could look. <img src="https://blogs.technet.microsoft.com/askds/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /></p>
<p>I edited the main post slightly to make all this more clear, thanks for the feedback.</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-512" class="comment byuser comment-author-nedpyle-msft bypostauthor even thread-even depth-1">
			<article id="div-comment-512" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T14:39:24+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks coderaven. <img src="https://blogs.technet.microsoft.com/askds/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /></p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-3007" class="comment byuser comment-author-steveebgmail-com odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-3007" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T15:22:16+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/1b6eb5875f05bbb1afc7ffd90e07e541?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">steveeb@gmail.com</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for getting the word out about Win32_Product. I&#8217;ve seen too many people use it without being aware of the consequences.</p>
<p>In scripting, I use the WindowsInstaller.Installer object instead of Win32_Product. Its &quot;Products&quot; property returns all of the installed product IDs, which can be used to retrieve various properties for each product using the &quot;ProductInfo&quot; property. Want<br />
 to know if Office 2010 Pro Plus is installed using VBScript?</p>
<p>Set objInstaller = CreateObject(&quot;WindowsInstaller.Installer&quot;)</p>
<p>Set colProducts = objInstaller.Products</p>
<p>For Each strProduct In colProducts</p>
<p>If objInstaller.ProductInfo(strProduct, &quot;ProductName&quot;) = &quot;Microsoft Office Professional Plus 2010&quot; Then WScript.Echo &quot;You got it!&quot;</p>
<p>Next</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa369767%28v=vs.85%29.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/aa369767%28v=vs.85%29.aspx</a></p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1829" class="comment byuser comment-author-brian_yilihotmail-com even thread-even depth-1">
			<article id="div-comment-1829" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T15:28:28+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/4bdd93eaa8f77821b3873157c47201ba?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">BrianYx2</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for the confirmation of what we had seen in our environment caused, not by GPO, but by an in-house application. &nbsp;There is also another good write-up about Win32_Product at <a rel="nofollow" target="_new" href="http://gregramsey.wordpress.com/2012/02/20/win32_product-is-evil/" rel="nofollow">gregramsey.wordpress.com/&#8230;/win32_product-is-evil</a></p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1432" class="comment byuser comment-author-nedpyle-msft bypostauthor odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-1432" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T15:35:32+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Nice one Wrex &#8211; many ways to skin that cat, that&#39;s a slick alternative. </p>
<p>I admit that Greg&#39;s article title is more accurate than mine, Brianyx2. <img src="https://blogs.technet.microsoft.com/askds/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley" /> Unfortunately, Win32_Product can never go away, as you can&#39;t just remove WMI classes willy-nilly (see previous point about win32reg_ above). We can only hope that it isn&#39;t used unnecessarily, or perhaps, someday optimized. </p>
<p>Windows 12, at this rate?</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1780" class="comment byuser comment-author-sgrinker even thread-even depth-1">
			<article id="div-comment-1780" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T16:48:30+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/801d732d364885bdad54c72f33d7bc1c?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">sgrinker</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@Wrex&#8230; &nbsp;nice avatar picture! &nbsp;<img src="https://blogs.technet.microsoft.com/askds/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /></p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-2173" class="comment byuser comment-author-ryan-ries odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-2173" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-04-20T18:15:43+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/a22fcedb22ce3a63a8def75d9da56f96?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">Ryan Ries [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yeah, some of those WMI classes can be painfully slow, especially if you&#39;re trying to churn through a bunch of remote computers in a script or something. &nbsp;The only thing worse is parsing the Security event log&#8230; that thing is a maelstrom of chaos on a busy DC&#8230;</p>
<p>Also, call me foolish but DAMN I did not realize the possibilities of creating one&#39;s own WMI classes! That is awesome info. I&#39;m going to be looking desperately for excuses to use that soon. <img src="https://blogs.technet.microsoft.com/askds/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /></p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-2467" class="comment byuser comment-author-boywaja even thread-even depth-1">
			<article id="div-comment-2467" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-05-14T16:03:50+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/7879f0da785733ea57e69335d78f80b3?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">boywaja</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>&quot; If you are trying to set some computer-based settings that a user cannot change and don’t mind preferences instead of managed policy settings, GPP is the way to go.&quot;</p>
<p>I&#39;m thinking that is a typo. &nbsp;While I&#39;ve never used GP Preferences before the user CAN change those settings.</p>
<p>thanks for an awesome article. &nbsp; We&#39;ve been trying to figure out the &quot;reconfigured every installed msi app&quot; problem for a while. &nbsp; </p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-1193" class="comment byuser comment-author-nedpyle-msft bypostauthor odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-1193" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2012-05-14T16:52:17+00:00">
							4 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/ee0e9315d60f867a40b644af38b4d3d5?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">NedPyle [MSFT]</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>This goes off the assumption that you did not make your users administrators. Non-admins cannot change most overall machine settings. </p>
<p>If they are admins, nothing can stop them from changing anything; not even real managed group policy.</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-4071" class="comment byuser comment-author-anonymouscommenter even thread-even depth-1">
			<article id="div-comment-4071" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2013-12-15T19:27:47+00:00">
							2 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">Anonymous</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Les filtres WMI sont très utilisés afin d&#39;évaluer si un objet stratégie de groupe (GPO) s&#39;applique</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->

			<li id="comment-4061" class="comment byuser comment-author-anonymouscommenter odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-4061" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-right">
						<time class="comment-time" datetime="2014-05-12T06:05:18+00:00">
							2 years ago						</time>
						<div class="comment-actions">
													</div>
					</div>
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=40&amp;d=https%3A%2F%2Fsecure.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />						<div class="author-wrap">
							<span class="author-name">Anonymous</span>						</div>
					</div><!-- .comment-author -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi Folks, Dan Cuomo, Microsoft Platforms PFE, here to discuss one of the mitigation options available</p>
				</div><!-- .comment-content -->

				<div class="comment-metadata">
									</div><!-- .comment-metadata -->

			</article><!-- .comment-body -->

		</li><!-- #comment-## -->
			</ol><!-- .comment-list -->

			
		
				<p class="no-comments">Comments are closed.</p>
	
</div><!-- #comments -->


	


	</div><!-- #content -->

	<div class="footer-wrap">
		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info">

				<div class="footer-copyright">
					<p>&copy; 2016 Microsoft Corporation.</p>
				</div>

				<div class="bottom-footer-menu">
					<div class="menu-footer-menu-container"><ul id="menu-footer-menu" class="footer-menu"><li id="menu-item-15303" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15303"><a href="http://technet.microsoft.com/en-US/cc300389.aspx">Terms of Use</a></li>
<li id="menu-item-15313" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15313"><a href="http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</a></li>
<li id="menu-item-15323" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15323"><a href="http://go.microsoft.com/fwlink/?LinkId=248681">Privacy &amp; Cookies</a></li>
</ul></div>				</div>

				<div class="footer-logo">
					<!--<div class="copyright-logo" role="img" aria-label="Microsoft logo"></div>-->
				</div><!-- .footer-logo -->

			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- .footer-wrap -->

</div><!-- #page -->


	<script type="text/javascript">
	jQuery(document).ready(function($){
		$login_link = $( 'a[href*="wp-login.php?"]' );
				$login_link.on( 'click', function( evt ) {
			// evt.preventDefault();
						// console.log( 'cookie-set', '/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/' );
			$.cookie( 'aadsso-redirect', '/askds/2012/04/19/how-to-not-use-win32_product-in-group-policy-filtering/', { expires: 1, path: '/' });
		});
	});
	</script>
		<!--ADD WEDCS SCRIPT-->
	<div id="_WEDCSInsertedData" style="display: none;"></div>
	<script type="text/javascript">
		jQuery( window ).load(
			function() {
				window.varSegmentation = 0;
				window.varClickTracking = 1;
				window.varCustomerTracking = 1;
				window.varAutoFirePV = 1;
				window.Route = ""; // was 23470 in the windows theme framework
				window.Ctrl = "";
				var wedcs_script = document.createElement('script');
				wedcs_script.type = 'text/javascript';
				wedcs_script.async = true;
				wedcs_script.src = window.location.protocol + '//blogs.msdn.com/Themes/Shared/js/ms2_blogs.js';
				document.getElementsByTagName('body')[0].appendChild(wedcs_script);
			});
	</script>
	<!--
	<script src="//c.microsoft.com/ms.js" type="text/javascript"></script>
	<noscript><img alt="" width="1" height="1" src="http://c.microsoft.com/trans_pixel.aspx"/></noscript>
	-->

		<span id='page-view-tracking-info' blog-id='2188' post-id='427'></span>
		<script type="text/javascript">
			// Check for compatibility before IE8
			if (!Date.now) {
 				 Date.now = function() { return new Date().getTime(); };
			}
			jQuery( window ).load( function() {
				jQuery.ajax({
					url: 'https://blogs.technet.microsoft.com/askds/wp-admin/admin-ajax.php',
					type: 'get',
					data: {
						action: 'track_page_view',
						track_page_view_post_id: jQuery('#page-view-tracking-info').attr('post-id'),
						track_page_view_blog_id: jQuery('#page-view-tracking-info').attr('blog-id'),
						track_page_view_post_url: window.location.href.split('?')[0],
						timestamp: Date.now()
						}
				});
			});
		</script>	<script type="text/javascript">
		var addthis_config =
		    {
				data_track_addressbar: false,
	        	ui_use_css: false,
	        	ui_508_compliant: true
	    	}
	</script>
	<script type="text/javascript">
		jQuery( window ).load(
			function(i) {
				var n = window,
					t = document,
					e = n.console,
					f, u, r, o;
				typeof e == "undefined" && (f = function() {}, e = {
					log: f,
					warn: f,
					assert: f,
					clear: f,
					dir: f,
					error: f,
					info: f,
					profile: f,
					profileEnd: f
				}), u = {
					appendToHead: function(n) {
						if (t.getElementsByTagName("head").length > 0) t.getElementsByTagName("head")[0].appendChild(n);
						else throw "bootstrapper: no head element found.";
					},
					appendToBody: function(n) {
						if (t.getElementsByTagName("body").length > 0) t.getElementsByTagName("body")[0].appendChild(n);
						else throw "bootstrapper: no body element found.";
					},
					addStyleElement: function(n) {
						var i = t.createElement("link");
						i.setAttribute("href", n), i.setAttribute("rel", "stylesheet"), i.setAttribute("type", "text/css"), u.appendToHead(i)
					},
					loadFiles: function(n, t) {
						if (t !== i && u.recursiveScriptLoad(0, t), n !== i)
							for (var r = 0, r = 0; r < n.length; r++) u.addStyleElement(n[r])
					},
					recursiveScriptLoad: function(n, t) {
						t[n] && u.addScriptElement(t[n], function() {
							u.recursiveScriptLoad(n + 1, t)
						})
					},
					isCompatible: function(n, t) {
						var r, u, i;
						return (r = n.split("."), u = t.split("."), i = function(n) {
							return isNaN(n) ? 0 : n
						}, i(r[0]) > i(u[0]) || i(r[0]) === i(u[0]) && i(r[1]) > i(u[1]) || i(r[0]) === i(u[0]) && i(r[1]) === i(u[1]) && i(r[2]) >= i(u[2])) ? !0 : !1
					},
					addScriptElement: function(i, r) {
						var f, e;
						f = t.createElement("script"), f.setAttribute("type", "text/javascript"), f.async = true, f.setAttribute("src", i), f.attachEvent ? (e = function() {
							setTimeout(function() {
								typeof n.jQuery != "undefined" && r ? r() : e()
							}, 10)
						}, e()) : f.onload = r, u.appendToBody(f)
					},
					load: function(n, t) {
						setTimeout(function() {
							if (typeof n == "undefined") try {
								u.addScriptElement(t.defaultPath, function() {
									u.loadFiles(t.cssFiles, t.jsFiles)
								});
								return
							} catch (i) {
								e.warn("bootstrapper: failed to load default jQuery")
							} else if (!u.isCompatible(n.fn.jquery, t.minimumVersion)) {
								e.warn("bootstrapper: jQuery version is too old to load UserCard. Use v1.4.2 or later.");
								return
							}
							u.loadFiles(t.cssFiles, t.jsFiles)
						}, 0)
					}
				}, r = {
					host: n.location.host,
					search: "",
					protocol: "https"
				}, r.host = "widgets.services.microsoft.com", r.search = "?brand=msdn&lang=en&ver=4.9.0.0", r.protocol = "https:", o = {
					minimumVersion: "1.1.2",
					defaultPath: "https://code.jquery.com/jquery-1.4.2.min.js",
					cssFiles: [r.protocol + "//" + r.host + "/v1/UnifiedBaseballCard.css" + r.search, r.protocol + "//" + r.host + "/v1/usercard.css" + r.search],
					jsFiles: ["https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js", r.protocol + "//" + r.host + "/v1/jquery.timeago.js" + r.search, r.protocol + "//" + r.host + "/v1/jquery.textfill.js" + r.search, r.protocol + "//" + r.host + "/v1/widgets.js" + r.search]
				}, typeof n.jQuery == "undefined" ? u.load(i, o) : u.load(n.jQuery, o)
			}
		);
	</script>
<script type='text/javascript'>
/* <![CDATA[ */
var wds_ratings_config = {"ajaxurl":"https:\/\/blogs.technet.microsoft.com\/askds\/wp-admin\/admin-ajax.php","user_id":"0","nonce":"016a4567a4","debug":"","no_auth_alert":"You must be logged in to rate an article."};
var wds_ratings_config = {"ajaxurl":"https:\/\/blogs.technet.microsoft.com\/askds\/wp-admin\/admin-ajax.php","user_id":"0","nonce":"016a4567a4","debug":"","no_auth_alert":"You must be logged in to rate an article."};
var wds_ratings_config = {"ajaxurl":"https:\/\/blogs.technet.microsoft.com\/askds\/wp-admin\/admin-ajax.php","user_id":"0","nonce":"016a4567a4","debug":"","no_auth_alert":"You must be logged in to rate an article."};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-content/plugins/wds-ratings/wds-ratings.js?ver=05272015'></script>
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-content/themes/msdn-network-parent/js/onclick-menu-cloud.min.js?ver=05262014'></script>
<script type='text/javascript' src='//s7.addthis.com/js/300/addthis_widget.js?ver=1#pubid=ra-52a23616101dab3e'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var msdnparent = {"is_search":"","is_singular":"1"};
var msdnparent = {"is_search":"","is_singular":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-content/themes/msdn-network-parent/js/project.min.js?ver=06182015'></script>
<script type='text/javascript' src='https://blogs.technet.microsoft.com/askds/wp-content/themes/msdn-network-parent/js/vendor/jquery.cookie.js?ver=06182015'></script>


</body>
</html>
