
<!doctype html><head>
    <title>Feeding DShield with OSSEC Logs - SANS Internet Storm Center </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-control" content="no-cache" />
    <meta property="og:site_name" content="SANS Internet Storm Center" />
    <meta property="og:locale" content="en_US" />
    <meta name="DESCRIPTION" content="SANS Internet Storm Center - A global cooperative cyber threat / internet security monitor and alert system. Featuring daily handler diaries with summarizing and analyzing new threats to networks and internet security events."/>
    <meta name="AUTHOR" content="SANS Internet Storm Center"/>
    <meta name="KEYWORDS" content="isc, sans, internet, security, threat, worm, virus, phishing, hacking, vulnerability"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/iscfavicon.ico" />
    <link rel="canonical" href="https://isc.sans.edu%2Fforums%2Findex.html" />
    <link type="text/css" rel="stylesheet" href="/css/screen.css" /><!-- this is not the comment you are looking for e215c22088b6f36de58 -->
</head><body class="isc">
<div id="container">
  <div id="topWrapper">
    <div class="g">
      <span class="threatLevel">
        Threat Level: <a href="/infocon.html">green</a>
      </span>
      <span class="currentHandler">
        Handler on Duty: <a title="Brad Duncan" href="/handler_list.html#brad-duncan">Brad Duncan</a>
      </span>
    </div>

  </div>
	<h1>
    <a href="/">SANS ISC: Feeding DShield with OSSEC Logs - SANS Internet Storm Center  <span></span></a>
    <ul class="site-selector">
      <li class="site-switcher"><a href="#"><span class="hidden">SANS Site Network</span></a>
        <ul class="sites">
          <li class="current-site">Current Site</li>
          <li class="isc"><a href="https://isc.sans.edu">
            <span></span>
            Internet Storm Center
          </a></li>
          <li class="selector-help">Other SANS Sites
            <a href="https://www.sans.org/help/site-network"><span class="hidden">Help</span></a>
          </li>
          <li class="sti"><a href="http://www.sans.edu">
            <span></span>
            Graduate Degree Programs
          </a></li>
          <li class="sans"><a href="http://www.sans.org">
            <span></span>
            Security Training
          </a></li>
          <li class="giac"><a href="http://www.giac.org">
            <span></span>
            Security Certification
          </a></li>
          <li class="awareness"><a href="http://www.securingthehuman.org">
            <span></span>
            Security Awareness Training
          </a></li>
          <li class="pentest"><a href="http://pen-testing.sans.org">
            <span></span>
            Penetration Testing
          </a></li>
          <li class="ics"><a href="http://ics.sans.org">
            <span></span>
            Industrial Control Systems
          </a></li>
          <li class="cyber-defense"><a href="http://cyber-defense.sans.org">
            <span></span>
            Cyber Defense Foundations
          </a></li>
          <li class="forensics"><a href="http://computer-forensics.sans.org">
            <span></span>
            Computer Forensics
          </a></li>
          <li class="ssi"><a href="http://software-security.sans.org">
            <span></span>
            Software Security
          </a></li>
          <li class="sic"><a href="http://sic.sans.org">
            <span></span>
            Government OnSite Training
          </a></li>
        </ul>
      </li>
    </ul>
    SANS ISC InfoSec Forums
	</h1>
	<form id="headerSearch" name="searchform" action="/search.html" method="post">
        <input type="text" name="q" placeholder="Keyword, Domain, Port, IP or Header" />
        <input type="submit" value="Search" />
	</form>
    <form id="headerLogin" method="post" action="/login.html" name="loginform">
        <input type="hidden" name="token" value="dea921df6a0f3cae1c57c0c1de8735651e8acf85" />
        <input type="text" name="email" placeholder="Email" />
        <input type="password" name="pw" autocomplete="off" placeholder="Password" />
        <input type="submit" value="Log In" /><br />
        <a href="/register.html">Sign Up for Free!</a> &nbsp; <a href="/resetpassword.html">Forgot Password?</a>
	</form>
	<div id="smallHeaderLogin">
	    <a href="/login.html">Log In</a> or <a href="/register.html">Sign Up for Free</a>!
	</div>
	<div id="content">
		<div class="wrapper">
                                <div class="beforeForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/September+2015+Microsoft+Patch+Tuesday/20129/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/Adobe+Updates+Shockwave+Player/20133/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div>
                                <table class="postList">
                                <caption>Feeding DShield with OSSEC Logs</caption>
                                        <tr class="postWrapper">
                                            <td class="content">
                                                <div class="ss-container">
                                                    <ul class="ss-share">
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-facebook" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20141" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-twitter" title="Share on Twitter" href="http://twitter.com/share?text=Feeding%20DShield%20with%20OSSEC%20Logs&amp;url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20141&amp;via=SANS_ISC" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-google" title="Share on Google+" href="http://plus.google.com/share?url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20141" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div><p style="margin: 0px 0px 21px; padding: 0px; border: 0px; font-stretch: inherit; font-size: 14px; line-height: 21px; font-family: HelveticaNeue, 'Helvetica Neue', Helvetica, Arial, sans-serif; vertical-align: baseline; color: rgb(68, 68, 68); text-align: justify;">Today, I&#39;d like to promote&nbsp;a tool that I wrote four years ago and that&nbsp;is running every 30 minutes on my OSSEC server. DShield offers many&nbsp;<a href="https://www.dshield.org/howto.html">clients</a> to collect and process logs from multiple firewall brands/vendors. But today, more and more logs are already centralized to a SIEM. Collecting the events twice can be a pain for performance, complexity and&nbsp;security reasons. I&#39;m collecting firewall logs from many devices with <a href="http://www.ossec.net">OSSEC</a>&nbsp;so there are stored in a central place. The idea of ossec2dshield is to read the logs from OSSEC and forward them to DShield. Writing a DShield agent is easy, everything is described <a href="http://www.dshield.org/specs.html">here</a>. Basically, the script parses the OSSEC&#39;s firewall.log and generates&nbsp;the corresponding&nbsp;DShield events.&nbsp;</p>

<p style="margin: 0px 0px 21px; padding: 0px; border: 0px; font-stretch: inherit; font-size: 14px; line-height: 21px; font-family: HelveticaNeue, 'Helvetica Neue', Helvetica, Arial, sans-serif; vertical-align: baseline; color: rgb(68, 68, 68); text-align: justify;">The script syntax is self-explanatory:</p>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
$ ossec2dshield.pl --log=file --userid=dshieldid --statefile=file --from=email --mta=hostname&#10;                  [--help] [--debug] [--test] [--obfuscate] [--ports=port1,port2,...]  &#10;Where: &#10;--help                   : This help&#10;--debug                  : Display processing details to stdout&#10;--test                   : Test only, do not mail the info to dshield.org&#10;--obfuscate              : Obfuscate the destination address (10.x.x.x)&#10;--ports=port1,!port2,... : Filter destination ports ex: !25,!80,445,53 &#10;--log=file               : Your OSSEC firewall.log&#10;--userid=dshieldid       : Your dshield.org UserID (see http://www.dshield.org)&#10;--statefile=file         : File to write the state of log processing&#10;--from=email             : Your e-mail address (From:)&#10;--mta=hostname           : Your Mail Transfer Agent (to send mail to dshield.org)</pre>

<p style="margin: 0px 0px 21px; padding: 0px; border: 0px; font-stretch: inherit; font-size: 14px; line-height: 21px; font-family: HelveticaNeue, 'Helvetica Neue', Helvetica, Arial, sans-serif; vertical-align: baseline; color: rgb(68, 68, 68); text-align: justify;">You will need your dshield.org UserID, a mail relay (MTA). The state file is very important: it contains&nbsp;the timestamp of the last processed event. This prevents events to be sent twice to dshield.org. Once processed, the data will be submitted to register(at)dshield(dot)org. Using &ldquo;<em style="margin: 0px; padding: 0px; border: 0px; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; vertical-align: baseline;">&ndash;-port</em>&ldquo;, you can exclude or restrict to some interesting ports. Example: &ldquo;<em style="margin: 0px; padding: 0px; border: 0px; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; vertical-align: baseline;">&ndash;-port=&rsquo;!80,!22,!443&prime;</em>&rdquo; will report all blocked firewall traffic except for the destination ports 80, 22 and 443.&nbsp;The current version of the&nbsp;script is not so powerful as the regular Dshield clients but it works very well. Ideas and suggestions are always welcome.&nbsp;The script is available in my&nbsp;<a href="https://github.com/xme/ossec2dshield" style="margin: 0px; padding: 0px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; vertical-align: baseline; color: rgb(184, 16, 5); text-decoration: none;" title="Link to the website">github.com</a>&nbsp;repository. Happy logging!</p>

<p>Xavier Mertens<br />
ISC Handler - Freelance Security Consultant<br />
<a href="https://rootshell.be">rootshell.be</a><br />
<a href="https://truesec.be">truesec.be</a></p>
</div>
                                            </td><td class="user">
                                            Xme<br />
                                                <img src="/gravatar_cache/cache/isc/a7cc8e162752a120d82325fbbf3b5e79" /><br />
                                                <span>144 Posts</span><br /><span>ISC Handler</span></td>
                                        </tr>
                                        <tr class="postFooter">
                                            <td class="actions">
                                                <a href="/forums/diary/reply/20141/">Reply</a>
                                        <a href="/forums/diary/subscribe/20141/">Subscribe</a>
                                            </td>
                                            <td class="time">
                                                7 months  ago
                                            </td>
                                        </tr>
                                    <tr class="postWrapper" id="35121">
                                        <td class="content">
                                            <div>Disclaimer: This may be off-topic, since it's not directly related to your tool. However, I wanted to better understand the roles/benefits of OSSEC? Is it a SIEM, IDS, HIDS, or all rolled into one? Where is its sweet spot? We're currently don't have a SIEM or dedicated (H)IDS, although we do have IPS as a blade on our Check Point UTM. Could we utilize OSSEC as a SIEM &amp; IDS solution, as well as for file integrity, Windows registry monitoring &amp; even IR?</div>
                                        </td>
                                        <td class="user">
                                            AAInfoSec<br />
                                            <img src="/gravatar_cache/cache/isc/505c00b933a419c8d0f1d01faddbf375" /><br />
                                            <span>37 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20141/">Reply</a>
                                            <a href="/forums/diary/quote/35121">Quote</a>
                                        </td>
                                        <td class="time">
                                            7 months  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="35123">
                                        <td class="content">
                                            <div>OSSEC presents itself as a Host based IDS. But IMHO, it goes much deeper! The core features are:<br />
- Centralization of log files<br />
- Creation of security rules that triggers notifications or actions<br />
- FIM<br />
- Rootkit detection<br />
- Active-Response (ex: temporary block an attacker's IP address)<br />
<br />
About your question: Yes, Windows is supported (only agents - the servers MUST run on UNIX). Ping me off-list if you want to discuss about OSSEC!</div>
                                        </td>
                                        <td class="user">
                                            Xme<br />
                                            <img src="/gravatar_cache/cache/isc/a7cc8e162752a120d82325fbbf3b5e79" /><br />
                                            <span>144 Posts</span><br /><span>ISC Handler</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20141/">Reply</a>
                                            <a href="/forums/diary/quote/35123">Quote</a>
                                        </td>
                                        <td class="time">
                                            7 months  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="35125">
                                        <td class="content">
                                            <div>@AAInfoSec, OSSEC is more a HIDS. You can check out OSSIM which is an open source SIEM from AlienVault that uses OSSEC. They also have a commercial offering USM. <br />
<br />
@Xme, apologies for hijacking your thread.</div>
                                        </td>
                                        <td class="user">
                                            Mike7<br />
                                            <img src="/gravatar_cache/cache/isc/7b81079779751336502ab88bea7a7487" /><br />
                                            <span>36 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20141/">Reply</a>
                                            <a href="/forums/diary/quote/35125">Quote</a>
                                        </td>
                                        <td class="time">
                                            7 months  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="35127">
                                        <td class="content">
                                            <div>@Mike7, no worries! The goal of this forum is to share useful information.</div>
                                        </td>
                                        <td class="user">
                                            Xme<br />
                                            <img src="/gravatar_cache/cache/isc/a7cc8e162752a120d82325fbbf3b5e79" /><br />
                                            <span>144 Posts</span><br /><span>ISC Handler</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20141/">Reply</a>
                                            <a href="/forums/diary/quote/35127">Quote</a>
                                        </td>
                                        <td class="time">
                                            7 months  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="35133">
                                        <td class="content">
                                            <div>Not very relevant, but:<br />
<br />
[--obfusctate]<br />
<br />
seems to be misspelled. Might confuse someone who is using this tool, especially people who (like me) like to copy/paste in order to avoid typos...</div>
                                        </td>
                                        <td class="user">
                                            Nikolay Dachev<br />
                                            <img src="/gravatar_cache/cache/isc/b26f57b9bd0eb23d5b7ee1c8a1d6c4da" /><br />
                                            <span>1 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20141/">Reply</a>
                                            <a href="/forums/diary/quote/35133">Quote</a>
                                        </td>
                                        <td class="time">
                                            7 months  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="35135">
                                        <td class="content">
                                            <div>Thanks for reporting the typo. I fixed it.</div>
                                        </td>
                                        <td class="user">
                                            Xme<br />
                                            <img src="/gravatar_cache/cache/isc/a7cc8e162752a120d82325fbbf3b5e79" /><br />
                                            <span>144 Posts</span><br /><span>ISC Handler</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20141/">Reply</a>
                                            <a href="/forums/diary/quote/35135">Quote</a>
                                        </td>
                                        <td class="time">
                                            7 months  ago
                                        </td>
                                    </tr>
                                </table>
                                <div class="afterForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/September+2015+Microsoft+Patch+Tuesday/20129/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/Adobe+Updates+Shockwave+Player/20133/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div><p><a href="/register.html">Sign Up for Free</a> or <a href="/login.html">Log In</a> to start participating in the conversation!</p>
        </div>
    </div>
    <div id="navigation">
        <ul>
            <li><a href="/contact.html">Contact Us</a>
                <ul>
                    <li class="first"><a href="/about.html">About Us</a></li>
                    <li><a href="/handler_list.html">Handlers</a></li>
                    <li><a href="/events">Events</a></li>
                </ul>
            </li>
            <li><a href="/diaryarchive.html">Diary</a></li>
            <li><a href="/podcast.html">Podcasts</a></li>
            <li><a href="/jobs">Jobs</a></li>
            <li><a href="/newssummary.html">News</a></li>
            <li><a href="/tools/">Tools</a>
                <ul>
                    <li class="first"><a href="/howto.html">DShield Sensor</a></li>
                    <li><a href="/404project/">404Project</a></li>
                    <li><a href="/glossary.html">InfoSec Glossary</a></li>
                    <li><a href="/webhoneypot/index.html">Webhoneypot</a></li>
                    <li><a href="/fightback.html">Fightback</a></li>
                </ul>
            </li>
            <li><a href="/reports.html">Data</a>
                <ul>
                    <li><a href="/ssh.html">SSH Scanning Activity</a></li>
                    <li><a href="/crls.html">SSL CRL Activity</a></li>
                    <li><a href="/port.html">TCP/UDP Port Activity</a></li>
                    <li><a href="/httpheaders/">HTTP Header Activity</a></li>
                    <li><a href="/threatfeed.html">Threat Feeds Activity</a></li>
                    <li><a href="/threatmap.html">Threat Feeds Map</a></li>
                    <li><a href="/suspicious_domains.html">Suspicious Domains</a></li>
                    <li><a href="/presentations/">Presentations &amp; Papers</a></li>
                    <li><a href="/links.html">Useful InfoSec Links</a></li>
                    <li><a href="/poll.html">InfoSec Poll Results</a></li>
                </ul>
            </li>
            <li class="active"><a href="/forums/">Forums</a>
                <ul>
                    <li><a href="/forums/Auditing/">Auditing</a></li>
                    <li><a href="/forums/Diary+Discussions/">Diary Discussions</a></li>
                    <li><a href="/forums/Forensics/">Forensics</a></li>
                    <li><a href="/forums/General+Discussion/">General Discussions</a></li>
                    <li><a href="/forums/Industry+News/">Industry News</a></li>
                    <li><a href="/forums/Network+Security/">Network Security</a></li>
                    <li><a href="/forums/Penetration+Testing/">Penetration Testing</a></li>
                    <li><a href="/forums/Software+Security/">Software Security</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="sidebar">
        <p>Subscribe to the Internet Storm Center <a href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A">YouTube Channel</a></p>
        <iframe width="160" height="600" src="https://www.sans.org/banners/isc_ss.php" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>
	</div>
</div>
<div id="footer">
	<ul id="socialIconsFoot">
        <li><a href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A">YouTube<span></span></a></li>
        <li class="twitter"><a href="http://twitter.com/sans_isc">Twitter<span></span></a></li>
        <li class="linkedin"><a href="http://www.linkedin.com/groups?gid=35470">LinkedIn<span></span></a></li>
        <li class="rss"><a href="/xml.html">ISC Feed<span></span></a></li>
	</ul>
	<a class="sans" href="https://www.sans.edu/"><span></span></a>
	<ul id="footLinks">
        <li><a href="http://www.cafepress.com/stormcenter">Shop</a></li>
        <li><a href="/linkback.html">Link To Us</a></li>
        <li><a href="/about.html">About Us</a></li>
        <li><a href="/handler_list.html">Handlers</a></li>
        <li><a href="/privacy.html">Privacy Policy</a></li>
        <li><a href="#top">Back To Top</a></li>
	</ul>
	<strong>Developers:</strong> We have an <a href="/api/">API</a> for you! &nbsp; <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="/images/cc.png" /></a>
</div>
</body></html>