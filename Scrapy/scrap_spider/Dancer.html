<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>AnnoCPAN - Dancer::Cookbook</title>
    <meta name="description" content='AnnoCPAN is an "Annotated CPAN"; a site
    where users can add notes next to the POD documentation for Perl modules'>
    <meta name="keywords" content="cpan, perl, module, modules, documentation, annocpan">
    <link rel="stylesheet" type="text/css" href="/annocpan.css">
    
    <link rel="stylesheet" title="margin notes" type="text/css" href="/layout-side.css">
    <link rel="alternate stylesheet" title="inline notes" type="text/css" href="/layout-inline.css">
    
    
        
        <script src="/show.js" type="text/javascript"></script>
        
    
    <link rel="alternate" title="New CPAN Distributions" href="http://annocpan.org/recent_dists.rss" type="application/rss+xml">
    

    
</head>

<body>

<h1><a href="/"><img src="/img/annocpan.png" alt="Annotated CPAN" height="50" width="280"></a></h1>

<ul id="nav">
<li><a href="/">Home</a>
<li><a href="/about">About</a>
<li><a href="/faq">FAQ</a>
<li><a href="/news">News</a>

    <li class="right"><a href="/new_user">New user</a>

</ul>


<div id="content">









<div id="login_form">

<form action="./" method="post" class="float">
    <input type="hidden" name="mode" value="login">
    <input type="hidden" name="from" value="/~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod">
    <label for="login">login</label>
    <input type="text" name="user" id="login" class="text" size="8"><br>
    <label for="passwd">password</label>
    <input type="password" name="passwd" id="passwd" size="8" class="text">
    <input type="submit" value="login">
</form>

</div>

<form id="searchform" action="/" method="get">
    <input type="hidden" name="mode" value="search" />
    <label for="name">Go to</label>
    <select name="field" class="field">
        
        <option >Module</option>
        
        <option >Distribution</option>
        
        <option >Author</option>
        
    </select>
    <input type="text" name="name" id="name" class="text" value=""/>
    <input type="submit" />
</form>


<h2>
<a href="/~YANICK">YANICK</a>
&gt;
    <a href="/~YANICK/Dancer-1.3118">Dancer-1.3118</a> 
&gt; 
    <a href="/pod/Dancer::Cookbook">Dancer::Cookbook</a>
</h2>

<p id="podsisters" class="sisters">[    <a href="http://search.cpan.org/~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod">search.cpan.org</a> |
    <a href="http://cpan.uwinnipeg.ca/htdocs/Dancer/Dancer/Cookbook.html">Kobes search</a> |
    <a href="http://rt.cpan.org/NoAuth/Bugs.html?Dist=Dancer" title="report a bug for Dancer in the perl.org request tracking system">report a bug</a> 
]
<br>
</p>



<div id="pod2html">



<p class="firstnote">(1 note; <a href="#note_2799" title="First note">[first note]</a>)</p>







    <h3><a name="name"></a>NAME

</h3>








    <div class="para">
    <a name="2"></a>
    <div class="content"><p>Dancer::Cookbook - a quick-start guide to the Dancer web framework

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779402#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#2" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="description"></a>DESCRIPTION

</h3>








    <div class="para">
    <a name="4"></a>
    <div class="content"><p>A quick-start guide with examples to get you up and running with the Dancer web
framework.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779404#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#4" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="beginner%27s_dance"></a>BEGINNER'S DANCE

</h3>








    <h4><a name="your_first_dancer_web_app"></a>Your first Dancer web app

</h4>








    <div class="para">
    <a name="9"></a>
    <div class="content"><p>Dancer has been designed to be easy to work with - it's trivial to write a
simple web app, but still has the power to work with larger projects.  To start
with, let's make an incredibly simple "Hello World" example:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779407#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#9" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="10"></a>
    <div class="content"><div><pre>    #!/usr/bin/perl

    use Dancer;

    get '/hello/:name' =&gt; sub {
        return "Why, hello there " . params-&gt;{name};
    };

    dance;

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779408#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#10" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="14"></a>
    <div class="content"><p>Yes - the above is a fully-functioning web app; running that script will launch
a webserver listening on the default port (3000); now you can make a request

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779409#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#14" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="15"></a>
    <div class="content"><div><pre>    $ curl http://localhost:3000/hello/Bob
    Why, hello there Bob

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779410#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#15" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="16"></a>
    <div class="content"><p>(or the name of the machine you ran it on, if it's not your local system),
and it will say hello.  The <code>:name</code> part is a named parameter within the
route specification, whose value is made available through <code>params</code>
- more on that later.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779411#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#16" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="17"></a>
    <div class="content"><p>Note that you don't need to use the <code>strict</code> and <code>warnings</code> pragma, they are
already loaded by Dancer.  (If you don't want the <code>warnings</code> pragma (which can
lead to undesired warnings about use of undef values, for example), then set the
<a href="/perldoc?Dancer::Config#import_warnings">import_warnings</a> setting to a false value.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779412#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#17" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="starting_a_dancer_project"></a>Starting a Dancer project

</h4>








    <div class="para">
    <a name="21"></a>
    <div class="content"><p>The first simple example is fine for trivial projects, but for anything more
complex, you'll want a more maintainable solution - enter the <code>dancer</code> helper
script, which will build the framework of your application with a single
command:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779414#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#21" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="22"></a>
    <div class="content"><div><pre>    $ dancer -a mywebapp
    + mywebapp
    + mywebapp/bin
    + mywebapp/bin/app.pl
    + mywebapp/config.yml
    + mywebapp/environments
    + mywebapp/environments/development.yml
    + mywebapp/environments/production.yml
    + mywebapp/views
    + mywebapp/views/index.tt
    + mywebapp/views/layouts
    + mywebapp/views/layouts/main.tt
    + mywebapp/MANIFEST.SKIP
    + mywebapp/lib
    + mywebapp/lib/mywebapp.pm
    + mywebapp/public
    + mywebapp/public/css
    + mywebapp/public/css/style.css
    + mywebapp/public/css/error.css
    + mywebapp/public/images
    + mywebapp/public/500.html
    + mywebapp/public/404.html
    + mywebapp/public/dispatch.fcgi
    + mywebapp/public/dispatch.cgi
    + mywebapp/public/javascripts
    + mywebapp/public/javascripts/jquery.js
    + mywebapp/t
    + mywebapp/t/002_index_route.t
    + mywebapp/t/001_base.t
    + mywebapp/Makefile.PL

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779415#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#22" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="23"></a>
    <div class="content"><p>As you can see, it creates a directory named after the name of the app, along
with a configuration file, a views directory (where your templates and layouts
will live), an environments directory (where environment-specific settings
live), a module containing the actual guts of your application, a script to
start it - or to run your web app via Plack/PSGI - more on that later.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779416#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#23" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="dance_routines%3a_routes"></a>DANCE ROUTINES: ROUTES

</h3>








    <h4><a name="declaring_routes"></a>Declaring routes

</h4>








    <div class="para">
    <a name="28"></a>
    <div class="content"><p>To control what happens when a web request is received by your webapp, you'll
need to declare <code>routes</code>.  A route declaration indicates which HTTP method(s)
it is valid for, the path it matches (e.g. /foo/bar), and a coderef to execute,
which returns the response.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779419#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#28" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="29"></a>
    <div class="content"><div><pre>    get '/hello/:name' =&gt; sub {
        return "Hi there " . params-&gt;{name};
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779420#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#29" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="30"></a>
    <div class="content"><p>The above route specifies that, for GET requests to '/hello/...', the code block
provided should be executed.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779421#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#30" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="handling_multiple_http_request_methods"></a>Handling multiple HTTP request methods

</h4>








    <div class="para">
    <a name="32"></a>
    <div class="content"><p>Routes can use <code>any</code> to match all, or a specified list of HTTP methods.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779423#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#32" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="33"></a>
    <div class="content"><p>The following will match any HTTP request to the path /myaction:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779424#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#33" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="34"></a>
    <div class="content"><div><pre>    any '/myaction' =&gt; sub {
        # code
    }

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779425#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#34" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="35"></a>
    <div class="content"><p>The following will match GET or POST requests to /myaction:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779426#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#35" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="36"></a>
    <div class="content"><div><pre>    any ['get', 'post'] =&gt; '/myaction' =&gt; sub {
        # code
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779427#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#36" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="37"></a>
    <div class="content"><p>For convenience, any route which matches GET requests will also match HEAD
requests.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779428#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#37" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="retrieving_request_parameters"></a>Retrieving request parameters

</h4>








    <div class="para">
    <a name="41"></a>
    <div class="content"><p>The <a href="/perldoc?Dancer#params">params</a> keyword returns a hashref of request parameters; 
these will be parameters supplied on the query string, within the path itself 
(with named placeholders), and, for HTTP POST requests, the content of the 
POST body.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779430#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#41" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="named_parameters_in_route_path_declarations"></a>Named parameters in route path declarations

</h4>








    <div class="para">
    <a name="45"></a>
    <div class="content"><p>As seen above, you can use <code>:somename</code> in a route's path to capture part of the
path; this will become available by calling <a href="/perldoc?Dancer#params">params</a>.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779432#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#45" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="46"></a>
    <div class="content"><p>So, for a web app where you want to display information on a company, you might
use something like:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779433#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#46" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="47"></a>
    <div class="content"><div><pre>    get '/company/view/:companyid' =&gt; sub {
        my $company_id = params-&gt;{companyid};
        # Look up the company and return appropriate page
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779434#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#47" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="wildcard_path_matching_and_splat"></a>Wildcard path matching and splat

</h4>








    <div class="para">
    <a name="51"></a>
    <div class="content"><p>You can also declare wildcards in a path, and retrieve the values they matched
with the <a href="/perldoc?Dancer#splat">splat</a> keyword:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779436#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#51" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="52"></a>
    <div class="content"><div><pre>    get '/*/*' =&gt; sub {
        my ($action, $id) = splat;
        if (my $action eq 'view') {
            return display_item($id);
        } elsif ($action eq 'delete') {
            return delete_item($id);
        } else {
            status 'not_found';
            return "What?";
        }
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779437#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#52" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="before_hooks_%2d_processed_before_a_request"></a>Before hooks - processed before a request

</h4>








    <div class="para">
    <a name="56"></a>
    <div class="content"><p>A before <a href="/perldoc?Dancer#hook">hook</a> declares code which should be handled before 
a request is passed to the appropriate route.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779439#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#56" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="57"></a>
    <div class="content"><div><pre>    hook 'before' =&gt; sub {
        var note =&gt; 'Hi there';
        request-&gt;path_info('/foo/oversee')
    };

    get '/foo/*' =&gt; sub {
        my ($match) = splat; # 'oversee';
        vars-&gt;{note}; # 'Hi there'
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779440#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#57" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="59"></a>
    <div class="content"><p>The above declares a before hook which uses <code>var</code> to set a variable which
will later be available within the route handler, then amends the path of the
request to <code>/foo/oversee</code>; this means that, whatever path was requested, it
will be treated as though the path requested was <code>/foo/oversee</code>.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779441#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#59" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="default_route"></a>Default route

</h4>








    <div class="para">
    <a name="61"></a>
    <div class="content"><p>In case you want to avoid a <i>404 error</i>, or handle multiple routes in the same
way and you don't feel like configuring all of them, you can set up a default
route handler.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779443#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#61" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="62"></a>
    <div class="content"><p>The default route handler will handle any request that doesn't get served by
any other route.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779444#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#62" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="63"></a>
    <div class="content"><p>All you need to do is set up the following route as the <b>last</b> route:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779445#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#63" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="64"></a>
    <div class="content"><div><pre>    any qr{.*} =&gt; sub {
        status 'not_found';
        template 'special_404', { path =&gt; request-&gt;path };
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779446#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#64" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="65"></a>
    <div class="content"><p>Then you can set up the template as such:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779447#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#65" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="66"></a>
    <div class="content"><div><pre>    You tried to reach &lt;% path %&gt;, but it is unavailable at the moment.

    Please try again or contact us at our email at &lt;...&gt;.

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779448#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#66" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="using_the_auto_page_feature_for_automatic_route_creation"></a>Using the auto_page feature for automatic route creation

</h4>








    <div class="para">
    <a name="70"></a>
    <div class="content"><p>For simple "static" pages, you can simply enable the <code>auto_page</code> config
setting; this means that you need not declare a route handler for those pages;
if a request is for <code>/foo/bar</code>, Dancer will check for a matching view (e.g.
<code>/foo/bar.tt</code> and render it with the default layout etc if found.  For full
details, see the documentation for the 
<a href="/perldoc?Dancer::Config#auto_page">auto_page setting</a>.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779450#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#70" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="why_should_i_use_the_ajax_plugin"></a>Why should I use the Ajax plugin

</h4>








    <div class="para">
    <a name="74"></a>
    <div class="content"><p>As an Ajax query is just a HTTP query, it's similar to a GET or POST
route. You may ask yourself why you may want to use the <code>ajax</code>
keyword (from the <a href="/perldoc?Dancer::Plugin::Ajax">Dancer::Plugin::Ajax</a> plugin) instead of a simple
<code>get</code>.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779452#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#74" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="75"></a>
    <div class="content"><p>Let's say you have a path like '/user/:user' in your application. You
may want to be able to serve this page, with a layout and HTML
content. But you may also want to be able to call this same url from a
javascript query using Ajax.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779453#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#75" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="76"></a>
    <div class="content"><p>So, instead of having the following code:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779454#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#76" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="77"></a>
    <div class="content"><div><pre>    get '/user/:user' =&gt; sub {
         if (request-&gt;is_ajax) {
             # create xml, set headers to text/xml, blablabla
              header('Content-Type' =&gt; 'text/xml');
              header('Cache-Control' =&gt;  'no-store, no-cache, must-reval
<span class="line_cont">+</span>idate');
              to_xml({...})
         }else{
             template users, {....}
         }
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779455#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#77" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="78"></a>
    <div class="content"><p>you can have

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779456#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#78" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="79"></a>
    <div class="content"><div><pre>    get '/user/:user' =&gt; sub {
        template users, {...}
    }

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779457#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#79" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="80"></a>
    <div class="content"><p>and

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779458#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#80" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="81"></a>
    <div class="content"><div><pre>    ajax '/user/:user' =&gt; sub {
         to_xml({...}, RootName =&gt; undef);
    }

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779459#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#81" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="83"></a>
    <div class="content"><p>Because it's an ajax query, you know you need to return a xml content,
so the content type of the response is set for you.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779460#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#83" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="using_the_prefix_feature_to_split_your_application"></a>Using the prefix feature to split your application

</h4>








    <div class="para">
    <a name="87"></a>
    <div class="content"><p>For better maintainability, you may want to separate some of your application
components to different packages. Let's say we have a simple web app with an
admin section, and want to maintain this in a different package:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779462#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#87" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="88"></a>
    <div class="content"><div><pre>    package myapp;
    use Dancer ':syntax';
    use myapp::admin;

    prefix undef;

    get '/' =&gt; sub {...};

    1;

    package myapp::admin;
    use Dancer ':syntax';

    prefix '/admin';

    get '/' =&gt; sub {...};

    1;

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779463#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#88" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="96"></a>
    <div class="content"><p>The following routes will be generated for us:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779464#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#96" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="97"></a>
    <div class="content"><div><pre>    - get /
    - get /admin/
    - head /
    - head /admin/

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779465#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#97" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="muscle_memory%3a_storing_data"></a>MUSCLE MEMORY: STORING DATA

</h3>








    <h4><a name="handling_sessions"></a>Handling sessions

</h4>








    <div class="para">
    <a name="102"></a>
    <div class="content"><p>It's common to want to use sessions to give your web applications state; for
instance, allowing a user to log in, creating a session, and checking that
session on subsequent requests.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779468#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#102" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="103"></a>
    <div class="content"><p>To make use of sessions, you must first enable the session engine - pick the
session engine you want to use, then declare it in your config file:
config file, add:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779469#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#103" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="104"></a>
    <div class="content"><div><pre>    session: Simple

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779470#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#104" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="105"></a>
    <div class="content"><p>The <a href="/perldoc?Dancer::Session::Simple">Dancer::Session::Simple</a> backend implements very simple in-memory session
storage.  This will be fast and useful for testing, but sessions do not persist
between restarts of your app.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779471#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#105" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="106"></a>
    <div class="content"><p>You can also use the <a href="/perldoc?Dancer::Session::YAML">Dancer::Session::YAML</a> backend included with Dancer,
which stores session data on disc in YAML files (since YAML is a nice
human-readable format, it makes inspecting the contents of sessions a breeze):

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779472#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#106" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="107"></a>
    <div class="content"><div><pre>    session: YAML

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779473#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#107" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="108"></a>
    <div class="content"><p>Or, to enable session support from within your code,

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779474#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#108" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="109"></a>
    <div class="content"><div><pre>    set session =&gt; 'YAML';

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779475#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#109" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="110"></a>
    <div class="content"><p>(Controlling settings is best done from your config file, though).  'YAML' in
the example is the session backend to use; this is shorthand for
<a href="/perldoc?Dancer::Session::YAML">Dancer::Session::YAML</a>.  There are other session backends you may wish to use,
for instance <a href="/perldoc?Dancer::Session::Memcache">Dancer::Session::Memcache</a>, but the YAML backend is a simple and
easy to use example which stores session data in a YAML file in sessions).

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779476#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#110" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="111"></a>
    <div class="content"><p>You can then use the <a href="/perldoc?Dancer#session">session</a> keyword to manipulate the
session:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779477#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#111" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="storing_data_in_the_session"></a>Storing data in the session

</h5>








    <div class="para">
    <a name="113"></a>
    <div class="content"><p>Storing data in the session is as easy as:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779479#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#113" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="114"></a>
    <div class="content"><div><pre>    session varname =&gt; 'value';

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779480#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#114" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="retrieving_data_from_the_session"></a>Retrieving data from the session

</h5>








    <div class="para">
    <a name="118"></a>
    <div class="content"><p>Retrieving data from the session is as easy as:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779482#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#118" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="119"></a>
    <div class="content"><div><pre>    session('varname')

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779483#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#119" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="120"></a>
    <div class="content"><p>Or, alternatively,

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779484#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#120" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="121"></a>
    <div class="content"><div><pre>    session-&gt;{varname}

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779485#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#121" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="controlling_where_sessions_are_stored"></a>Controlling where sessions are stored

</h5>








    <div class="para">
    <a name="125"></a>
    <div class="content"><p>For disc-based session back ends like <a href="/perldoc?Dancer::Session::YAML">Dancer::Session::YAML</a>,
<a href="/perldoc?Dancer::Session::Storable">Dancer::Session::Storable</a> etc, session files are written to the session dir
specified by the <code>session_dir</code> setting, which defaults to <code>appdir/sessions</code> if
not specifically set.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779487#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#125" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="126"></a>
    <div class="content"><p>If you need to control where session files are created, you can do so quickly
and easily within your config file, for example:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779488#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#126" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="127"></a>
    <div class="content"><div><pre>    session_dir: /tmp/dancer-sessions

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779489#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#127" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="128"></a>
    <div class="content"><p>If the directory you specify does not exist, Dancer will attempt to create it
for you.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779490#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#128" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="destroying_a_session"></a>Destroying a session

</h5>








    <div class="para">
    <a name="132"></a>
    <div class="content"><p>When you're done with your session, you can destroy it:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779492#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#132" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="133"></a>
    <div class="content"><div><pre>    session-&gt;destroy

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779493#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#133" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="sessions_and_logging_in"></a>Sessions and logging in

</h4>








    <div class="para">
    <a name="135"></a>
    <div class="content"><p>A common requirement is to check the user is logged in, and, if not, require
them to log in before continuing.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779495#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#135" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="136"></a>
    <div class="content"><p>This can easily be handled with a before <a href="/perldoc?Dancer#hook">hook</a> to check their session:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779496#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#136" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="137"></a>
    <div class="content"><div><pre>    hook 'before' =&gt; sub {
        if (! session('user') &amp;&amp; request-&gt;path_info !~ m{^/login}) {
            var requested_path =&gt; request-&gt;path_info;
            request-&gt;path_info('/login');
        }
    };

    get '/login' =&gt; sub {
        # Display a login page; the original URL they requested is avail
<span class="line_cont">+</span>able as
        # vars-&gt;{requested_path}, so could be put in a hidden field in t
<span class="line_cont">+</span>he form
        template 'login', { path =&gt; vars-&gt;{requested_path} };
    };

    post '/login' =&gt; sub {
        # Validate the username and password they supplied
        if (params-&gt;{user} eq 'bob' &amp;&amp; params-&gt;{pass} eq 'letmein') {
            session user =&gt; params-&gt;{user};
            redirect params-&gt;{path} || '/';
        } else {
            redirect '/login?failed=1';
        }
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779497#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#137" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="140"></a>
    <div class="content"><p>In your login page template, you'll want a text field named user, a password
field named pass, and a hidden field named path, which will be populated with
the path originally requested, so that it's sent back in the POST submission,
and can be used by the post route to redirect onwards to the page originally
requested once you're logged in.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779498#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#140" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="141"></a>
    <div class="content"><p>Of course, you'll probably want to validate your users against a database table,
or maybe via IMAP/LDAP/SSH/POP3/local system accounts via PAM etc.
<a href="/perldoc?Authen::Simple">Authen::Simple</a> is probably a good starting point here!

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779499#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#141" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="142"></a>
    <div class="content"><p>A simple working example of handling authentication against a database table
yourself (using <a href="/perldoc?Dancer::Plugin::Database">Dancer::Plugin::Database</a> which provides the <code>database</code>
keyword, and <a href="/perldoc?Crypt::SaltedHash">Crypt::SaltedHash</a> to handle salted hashed passwords (well, you
wouldn't store your users passwords in the clear, would you?)) follows:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779500#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#142" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="143"></a>
    <div class="content"><div><pre>    post '/login' =&gt; sub {
        my $user = database-&gt;quick_select('users', 
            { username =&gt; params-&gt;{user} }
        );
        if (!$user) {
            warning "Failed login for unrecognised user " . params-&gt;{use
<span class="line_cont">+</span>r};
            redirect '/login?failed=1';
        } else {
            if (Crypt::SaltedHash-&gt;validate($user-&gt;{password}, params-&gt;{
<span class="line_cont">+</span>pass}))
            {
                debug "Password correct";
                # Logged in successfully
                session user =&gt; $user;
                redirect params-&gt;{path} || '/';
            } else {
                debug("Login failed - password incorrect for " . params-
<span class="line_cont">+</span>&gt;{user});
                redirect '/login?failed=1';
            }
        }
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779501#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#143" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="retrieve_complete_hash_stored_in_session"></a>Retrieve complete hash stored in session

</h5>








    <div class="para">
    <a name="147"></a>
    <div class="content"><p>Get complete hash stored in session:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779503#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#147" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="148"></a>
    <div class="content"><div><pre>    my $hash = session;

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779504#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#148" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="appearance"></a>APPEARANCE

</h3>








    <h4><a name="using_templates_%2d_views_and_layouts"></a>Using templates - views and layouts

</h4>








    <div class="para">
    <a name="153"></a>
    <div class="content"><p>Returning plain content is all well and good for examples or trivial apps, but
soon you'll want to use templates to maintain separation between your code and
your content.  Dancer makes this easy.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779507#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#153" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="154"></a>
    <div class="content"><p>Your route handlers can use the <a href="/perldoc?Dancer#template">template</a> keyword to render
templates.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779508#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#154" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="views"></a>Views

</h5>








    <div class="para">
    <a name="156"></a>
    <div class="content"><p>It's possible to render the action's content with a template, this is called a
view. The `appdir/views' directory is the place where views are located.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779510#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#156" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="157"></a>
    <div class="content"><p>You can change this location by changing the setting 'views'.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779511#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#157" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="158"></a>
    <div class="content"><p>By default, the internal template engine <a href="/perldoc?Dancer::Template::Simple">Dancer::Template::Simple</a> is used,
but you may want to upgrade to Template::Toolkit. If you do so, you have to
enable this engine in your settings as explained in
<a href="/perldoc?Dancer::Template::TemplateToolkit">Dancer::Template::TemplateToolkit</a>.  If you do so, you'll also have to
import the <a href="/perldoc?Template">Template</a> module in your application code.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779512#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#158" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="159"></a>
    <div class="content"><p>Note that, by default, Dancer configures the Template::Toolkit engine to use
<code>&lt;% %</code>&gt; brackets instead of its default <code>[% %]</code> brackets.  You can change this
by using the following in your config file:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779513#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#159" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="160"></a>
    <div class="content"><div><pre>    template: template_toolkit

    engines:
        template_toolkit:
            start_tag: '[%'
            stop_tag: '%]'

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779514#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#160" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="162"></a>
    <div class="content"><p>All views must have a '.tt' extension. This may change in the future.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779515#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#162" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="163"></a>
    <div class="content"><p>In order to render a view, just call the <code>template|Dancer/template</code> keyword at
the end of the action by giving the view name and the HASHREF of tokens to
interpolate in the view (note that for convenience, the request, session, params
and vars are automatically accessible in the view, named <code>request</code>, <code>session</code>,
<code>params</code> and <code>vars</code>) - for example:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779516#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#163" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="164"></a>
    <div class="content"><div><pre>    hook 'before' =&gt; sub { var time =&gt; scalar(localtime) };

    get '/hello/:name' =&gt; sub {
        my $name = params-&gt;{name};
        template 'hello.tt', { name =&gt; $name };
    };

</pre>
</div></div>


    <div class="noteblock">
    
         
        
            




<div class="note sim_100" id="note_2799">
<div class="note_header">
    <div class="note_data">
        <a href="/user/bohica">bohica</a> 
    (2012-02-21 11:02:06)
    <a class="button u_987" href="/e/?mode=edit;notepos=72551#noteform">[edit]</a>
    <a class="button u_987" href="/e/?mode=move;notepos=72551#164">[move]</a>
    </div>
    <div class="note_nav">
    
    <a href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#note_2799" title="Bookmarkable link to this note">§</a>
    
    </div>
</div> <!-- note_header -->
<div class="note_body">
        
    <p>I think this needs to have a "return" before the call to template.</p>

</div>
</div> <!-- note -->



        
    

    
        <a href="/e/?mode=create;section=75779517#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#164" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="166"></a>
    <div class="content"><p>The template 'hello.tt' could contain, for example:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779518#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#166" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="167"></a>
    <div class="content"><div><pre>    &lt;p&gt;Hi there, &lt;% name %&gt;!&lt;/p&gt;
    &lt;p&gt;You're using &lt;% request.user_agent %&gt;&lt;/p&gt;
    &lt;% IF session.username %&gt;
        &lt;p&gt;You're logged in as &lt;% session.username %&gt;
    &lt;% END %&gt;
    It's currently &lt;% vars.time %&gt;

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779519#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#167" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="168"></a>
    <div class="content"><p>For a full list of the tokens automatically added to your template
(like <code>session</code>, <code>request</code> and <code>vars</code>, refer to
<a href="/perldoc?Dancer::Template::Abstract">Dancer::Template::Abstract</a>).

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779520#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#168" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="layouts"></a>Layouts

</h5>








    <div class="para">
    <a name="170"></a>
    <div class="content"><p>A layout is a special view, located in the 'layouts' directory (inside the views
directory) which must have a token named 'content'. That token marks the place
where to render the action view. This lets you define a global layout for your
actions, and have each individual view contain only the specific content.  This
is a good thing to avoid lots of needless duplication of HTML :)

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779522#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#170" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="171"></a>
    <div class="content"><p>Here is an example of a layout: <code>views/layouts/main.tt</code> :

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779523#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#171" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="172"></a>
    <div class="content"><div><pre>    &lt;html&gt;
        &lt;head&gt;...&lt;/head&gt;
        &lt;body&gt;
        &lt;div id="header"&gt;
        ...
        &lt;/div&gt;

        &lt;div id="content"&gt;
        &lt;% content %&gt;
        &lt;/div&gt;

        &lt;/body&gt;
    &lt;/html&gt;

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779524#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#172" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="175"></a>
    <div class="content"><p>You can tell your app which layout to use with <code>layout: name</code> in the config
file, or within your code:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779525#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#175" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="176"></a>
    <div class="content"><div><pre>    set layout =&gt; 'main';

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779526#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#176" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="177"></a>
    <div class="content"><p>You can control which layout to use (or whether to use a layout at all) for a
specific request without altering the layout setting by passing an options
hashref as the third param to the template keyword:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779527#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#177" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="178"></a>
    <div class="content"><div><pre>    template 'index.tt', {}, { layout =&gt; undef };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779528#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#178" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="179"></a>
    <div class="content"><p>If your application is not mounted under root (<b>/</b>), you can use a
before_template_render hook instead of hardcoding the path to your
application for your css, images and javascript:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779529#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#179" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="180"></a>
    <div class="content"><div><pre>    hook 'before_template_render' =&gt; sub {
        my $tokens = shift;
        $tokens-&gt;{uri_base} = request-&gt;base-&gt;path;
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779530#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#180" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="181"></a>
    <div class="content"><p>THen in your layout, modify your css inclusion as follows:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779531#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#181" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="182"></a>
    <div class="content"><div><pre>    &lt;link rel="stylesheet" href="&lt;% uri_base %&gt;/css/style.css" /&gt;

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779532#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#182" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="183"></a>
    <div class="content"><p>From now on, you can mount your application wherever you want, without
any further modification of the css inclusion

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779533#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#183" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="template_and_unicode"></a>template and unicode

</h5>








    <div class="para">
    <a name="187"></a>
    <div class="content"><p>If you use <a href="/perldoc?Plack">Plack</a> and have some unicode problem with your Dancer application,
don't forget to check if you have set your template engine to use unicode, and
set the default charset to UTF-8. So, if you are using template toolkit, your
config.yml will look like this:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779535#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#187" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="188"></a>
    <div class="content"><div><pre>    charset: UTF-8
    engines:
      template_toolkit:
        ENCODING: utf8

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779536#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#188" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="tt%27s_wrapper_directive_in_dancer_%28meta_variables%2c_sets%29"></a>TT's WRAPPER directive in Dancer (META variables, SETs)

</h5>








    <div class="para">
    <a name="192"></a>
    <div class="content"><p>Dancer already provides a WRAPPER-like ability, which we call a "layout". The
reason we do not use TT's WRAPPER (which also makes it incompatible with it) is
because not all template systems support it. Actually, most don't.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779538#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#192" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="193"></a>
    <div class="content"><p>However, you might want to use it, and be able to define META variables and
regular <a href="/perldoc?Template::Toolkit">Template::Toolkit</a> variables.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779539#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#193" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="194"></a>
    <div class="content"><p>These few steps will get you there:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779540#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#194" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <ul>








    <li><b>Disable the layout in Dancer

</b>








    <div class="para">
    <a name="197"></a>
    <div class="content"><p>You can do this by simply commenting (or removing) the <code>layout</code> configuration
in the <span class="filename">config.yml</span> file.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779543#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#197" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <li><b>Use Template Toolkit template engine

</b>








    <div class="para">
    <a name="199"></a>
    <div class="content"><p>Change the configuration of the template to Template Toolkit:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779545#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#199" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="200"></a>
    <div class="content"><div><pre>    # in config.yml
    template: "template_toolkit"

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779546#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#200" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <li><b>Tell the Template Toolkit engine who's your wrapper

</b>








    <div class="para">
    <a name="202"></a>
    <div class="content"><div><pre>    # in config.yml
    # ...
    engines:
        template_toolkit:
            WRAPPER: layouts/main.tt

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779548#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#202" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    </ul>








    <div class="para">
    <a name="204"></a>
    <div class="content"><p>Done! Everything will work fine out of the box, including variables and META
variables.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779550#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#204" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="setting_the_stage%3a_configuration_and_logging"></a>SETTING THE STAGE: CONFIGURATION AND LOGGING

</h3>








    <h4><a name="configuration_and_environments"></a>Configuration and environments

</h4>








    <div class="para">
    <a name="209"></a>
    <div class="content"><p>Configuring a Dancer application can be done in many ways. The easiest one (and
maybe the the dirtiest) is to put all your settings statements at the top of
your script, before calling the dance() method.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779553#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#209" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="210"></a>
    <div class="content"><p>Other ways are possible, you can define all your settings in the file
`appdir/config.yml'. For this, you must have installed the YAML module, and of
course, write the config file in YAML.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779554#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#210" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="211"></a>
    <div class="content"><p>That's better than the first option, but it's still not perfect as you can't
switch easily from an environment to another without rewriting the config.yml
file.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779555#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#211" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="212"></a>
    <div class="content"><p>The better way is to have one config.yml file with default global settings,
like the following:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779556#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#212" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="213"></a>
    <div class="content"><div><pre>    # appdir/config.yml
    logger: 'file'
    layout: 'main'

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779557#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#213" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="214"></a>
    <div class="content"><p>And then write as many environment files as you like in <code>appdir/environments</code>.
That way, the appropriate environment config file will be loaded according to
the running environment (if none is specified, it will be 'development').

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779558#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#214" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="215"></a>
    <div class="content"><p>Note that you can change the running environment using the <code>--environment</code>
commandline switch.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779559#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#215" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="216"></a>
    <div class="content"><p>Typically, you'll want to set the following values in a development config file:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779560#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#216" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="217"></a>
    <div class="content"><div><pre>    # appdir/environments/development.yml
    log: 'debug'
    startup_info: 1
    show_errors:  1

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779561#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#217" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="218"></a>
    <div class="content"><p>And in a production one:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779562#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#218" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="219"></a>
    <div class="content"><div><pre>    # appdir/environments/production.yml
    log: 'warning'
    startup_info: 0
    show_errors:  0

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779563#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#219" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="accessing_configuration_information_from_your_app"></a>Accessing configuration information from your app

</h4>








    <div class="para">
    <a name="223"></a>
    <div class="content"><p>A Dancer application can use the 'config' keyword to easily access the settings
within its config file, for instance:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779565#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#223" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="224"></a>
    <div class="content"><div><pre>    get '/appname' =&gt; sub {
        return "This is " . config-&gt;{appname};
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779566#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#224" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="225"></a>
    <div class="content"><p>This makes keeping your application's settings all in one place simple and easy
- you shouldn't need to worry about implementing all that yourself :)

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779567#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#225" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="accessing_configuration_information_from_a_separate_script"></a>Accessing configuration information from a separate script

</h4>








    <div class="para">
    <a name="229"></a>
    <div class="content"><p>You may well want to access your webapp's configuration from outside your
webapp. You could, of course, use the YAML module of your choice and load your
webapps's config.yml, but chances are that this is not convenient.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779569#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#229" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="230"></a>
    <div class="content"><p>Use Dancer instead. Without any ado, magic or too big jumps, you can use the
values from config.yml and some additional default values:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779570#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#230" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="231"></a>
    <div class="content"><div><pre>	# bin/script1.pl
	use Dancer ':script';
	print "template:".config-&gt;{template}."\n"; #simple
	print "log:".config-&gt;{log}."\n"; #undef

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779571#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#231" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="232"></a>
    <div class="content"><p>Note that config-&gt;{log} should result undef error on a default scaffold since
you did not load the environment and in the default scaffold log is defined in
the environment and not in config.yml. Hence undef.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779572#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#232" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="233"></a>
    <div class="content"><p>If you want to load an environment you need to tell Dancer where to look for it.
One way to do so, is to tell Dancer where the webapp lives. From there Dancer
deducts where the config.yml file is (typically $webapp/config.yml).

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779573#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#233" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="234"></a>
    <div class="content"><div><pre>	# bin/script2.pl
	use FindBin;
	use Cwd qw/realpath/;
	use Dancer ':script';

	#tell the Dancer where the app lives
	my $appdir=realpath( "$FindBin::Bin/..");

	Dancer::Config::setting('appdir',$appdir);
	Dancer::Config::load();

	#getter
	print "environment:".config-&gt;{environment}."\n"; #development
	print "log:".config-&gt;{log}."\n"; #value from development environment

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779574#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#234" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="238"></a>
    <div class="content"><p>By default Dancer loads development environment (typically
$webapp/environment/development.yml). In contrast to the example before,  you
do have a value from the development environment (environment/development.yml)
now. Also note that in the above example Cwd and FindBin are used. They are
likely to be already loaded by Dancer anyways, so it's not a big overhead. You
could just as well hand over a simple path for the app if you like that better,
e.g.:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779575#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#238" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="239"></a>
    <div class="content"><div><pre>	Dancer::Config::setting('appdir','/path/to/app/dir');

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779576#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#239" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="240"></a>
    <div class="content"><p>If you want to load an environment other than the default, try this:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779577#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#240" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="241"></a>
    <div class="content"><div><pre>	# bin/script2.pl
	use Dancer ':script';

	#tell the Dancer where the app lives
	Dancer::Config::setting('appdir','/path/to/app/dir');

	#which environment to load
	config-&gt;{environment}='production';

	Dancer::Config::load();

	#getter
	print "log:".config-&gt;{log}."\n"; #has value from production environment

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779578#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#241" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="246"></a>
    <div class="content"><p>By the way, you not only get values, you can also set values straightforward
like we do above with config-&gt;{environment}='production'. Of course, this value
does not get written in any file; it only lives in memory and your webapp
doesn't have access to it, but you can use it inside your script.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779579#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#246" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="logging"></a>Logging

</h4>








    <h5><a name="configuring_logging"></a>Configuring logging

</h5>








    <div class="para">
    <a name="251"></a>
    <div class="content"><p>It's possible to log messages generated by the application and by Dancer itself.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779582#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#251" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="252"></a>
    <div class="content"><p>To start logging, select the logging engine you wish to use with the <code>logger</code>
setting; Dancer includes built-in log engines named <code>file</code> and <code>console</code>,
which log to a logfile and to the console respectively.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779583#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#252" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="253"></a>
    <div class="content"><p>To enable logging to a file, add the following to your config.yml:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779584#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#253" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="254"></a>
    <div class="content"><div><pre>    logger: 'file'

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779585#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#254" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="255"></a>
    <div class="content"><p>Then you can choose which kind of messages you want to actually log:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779586#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#255" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="256"></a>
    <div class="content"><div><pre>    log: 'core'      # will log all messages, including messages from
                     # Dancer itself
    log: 'debug'     # will log debug, info, warning and error messages
    log: 'info'      # will log info, warning and error messages
    log: 'warning'   # will log warning and error messages
    log: 'error'     # will log error messages

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779587#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#256" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="257"></a>
    <div class="content"><p>If you're using the <code>file</code> logging engine, a directory <code>appdir/logs</code> will be
created and will host one logfile per environment. The log message contains the
time it was written, the PID of the current process, the message and the caller
information (file and line).

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779588#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#257" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="logging_your_own_messages"></a>Logging your own messages

</h5>








    <div class="para">
    <a name="259"></a>
    <div class="content"><p>Just call  <a href="/perldoc?Dancer#debug">debug</a>, <a href="/perldoc?Dancer#warning">warning</a>,
<a href="/perldoc?Dancer#error">error</a> or <a href="/perldoc?Dancer#info">info</a> with your message:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779590#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#259" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="260"></a>
    <div class="content"><div><pre>    debug "This is a debug message from my app.";

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779591#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#260" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="resting"></a>RESTING

</h3>








    <h4><a name="writing_a_rest_application"></a>Writing a REST application

</h4>








    <div class="para">
    <a name="263"></a>
    <div class="content"><p>With Dancer, it's easy to write REST applications. Dancer provides helpers to
serialize and deserialize for the following data formats:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779594#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#263" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <ul>








    <li><b>JSON

</b>








    <li><b>YAML

</b>








    <li><b>XML

</b>








    <li><b>Data::Dumper

</b>








    </ul>








    <div class="para">
    <a name="270"></a>
    <div class="content"><p>To activate this feature, you only have to set the <code>serializer</code> setting to the
format you require, for instance in your config.yml:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779601#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#270" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="271"></a>
    <div class="content"><div><pre>   serializer: JSON

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779602#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#271" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="272"></a>
    <div class="content"><p>Or right in your code:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779603#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#272" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="273"></a>
    <div class="content"><div><pre>   set serializer =&gt; 'JSON';

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779604#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#273" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="274"></a>
    <div class="content"><p>From now, all hash ref or array ref returned by a route will be serialized to
the format you chose, and all data received from <b>POST</b> or <b>PUT</b> requests
will be automatically deserialized.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779605#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#274" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="275"></a>
    <div class="content"><div><pre>    get '/hello/:name' =&gt; sub {
        # this structure will be returned to the client as
	# {"name":"$name"}
        return {name =&gt; params-&gt;{name}};
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779606#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#275" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="276"></a>
    <div class="content"><p>It's possible to let the client choose which serializer he want to use. For
this, use the <b>mutable</b> serializer, and an appropriate serializer will be
chosen from the <b>Content-Type</b> header.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779607#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#276" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="277"></a>
    <div class="content"><p>It's also possible to return a custom error, using the
<a href="/perldoc?Dancer#send_error">send_error</a> keyword..
When you don't use a serializer, the <code>send_error</code> function will take a string
as first parameter (the message), and an optional HTTP code. When using a
serializer, the message can be a string, an arrayref or a hashref:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779608#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#277" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="278"></a>
    <div class="content"><div><pre>    get '/hello/:name' =&gt; sub {
        if (...) {
           send_error("you can't do that");
           # or
           send_error({reason =&gt; 'access denied', message =&gt; "no"});
        }
    };

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779609#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#278" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="279"></a>
    <div class="content"><p>The content of the error will be serialized using the appropriate serializer.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779610#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#279" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h4><a name="deploying_your_dancer_applications"></a>Deploying your Dancer applications

</h4>








    <div class="para">
    <a name="281"></a>
    <div class="content"><p>For examples on deploying your Dancer applications (including standalone, behind
proxy/load-balancing software, and using common web servers including Apache to
run via CGI/FastCGI etc, see <a href="/perldoc?Dancer::Deployment">Dancer::Deployment</a>.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779612#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#281" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="dancer_on_the_stage%3a_deployment"></a>DANCER ON THE STAGE: DEPLOYMENT

</h3>








    <h4><a name="plack_middlewares"></a>Plack middlewares

</h4>








    <div class="para">
    <a name="286"></a>
    <div class="content"><p>If you deploy with Plack and use some Plack middlewares, you can enable them
directly from Dancer's configuration files.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779615#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#286" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="generic_middlewares"></a>Generic middlewares

</h5>








    <div class="para">
    <a name="288"></a>
    <div class="content"><p>To enable middlewares in Dancer, you just have to set the plack_middlewares
setting like the following:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779617#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#288" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="289"></a>
    <div class="content"><div><pre>    set plack_middlewares =&gt; [
        [ 'SomeMiddleware' =&gt; qw(some options for somemiddleware) ],
    ];

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779618#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#289" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="290"></a>
    <div class="content"><p>For instance, if you want to enable <a href="/perldoc?Plack::Middleware::Debug">Plack::Middleware::Debug</a> in your Dancer
application, all you have to do is to set <code>plack_middlewares</code> like that:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779619#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#290" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="291"></a>
    <div class="content"><div><pre>    set plack_middlewares =&gt; [
        [ 'Debug' =&gt; ( 'panels' =&gt; [qw(DBITrace Memory Timer)] ) ],
    ];

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779620#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#291" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="292"></a>
    <div class="content"><p>Of course, you can also put this configuration into your config.yml file, or
even in your environment configuration files:

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779621#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#292" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="293"></a>
    <div class="content"><div><pre>    # environments/development.yml
    ...
    plack_middlewares:
      -
        - Debug          # first element of the array is the name of the
<span class="line_cont">+</span> middleware
        - panels         # following elements are the configuration ofth
<span class="line_cont">+</span>e middleware
        -
            - DBITrace
            - Memory
            - Timer

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779622#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#293" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h5><a name="path%2dbased_middlewares"></a>Path-based middlewares

</h5>








    <div class="para">
    <a name="295"></a>
    <div class="content"><p>If you want to setup a middleware for a specific path, you can do that using
<code>plack_middlewares_map</code>. You'll need <a href="/perldoc?Plack::App::URLMap">Plack::App::URLMap</a> to do that.

</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779624#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#295" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <div class="para">
    <a name="296"></a>
    <div class="content"><div><pre>    plack_middlewares_map:
        '/':      ['Debug']
        '/timer': ['Timer'],

</pre>
</div></div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779625#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#296" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->








    <h3><a name="authors"></a>AUTHORS

</h3>








    <div class="para">
    <a name="298"></a>
    <div class="content"><p>Dancer contributors - see AUTHORS file.
</p>
</div>


    <div class="noteblock">
    

    
        <a href="/e/?mode=create;section=75779627#noteform" class="cb"><img src="/img/note.gif" alt="New Note" title="Create note"></a>
    <a class="purple" href="    /~YANICK/Dancer-1.3118/lib/Dancer/Cookbook.pod#298" title="Bookmarkable link to this paragraph">§</a>
    
    </div> <!-- noteblock -->
    </div> <!-- para -->






<p class="firstnote">(1 note; <a href="#note_2799" title="Last note">[last note]</a>)</p>


</div> <!-- pod2html -->

<script type="text/javascript" src="http://annocpan.oostendorp.net/perlmonkpivot.cgi?module=Dancer::Cookbook"></script>


<script type="text/javascript">
<!--
var el = document.createElement('div');
el.innerHTML = '<form action="/#" method="post" id="noteform" class="note hidden">    <a name="noteform"></a>    <input type="hidden" name="section" value="" />    <input type="hidden" name="notepos" value="" />    <div class="note_header">Edit note     <a href="/note_help" target="_blank" id="note_help_link">[help]</a>    </div>    <div id="note_text"><textarea name="note_text" rows="5" cols="20"></textarea></div>    <div id="note_buttons">    <button name="mode" value="save" id="save_button" title="Save note. The same text will apply to all versions of this document">Save</button>        <span id="edit_buttons">    <button name="mode" value="delete" id="del_button" title="This will delete the note from all versions of this document">Delete</button>    <button name="mode" value="hide" id="hide_button" title="This will hide this note for this version of this document only">Hide</button>    </span>        </div></form>';
document.getElementById('nav').appendChild(el);

var el2 = document.createElement('div');
el2.id = 'plswait';
el2.style.display = 'none';
el2.innerHTML = 'Saving note... please wait';
document.getElementById('nav').appendChild(el2);
// -->
</script>
<!-- podver=1452763 -->
</div> <!-- content -->
<div id="footer">

<a href="http://pair.com/"><img class="sponsor" src="/img/pair.png" alt=""></a>

<span class="sponsor">Server and bandwidth generously donated 
by <a href="http://pair.com/">pair Networks</a></span> 

<a href="/policy">Site policies</a> 
| <a href="/contact">Contact</a>
| <strong><a
href="http://rt.cpan.org/NoAuth/Bugs.html?Dist=AnnoCPAN">Bugs & Features</a></strong>

</div>
</body>
</html>


