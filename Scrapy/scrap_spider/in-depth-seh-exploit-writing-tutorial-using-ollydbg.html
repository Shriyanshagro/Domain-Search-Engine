<div class='ig_inline_container ig_loop_start ig_before'></div><!doctype html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns#">
  
  <head>
    <meta charset="UTF-8" />

<meta name="description" content="IT Security Training &amp; Resources by InfoSec Institute">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var o=t[n]={exports:{}};e[n][0].call(o.exports,function(t){var o=e[n][1][t];return r(o||t)},o,o.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){function r(e,t){return function(){o(e,[(new Date).getTime()].concat(a(arguments)),null,t)}}var o=e("handle"),i=e(2),a=e(3);"undefined"==typeof window.newrelic&&(newrelic=NREUM);var u=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit"],c=["addPageAction"],f="api-";i(u,function(e,t){newrelic[t]=r(f+t,"api")}),i(c,function(e,t){newrelic[t]=r(f+t)}),t.exports=newrelic,newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),o("err",[e,(new Date).getTime()])}},{}],2:[function(e,t,n){function r(e,t){var n=[],r="",i=0;for(r in e)o.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],3:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(0>o?0:o);++r<o;)i[r]=e[t+r];return i}t.exports=r},{}],ee:[function(e,t,n){function r(){}function o(e){function t(e){return e&&e instanceof r?e:e?u(e,a,i):i()}function n(n,r,o){e&&e(n,r,o);for(var i=t(o),a=l(n),u=a.length,c=0;u>c;c++)a[c].apply(i,r);var s=f[g[n]];return s&&s.push([m,n,r,i]),i}function p(e,t){w[e]=l(e).concat(t)}function l(e){return w[e]||[]}function d(e){return s[e]=s[e]||o(n)}function v(e,t){c(e,function(e,n){t=t||"feature",g[n]=t,t in f||(f[t]=[])})}var w={},g={},m={on:p,emit:n,get:d,listeners:l,context:t,buffer:v};return m}function i(){return new r}var a="nr@context",u=e("gos"),c=e(2),f={},s={},p=t.exports=o();p.backlog=f},{}],gos:[function(e,t,n){function r(e,t,n){if(o.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){o.buffer([e],r),o.emit(e,t,n)}var o=e("ee").get("handle");t.exports=r,r.ee=o},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!w++){var e=v.info=NREUM.info,t=s.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&t){c(l,function(t,n){e[t]||(e[t]=n)});var n="https"===p.split(":")[0]||e.sslForHttp;v.proto=n?"https://":"http://",u("mark",["onload",a()],null,"api");var r=s.createElement("script");r.src=v.proto+e.agent,t.parentNode.insertBefore(r,t)}}}function o(){"complete"===s.readyState&&i()}function i(){u("mark",["domContent",a()],null,"api")}function a(){return(new Date).getTime()}var u=e("handle"),c=e(2),f=window,s=f.document;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:f.XMLHttpRequest,REQ:f.Request,EV:f.Event,PR:f.Promise,MO:f.MutationObserver},e(1);var p=""+location,l={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-918.min.js"},d=window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent),v=t.exports={offset:a(),origin:p,features:{},xhrWrappable:d};s.addEventListener?(s.addEventListener("DOMContentLoaded",i,!1),f.addEventListener("load",r,!1)):(s.attachEvent("onreadystatechange",o),f.attachEvent("onload",r)),u("mark",["firstbyte",a()],null,"api");var w=0},{}]},{},["loader"]);</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/style.css" />
<link rel="pingback" href="http://resources.infosecinstitute.com/xmlrpc.php" />
<script>var ajaxUrl = 'http://resources.infosecinstitute.com/wp-admin/admin-ajax.php';</script>

<!-- This site is optimized with the Yoast SEO plugin v2.3.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Tricks for Exploit Development - InfoSec Resources</title>
<meta name="description" content="This is the second article in a series about using the OllyDbg, a 32 bit assembler level analyzing user mode debugger for Windows. In part one of this tuto"/>
<link rel="canonical" href="http://resources.infosecinstitute.com/in-depth-seh-exploit-writing-tutorial-using-ollydbg/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Tricks for Exploit Development - InfoSec Resources" />
<meta property="og:description" content="This is the second article in a series about using the OllyDbg, a 32 bit assembler level analyzing user mode debugger for Windows. In part one of this tuto" />
<meta property="og:url" content="http://resources.infosecinstitute.com/in-depth-seh-exploit-writing-tutorial-using-ollydbg/" />
<meta property="og:site_name" content="InfoSec Resources" />
<meta property="article:section" content="Exploit Development" />
<meta property="article:published_time" content="2011-02-28T19:49:48+00:00" />
<meta property="article:modified_time" content="2015-04-28T09:56:38+00:00" />
<meta property="og:updated_time" content="2015-04-28T09:56:38+00:00" />
<meta property="og:image" content="http://resources.infosecinstitute.com/wp-content/uploads/ollydbg2.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="InfoSec Resources &raquo; Tricks for Exploit Development Comments Feed" href="http://resources.infosecinstitute.com/in-depth-seh-exploit-writing-tutorial-using-ollydbg/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/resources.infosecinstitute.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.3"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='cptch_stylesheet-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/captcha/css/style.css?ver=4.3.3' type='text/css' media='all' />
<link rel='stylesheet' id='wpjb-glyphs-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/wpjobboard/public/css/wpjb-glyphs.css?ver=4.3.3' type='text/css' media='all' />
<link rel='stylesheet' id='wpjb-css-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/wpjobboard/public/css/frontend.css?ver=4.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='enlighter-local-css'  href='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/enlighter/resources/EnlighterJS.min.css?ver=4.3.3' type='text/css' media='all' />
<!-- This site uses the Google Analytics by Yoast plugin v5.4.4 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-146509-8', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('require', 'displayfeatures');
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/js/vendor/modernizr.min.js'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/js/vendor/device.min.js'></script>
<script type='text/javascript' src='//ajax.googleapis.com/ajax/libs/mootools/1.5.1/mootools-yui-compressed.js?ver=4.3.3'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/enlighter/resources/EnlighterJS.min.js?ver=4.3.3'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://resources.infosecinstitute.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://resources.infosecinstitute.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='http://resources.infosecinstitute.com/?p=582' />
<script type="text/javascript">/* <![CDATA[ */window.addEvent('domready', function(){if (typeof EnlighterJS == "undefined"){return;};EnlighterJS.Util.Init('pre.EnlighterJSRAW', 'code.EnlighterJSRAW', {"language":"standard","theme":"git","indent":-1,"hover":"hoverEnabled","showLinenumbers":true,"rawButton":true,"infoButton":true,"windowButton":true,"rawcodeDoubleclick":false,"grouping":true,"cryptex":{"enabled":true,"email":"mail@example.tld"}});});/* ]]> */</script>
<style type="text/css" id="syntaxhighlighteranchor"></style>
  </head>

  <body class="single single-post postid-582 single-format-standard with-series">
    
    <div id="fb-root"></div>
    
          <header class="masthead">
  
  <div>
    <div class="col-3-3">
      
      <nav class="top-left">
        <ul>
                      <li>
  <a href="http://infosecinstitute.com">InfoSec Institute</a>
      <ul>
              <li>
          <a href="http://www.infosecinstitute.com/courses/security.html">IT Security Boot Camps</a>
        </li>
              <li>
          <a href="http://www.infosecinstitute.com/infosec_institute/contact_us.html">Contact InfoSec</a>
        </li>
              <li>
          <a href="http://www.infosecinstitute.com/enterprise-wide-training2.html">Enterprise & Government</a>
        </li>
          </ul>
  </li>                      <li>
  <a href="http://www.intenseschool.com">Intense School</a>
  </li>                      <li>
  <a href="http://certs.infosecinstitute.com/">Certification Tracker</a>
  </li>                  </ul>
      </nav>
      
      <nav class="top-right">
        <ul>
                  </ul>
      </nav>
      
    </div>
  </div>
  
  <div>
    <div class="col-3-3">
      
              
        <div class="logo">
          <a href="http://resources.infosecinstitute.com">
            <img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/assets/imagery/logo.svg" alt="InfoSec Resources" title="InfoSec Resources" width="126">
          </a>
        </div>
          
            
      <a class="menu-button mobile" href="#site-navigation" data-attr="main:toggle">Menu</a>

      <nav class="main" id="site-navigation">
        
        <a class="mobile" href="#" data-attr="main:remove" aria-hidden="true">Close Menu</a>
        <a class="mobile" href="#" data-attr="topics:remove" aria-hidden="true">Back</a>
        <a class="mobile" href="#" data-attr="content-archives:remove" aria-hidden="true">Back</a>
      
        <ul>
          <li class="mobile menu-item menu-item-type-custom menu-item-object-custom menu-item-4748"><a href="http://infosec.wpengine.com">Return Home</a></li><li class="has-dropdown  menu-item menu-item-type-custom menu-item-object-custom menu-item-4750 menu-item-has-children"><a href="" data-attr="topics:set">Topics</a><ul data-menu-container="topics"><li><a href="http://resources.infosecinstitute.com/category/hacking-2/" title="Hacking">
                          Hacking
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/certifications-training/" title="IT Certifications">
                          IT Certifications
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/forensics-2/" title="Forensics">
                          Forensics
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/application-security-2/" title="Secure Coding">
                          Secure Coding
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/pen-testing-1/" title="Penetration Testing">
                          Penetration Testing
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/general-security-2/" title="General Security">
                          General Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/cloud-computing/" title="Cloud Computing">
                          Cloud Computing
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/interviews/" title="Interviews">
                          Interviews
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/virtualization-security/" title="Virtualization Security">
                          Virtualization Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/wireless-security/" title="Wireless Security">
                          Wireless Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/scada-2/" title="SCADA / ICS Security">
                          SCADA / ICS Security
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/reverse-engineering-2/" title="Reverse Engineering">
                          Reverse Engineering
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/data-recovery/" title="Data Recovery">
                          Data Recovery
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/exploit-development/" title="Exploit Development">
                          Exploit Development
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/compliance-auditing/" title="Management, Compliance, & Auditing">
                          Management, Compliance, & Auditing
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/incident-response-resources/" title="Incident Response">
                          Incident Response
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/certifications-training/" title="IT Certifications">
                          IT Certifications
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/certifications-training/securityplus/" title="Security+">
                          Security+
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/security-awareness/" title="Security Awareness">
                          Security Awareness
                        </a></li><li><a href="http://resources.infosecinstitute.com/category/phishing/" title="Phishing">
                          Phishing
                        </a></li></ul></li><li class=" menu-item menu-item-type-post_type menu-item-object-page menu-item-4758"><a href="http://resources.infosecinstitute.com/contributors/">Contributors</a></li><li class="has-dropdown desktop menu-item menu-item-type-custom menu-item-object-custom menu-item-30046 menu-item-has-children"><a href="#" data-attr="archive:set">Archive</a><ul data-menu-container="archive"><li><a href="http://resources.infosecinstitute.com/2015/" title="2015">
                          2015
                        </a></li><li><a href="http://resources.infosecinstitute.com/2014/" title="2014">
                          2014
                        </a></li><li><a href="http://resources.infosecinstitute.com/2013/" title="2013">
                          2013
                        </a></li><li><a href="http://resources.infosecinstitute.com/2012" title="2012">
                          2012
                        </a></li><li><a href="http://resources.infosecinstitute.com/2011" title="2011">
                          2011
                        </a></li><li><a href="http://resources.infosecinstitute.com/2010" title="2010">
                          2010
                        </a></li></ul></li><li class="mobile menu-item menu-item-type-custom menu-item-object-custom menu-item-30121"><a href="http://resources.infosecinstitute.com/2015">Archive</a></li><li class=" menu-item menu-item-type-post_type menu-item-object-page menu-item-32427"><a href="http://resources.infosecinstitute.com/job-titles/">Careers</a></li><li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-32598"><a href="https://securityiq.infosecinstitute.com">Phish.io</a></li>          
        </ul>
      </nav>
      
      <nav class="search">
        <form class="search-form" action="http://www2.infosecinstitute.com/s/12882/ntpoCCBNQ1ttbNTP3ylPLZZeUqLrVgCT" method="get">
  <fieldset>
    <input type="text" name="s" class="icon search" id="search" value="">
    <input type="submit" class="icon search" title="Search">
  </fieldset>
</form>
      </nav>
      
    </div>
  </div>
  
</header>          
    <main>
      
      <section class="hero full">
          
  <div class="col-3-3 wrapper hook" style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//ollydbg2-980x0-c-default.jpg');">
  
    <header>
      <h2>OllyDbg - Part 2</h2>
      <h1>Tricks for Exploit Development</h1>
          </header>
    
    <nav class="jump">
  
  <label>Jump to</label>
  
  <div class="dropdown">
    
    <span data-trigger>Select post section</span>
    
    <ul>
                        <li>
            <a href="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development/#article">Part 1 - Debugging Fundamentals for Exploit Development</a>
          </li>
                                <li class="current">Part 2 - Tricks for Exploit Development</li>
                  </ul>
    
    <select>
                        <option value="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development/#article">Part 1 - Debugging Fundamentals for Exploit Development</option>
                                <option selected>Part 2 - Tricks for Exploit Development</option>
                  </select>
    
  </div>
  
</nav>    
    <div class="share vertical">

  <ul>
    
    <li class="twitter">
      <a class="twitter-share-button"
        href="https://twitter.com/share"
        data-size="medium"
        data-url="http://resources.infosecinstitute.com/in-depth-seh-exploit-writing-tutorial-using-ollydbg/"
        data-count-url="http://resources.infosecinstitute.com/in-depth-seh-exploit-writing-tutorial-using-ollydbg/"
        data-count="vertical"
        data-via="InfosecEdu"
        data-related="infosecedu"
        data-hashtags="infosec"
        data-text="Tricks for Exploit Development">
      Tweet
      </a>
    </li>
    
    <li class="google">
      <div class="g-plus"
        data-action="share"
        data-annotation="vertical-bubble">
      </div>
    </li>
    
    <li class="linkedin">
      <script type="IN/Share" data-counter="top"></script>
    </li>
    
    <li class="reddit">
      <script type="text/javascript" src="//www.redditstatic.com/button/button2.js"></script>
    </li>
    
    <li class="facebook">
      <div class="fb-like"
        data-width="90"
        data-layout="box_count"
        data-action="like"
        data-show-faces="false"
        data-share="false"
      ></div>
    </li>
    
  </ul>

</div>    
  </div>
  
      </section>
      
      <section class="content full">
        <div class="col-3-3 wrapper">
                      
  <div class="main post-col-3-3">
    
    <article class="post-content">
      <div id="article"></div>
      <div class='ig_inline_container ig_the_content ig_before'></div><p>This is the second article in a series about using the OllyDbg, a 32 bit assembler level analyzing user mode debugger for Windows.</p>
<p>In <a href="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development">part one of this tutorial </a>we covered:</p>
<ul>
<li><a href="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development#starting">Starting the Debugger</a></li>
<li><a href="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development#opening">Opening and Attaching to the debugging target application</a></li>
<li><a href="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development#cpuview">The OllyDbg CPU view</a></li>
<li><a href="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development#x86">The 20 second guide to X86 Assembly language for exploit writers</a></li>
</ul>
<p>In this article we will cover the following subjects:</p>
<ul>
<li><a href="#codeexecution">Methods for directing code execution in the debugger</a></li>
<li><a href="#sehchain">The SEH chain</a></li>
<li><a href="#commands">Searching for commands</a></li>
<li><a href="#memory">Searching through memory</a></li>
<li><a href="#memorydump">Working in the memory dump</a></li>
<li><a href="#editing">Editing code, memory and registers</a></li>
<li><a href="#relative">Help in calculating relative address differences</a></li>
<li><a href="#plugins">Plugins</a></li>
</ul>
<p><span style="font-size: 14pt;"><strong><a id="codeexecution" name="codeexecution"></a>Methods for directing code execution in the debugger<br />
</strong></span></p>
<p>When you are writing an exploit you are going to need to be able to execute the code in your target application in a variety of different ways, to give you the appropriate amount of control to monitor the code and memory closely when needed. You may want to run normally at one point, to go step by step through each individual instruction at another, and sometimes to have it run quickly to a particular point allowing you to take control once that point is reached.</p>
<p>Luckily, this is all possible via the use of a debugger by using breakpoints as well as the various methods for stepping through code.</p>
<p><span class="pardot-title">Ethical Hacking Training &#8211; Resources (InfoSec)</span><iframe class="pardotform" src="http://www2.infosecinstitute.com/l/12882/2015-01-21/dt6gm" width="100%" height="500" type="text/html" frameborder="0" allowTransparency="true" style="border: 0"></iframe></p>
<p>This section has been broken up into the following subsections:</p>
<ul>
<li>Step in, Step over</li>
<li>Where did I come from? Exposing your history</li>
<li>Animation</li>
<li>Setting breakpoints</li>
<li>Running the code</li>
<li>Exception-al debugging</li>
<li>
<div>Run tracing to find the cause of an exception</div>
</li>
</ul>
<p><span style="font-size: 12pt;"><strong><em>Step in, Step over<br />
</em></strong></span></p>
<p>Let&#8217;s start by learning how to step through code. If you haven&#8217;t already, start up OllyDbg and open vulnserver.exe. Execution should automatically pause at the program entry point. In the top left hand pane of the CPU view you should see the instruction &#8220;PUSH EBP&#8221; highlighted.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE1.png" alt="" /></p>
<p>Take note of the top entry on the stack (bottom right hand pane) as well as the value of the ESP and EBP registers in the top right hand pane, then try hitting the <strong>F8</strong> key, just once. The F8 key is a shortcut key for the &#8220;Step over&#8221; operation, which allows you to advance forward one instruction, while NOT following any function calls.</p>
<p>The significance of that will become clear in a moment, but for now, you should have noticed that since executing that PUSH EBP instruction, the value held by EBP has been added to the top of the stack and the value of the ESP register has decreased by four. In addition, the instruction following &#8220;PUSH EBP&#8221; in the top left hand pane, namely &#8220;MOV EBP, ESP&#8221;, should now be highlighted, and two registers, ESP and EIP have their values highlighted in red to indicate that they have changed.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE2.png" alt="" /></p>
<p>Take note of the values of the EBP and ESP registers, and hit <strong>F8</strong> once more. The EBP register will change to match that of the ESP register, and the EBP and EIP registers values will be highlighted in red. What this red highlighting of values is indicating is that this particular value changed during the last operation.</p>
<p>Press <strong>F8</strong> two more times until the &#8220;CALL DWORD PTR DS:[&lt;&amp;msvcrt.__set_app_type&gt;]&#8221; instruction is highlighted. Now press <strong>F8</strong> once more and execution should advance to the following instruction of &#8220;CALL vulnserv.00401020&#8221;.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE3.png" alt="" /></p>
<p>What happened here? We just ran a CALL instruction, which is intended to be used to temporarily redirect code execution to another location within the programs memory space, yet the debugger didn&#8217;t move to this new section of code, as we might have expected it to do. What actually happened here is that the <strong>F8</strong> or &#8220;Step over&#8221; key, indeed &#8220;stepped over&#8221; this CALL instruction. It ran the code specified by this CALL instruction and paused the program in the debugger once more after it was done and execution had returned to the instruction immediately after the CALL. So what do we do if we want to actually follow the debugger into the code specified by one of these CALL statements?</p>
<p>We use the &#8220;Step into&#8221; command, which uses <strong>F7</strong> as its shortcut key. Use the <strong>F7</strong> key now, with your debugger selecting the instruction &#8220;CALL vulnserv.00401020&#8221;, and see what happens. The debugger will follow through to the instruction in vulnserver at the memory address 00401020, and will then pause. You can now follow along with the code referenced by that CALL instruction.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE4.png" alt="" /></p>
<p>So the difference between the &#8220;Step over&#8221; and &#8220;Step into&#8221; commands is that one steps over CALL statements (preventing you from having to go through the code there if you don&#8217;t want to) and the other steps into them, allowing the &#8220;CALL&#8221;ed code to be viewed.</p>
<p><span style="font-size: 12pt;"><strong><em>Where did I come from? Exposing your history<br />
</em></strong></span></p>
<p>OllyDbg keeps a history of the last 1000 commands that were displayed in the CPU window, so if you have stepped into a CALL statement, or followed a JMP and you want to remind yourself of the previous code location, you can use the plus (<strong>+</strong>) and minus (<strong>&#8211;</strong>) keys to navigate through the history. Try the minus key now, the CPU view should then display the CALL instruction that you just executed. Use the plus key to come back to the current instruction.</p>
<p>Note that this little trick only allows you to view instructions that have actually been displayed and tracked in the debugger. You can&#8217;t let the program run, generate a crash and then use the minus key to check the instruction just before the crash occurred, nor can you let your program run until it hits a breakpoint and then step back from there. If this type of functionality interests you, you can use the Run trace capabilities of OllyDbg, which I will cover later in this section.</p>
<p><span style="font-size: 12pt;"><strong><em>Animation<br />
</em></strong></span></p>
<p>If you want to step through your code in a controlled fashion, but don&#8217;t like the thought of having to hammer quickly at the <strong>F7</strong> or <strong>F8</strong> buttons, you can take advantage of OllyDbg&#8217;s animation capabilities. Press <strong>Ctrl-F7</strong> for &#8220;Step into&#8221; animation and <strong>Ctrl-F8</strong> for &#8220;Step out&#8221; animation. This will step through the code rather quickly, allowing you to pause once more by hitting the <strong>Esc</strong> key. You can then use plus (<strong>+</strong>) and minus (<strong>&#8211;</strong>) keys to step through the history of your animated session. Try hitting <strong>Ctrl-F7</strong> now to do some step in animation, and then hit <strong>Esc</strong> when you are done. Now use the plus (<strong>+</strong>) and minus (<strong>&#8211;</strong>) keys to navigate through your execution history for a bit, until you are comfortable with how this works.</p>
<p><span style="font-size: 12pt;"><strong><em>Setting breakpoints<br />
</em></strong></span></p>
<p>Up until now we have maintained more or less manual control over how the program is executed, with us having to either approve each instruction in advance, or having to let the instructions run in a semi-automated fashion with us hitting Esc (hopefully at the right time) when we want the program to stop.</p>
<p>What if we want to stop the program at a particular point in the middle of its execution though? The step by step method will be too slow (there are a lot of instructions in even the simplest program), and the animation method will be too imprecise. Well, to allow us to stop at a point of our choosing, we can use breakpoints, which are essentially markers on particular instructions in the code that tell the debugger to pause execution when one of those instructions are about to be executed by the CPU.</p>
<p>Let&#8217;s try setting one now. First of all, use the <strong>View-&gt;Executable modules</strong> menu option to bring up a list of executable modules loaded with vulnserver.exe. Double click on the vulnserv entry to open this view in the CPU window (we are doing this because it&#8217;s possible that our previous animation session brought another module to the fore). Now right click in the top left hand pane of the CPU view and select <strong>Search for-&gt;All referenced text strings</strong>. See the following screen shot.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE5.png" alt="" /></p>
<p>Double click on the entry that has the text &#8220;Welcome to Vulnerable Server! Enter HELP for help.&#8221; to go to the related instruction in the CPU view (see the selected entry in the screenshot above). Now, with this instruction highlighted in the CPU View, hit the <strong>F2</strong> key, which is used to both set and clear breakpoints. If you open the <strong>View-&gt;Breakpoints</strong> menu option, or hit <strong>Alt-B</strong>, you should now also see your breakpoint listed in the Breakpoints view.</p>
<p>You will note that the memory address for that instruction will be highlighted in red in the top left pane of the CPU View. So, a breakpoint has been set, now let&#8217;s see how we can trigger it, as well as how we can let code run normally in the debugger.</p>
<p><strong>Note:</strong> When you reach the point in your exploit writing process where you are inserting your own code into the program (e.g. when using shellcode in an exploit you are writing, or even when you are writing your own shellcode) you can alternatively use the opcode &#8220;\xCC&#8221; to insert your own breakpoints directly into the code. We will look at how this is used in more detail in a later section.</p>
<p><span style="font-size: 12pt;"><strong><em>Running the code<br />
</em></strong></span></p>
<p>To allow code to run within the debugger, hit the <strong>F9</strong> or Run key. The program will now essentially run normally, until either a breakpoint is hit or an exception occurs. (Strictly speaking, you can manually pause the program in the debugger too, but that&#8217;s often not particularly useful.)</p>
<p>Generally, when you want to interact with a program in a normal way while you are debugging it, for example if you want to send data to a program to cause an exception, the <strong>F9</strong> Run option is what you need to use to allow that to happen.</p>
<p>Now that our program is running normally within the debugger, let&#8217;s try and trigger our breakpoint. In this case, we have set a breakpoint on the instruction that references a text block that is displayed by vulnserver in response to a connection from a client, so in order to hit the breakpoint, we need to initiate a client connection. Since we are currently in Run mode, the program will operate as normal within the debugger until the code referenced by the breakpoint is about to be executed.</p>
<p>Save the following into a file basicclient.pl.</p>
<p style="margin-left: 28pt;"><code>#!/usr/bin/perl<br />
use IO::Socket;<br />
if ($ARGV[1] eq '') {<br />
die("Usage: $0 IP_ADDRESS PORT\n\n");<br />
}<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket = IO::Socket::INET-&gt;new( # setup TCP socket – $socket<br />
Proto =&gt; "tcp",<br />
PeerAddr =&gt; "$ARGV[0]", # command line variable 1 – IP Address<br />
PeerPort =&gt; "$ARGV[1]" # command line variable 2 – TCP port<br />
) or die "Cannot connect to $ARGV[0]:$ARGV[1]";<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket-&gt;recv($sd, 1024); # Receive 1024 bytes data from $socket, store in $sd<br />
print $sd;<br />
</code></p>
<p>Now, run the script, feeding the script the appropriate IP address and TCP port number for vulnserver.exe as shown below.</p>
<p style="margin-left: 28pt;"><code>C:\_Work&gt;perl basicclient.pl 127.0.0.1 9999<br />
</code></p>
<p>Your code should now stop at your configured breakpoint, allowing you to take control of execution once more, so you can step through future code. Hit <strong>F2</strong> again to clear the breakpoint, and then <strong>F9</strong> to start the program running once more.</p>
<p>I mentioned at the start of this section that a program that is let to run will only stop when a breakpoint is hit or an exception occurs. Let&#8217;s try causing an exception next, to see how the program reacts.</p>
<p><span style="font-size: 12pt;"><strong><em>Exception-al debugging<br />
</em></strong></span></p>
<p>When an exception occurs in a running program in a debugger, the debugger will halt execution and allow you to view the state of the CPU and memory inside the program at the time the exception occurred. This is exactly the kind of information we need to see if we want to be able to write a reliable exploit for the given vulnerability.</p>
<p>To trigger an exception, I am going to make use of a vulnerability in vulnserver.exe. If you wish to find out how the vulnerability was discovered, you can visit the following links:</p>
<p><a href="http://resources.infosecinstitute.com/intro-to-fuzzing/">http://resources.infosecinstitute.com/intro-to-fuzzing/</a></p>
<p><a href="http://resources.infosecinstitute.com/fuzzer-automation-with-spike/">http://resources.infosecinstitute.com/fuzzer-automation-with-spike/</a></p>
<p>The following code will cause an exception in vulnserver.exe. Save as trun.pl</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"><code>#!/usr/bin/perl
 use IO::Socket;
 if ($ARGV[1] eq '') {
 die("Usage: $0 IP_ADDRESS PORT\n\n");
 }
 </code></pre>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"><code>$baddata = "TRUN ."; # sets variable $baddata to "TRUN ."
 $baddata .= "A" x 5000; # appends (.=) 5000 "A" characters to $baddata
 </code></pre>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"><code>$socket = IO::Socket::INET-&gt;new( # setup TCP socket – $socket
 Proto =&gt; "tcp",
 PeerAddr =&gt; "$ARGV[0]", # command line variable 1 – IP Address
 PeerPort =&gt; "$ARGV[1]" # command line variable 2 – TCP port
 ) or die "Cannot connect to $ARGV[0]:$ARGV[1]";
 </code></pre>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"><code>$socket-&gt;recv($sd, 1024); # Receive 1024 bytes data from $socket, store in $sd
 print "$sd"; # print $sd variable
 $socket-&gt;send($baddata); # send $baddata variable via $socket
 </code></pre>
<p>Run the script as follows (ensure you provide the correct IP address and port number if you are not running this from the same host running vulnserver.exe).</p>
<p style="margin-left: 28pt;"><code>C:\_Work&gt;perl trun.pl 127.0.0.1 9999<br />
</code></p>
<p>If everything goes according to plan, your debugger should stop, with the screen looking like the screenshot below. If this does not work, restart vulnserver.exe in the debugger (<strong>Debug-&gt;Restart</strong> menu option), hit <strong>F9</strong> to let the program run, and try again.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE6.png" alt="" /></p>
<p>The text in the bottom left hand corner of the screen shows the following.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE7.png" alt="" /></p>
<p>And the register values are as follows. Note the value of the EIP register.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE8.png" alt="" /></p>
<p>This is how the debugger will behave when an exception occurs. You will note that you can see CPU register values, as well as stack and memory data, as it looks at the time of the crash. You can&#8217;t however, see the instructions that the CPU was attempting to execute, because the Instruction pointer (EIP) is pointing to a memory address that does not appear to contain any code (41414141). Hmmmmm&#8230;.</p>
<p>At this point, you could use <strong>Shift+F7/F8/F9</strong> to pass the exception to the program to handle, but let&#8217;s not do that right now (we will try this in an upcoming section focusing on the SEH Chain).</p>
<p><span style="font-size: 12pt;"><strong><em>Run tracing to find the cause of an exception<br />
</em></strong></span></p>
<p>We have now seen how an exception looks when hit within a debugger, but we still haven&#8217;t seen how we can identify the particular section of code where the exception occurs. To do this, we can use the Run trace functionality of OllyDbg.</p>
<p>Run tracing essentially allows us to log instructions that are performed by the debugger, so that when an event such as an exception occurs we will have a command history that we can look back through to find out how it happened.</p>
<p>While this is undoubtedly a great feature, there are some caveats to using it – mainly that it&#8217;s much slower than just running code normally and it can use a lot of memory if you leave it running for too long. Consequently, if we want to use Run trace to efficiently identify the cause of an exception, we should attempt to get code execution as close to the point of the crash as we reasonably can before we turn it on.</p>
<p>Let&#8217;s see if we can use Run trace to find the code that leads to the exception examined in the previous section.</p>
<p>By examining the trun.pl script that we used to create the exception, we see that the data we are sending to the application is a string beginning with the text &#8220;TRUN&#8221;. The appropriate line from the script that sets this string is shown below. (The entire script is provided in the previous section).</p>
<p style="margin-left: 28pt;"><code>$baddata = "TRUN ."; # sets variable $baddata to "TRUN ."<br />
</code></p>
<p>Let&#8217;s have a look in the debugger to see if we can find references to this string, as such references may indicate code segments that deal with this particular data. If we find any such references, this will hopefully provide us with a good area from which to start our Run trace.</p>
<p>Restart vulnserver.exe in the debugger, and hit <strong>F9</strong> to let the program run. Now, right click in the disassembler pane and select the <strong>Search for-&gt;All referenced text strings</strong> option. This function essentially searches for any and all references to text strings within the code.</p>
<p>In the Text strings window that appears, about midway down you should see a reference to an ASCII text string &#8220;TRUN &#8220;. See the screenshot below, where I have selected this particular entry. Although this particular instruction may not necessarily be placed immediately before code that will create the exception we viewed in the previous section, it seems like a good place to start looking. We will set a breakpoint at this location in the code and see if that breakpoint is hit before the exception occurs. This would indicate that the marked instruction is located at an earlier point in the execution path than the code associated with the exception, and may be a good place to start our Run trace from. If the breakpoint is not hit, we can keep looking through the code to see if we can identify some other position from which it might be suitable to start our Run trace.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE9.png" alt="" /></p>
<p>Double click on the &#8220;TRUN&#8221; entry in the Text strings window to be taken to the corresponding instruction in the disassembler pane. Now hit <strong>F2</strong> to set a breakpoint on this location. The address should turn red, as shown below.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE10.png" alt="" /></p>
<p>Now we are almost ready to start a Run trace to see if we can identify which instructions lead up to our exception. The program is running normally in the debugger, with a breakpoint (hopefully) set at a point somewhere in the code not too far before the exception occurs. If everything goes to plan, code execution should pause at this breakpoint when we use the trun.pl script to generate the exception, and this should then allow us to start a Run trace which will identify the instructions that lead up to our exception.</p>
<p>Before we try this though, we will tweak the Run trace options just a little in order to make the Run trace process slightly more efficient. Open the <strong>Options</strong> menu, select the <strong>Debugging options</strong> item, and hit the <strong>Trace</strong> tab. Enable the <strong>Always trace over system DLLs</strong> and <strong>Always trace over string commands</strong> options and hit <strong>OK</strong>. See the screenshot below.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE11.png" alt="" /></p>
<p>This will prevent our debugger from stepping into system routines and string commands, which in many cases is not needed and will just clutter our Run trace log unnecessarily.</p>
<p>Now run the trun.pl script to generate the exception.</p>
<p style="margin-left: 28pt;"><code>C:\_Work&gt;perl trun.pl 127.0.0.1 9999<br />
</code></p>
<p>Execution should pause at our breakpoint. Success! Now let&#8217;s start a Run trace. These can be initiated by using the <strong>Ctrl-F11</strong> key for a step into Run trace, or <strong>Ctrl-F12</strong> for a step over Run trace. As with the other debugger code execution methods, step into means to follow code within CALL statements, and step over means to execute over them.</p>
<p>Press <strong>Ctrl-F11</strong> to execute a step into Run trace. You should be greeted very quickly by the following popup, indicating that the exception has been reached. The speed at which this has occurred suggests that the location for our breakpoint has been well chosen – we have discovered the code that leads up to the exception but we haven&#8217;t been left waiting for an extended period of time while the trace ran.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE12.png" alt="" /></p>
<p>Hit <strong>OK</strong> in the popup to dismiss it. Now, to actually see the contents of the Run trace log, open the <strong>View</strong> menu, and select <strong>Run trace</strong>. You should see something like the following, showing the exception at the bottom of the window (entry 0), with all of the other instructions since the Run trace started listed from bottom to top in order of most to least recently executed.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE13.png" alt="" /></p>
<p>At this point, if you wanted to examine the cause of the exception in more detail, you now know exactly what leads up to it. You have the option of taking the address of any of the instructions above, setting a breakpoint at that location, retriggering the exception and then stepping through the code to see exactly how the exception occurred.</p>
<p>Remember, if you want to use Run trace to effectively find exception prone code, place a breakpoint as near as possible to the point where you think the exception occurs (some trial and error may be involved in getting the breakpoint in the right place), then trigger the exception and Run trace from the breakpoint.</p>
<p>Before you proceed, clean up the breakpoint you added in this section. Open the <strong>View</strong> menu and select <strong>Breakpoints</strong> or hit <strong>Alt-B</strong> to open the Breakpoints window, and use the <strong>Delete</strong> key to remove any existing breakpoints listed.</p>
<p><a name="sehchain"></a><span style="font-size: 14pt;"><strong>The SEH Chain<br />
</strong></span></p>
<p>&#8220;What is the SEH Chain?&#8221; I hear you ask. It&#8217;s essentially a per-thread structure in memory that provides a linked list of error handler addresses that can be used by Windows programs to gracefully deal with exceptions, like the one we generated in the previous section.</p>
<p>Once an exception is detected within a program, Windows will attempt to manage that exception by using the error handling routines in Windows to select an error handler from the SEH Chain. That error handler will be a memory address that contains code that will do something useful, like throw up an error dialog box to indicate that the program has crashed. Entries in this SEH Chain are stored on the stack.</p>
<p>We can look at the SEH address in one of two ways &#8211; we can scroll through the stack pane in OllyDbg until we see the &#8220;SE handler&#8221; text next to a stack entry, or we can use the <strong>View -&gt;SEH chain</strong> menu option.</p>
<p>To find the entry on the stack, you can generally just scroll down to the very bottom of the stack pane in OllyDbg, as this is likely where the Operating System supplied SEH chain entry will be located. Using the &#8220;SEH chain&#8221; menu option will show you all entries in the SEH chain if there is more than one.</p>
<p>Why, as exploit writers, do we care what the SEH chain contains? We care because the SEH chain contains addresses where code execution is redirected once an error occurs, allowing us to use any exception as an opportunity to redirect code execution to a location of our choice by overwriting these SEH entries with our own provided values. Since these entries in the chain are stored on the stack, they are ideally placed in order to be overwritten by a stack based overflow.</p>
<p>There are some caveats you need to be aware of when writing SEH exploits, but this is something I will go into in more detail in a future tutorial, for now we will just cover how to use the debugger to determine if an SEH overwrite has occurred.</p>
<p>If you haven&#8217;t already, restart the program in the debugger and hit <strong>F9</strong> to get it running. Now execute the trun.pl script created in the &#8220;Exception-al debugging&#8221; component of the previous section to get the exception back into the debugger, and view the SEH handlers, by using the stack and <strong>View</strong>-&gt;<strong>SEH chain</strong> methods.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE14.png" alt="" /></p>
<p>What you should see now is an intact SEH chain &#8211; one that hasn&#8217;t been overwritten. You can tell this because the handler address is a valid one within ntdll (from the SEH chain window – see screenshot above) and because the SEH entry near the bottom of the stack is preceded by an entry with the data FFFFFFFF (this stack entry should be marked as &#8220;Pointer to next SEH record&#8221;). Since the SEH chain is a linked list, each entry in the list contains a location for the next entry, with the reference for the last SEH entry pointing to FFFFFFFF to indicate that it is the final entry. The following screenshot shows the SEH entry on the stack, after scrolling down to the bottom of the stack pane.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE15.png" alt="" /></p>
<p>The following shows a zoomed in view of the stack pane from the above.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE16.png" alt="" /></p>
<p>Let&#8217;s compare that to an SEH chain that has been overwritten. Restart vulnserver.exe in OllyDbg and use <strong>F9</strong> to start it running.</p>
<p>Save the following as gmon.pl</p>
<p style="margin-left: 28pt;"><code>#!/usr/bin/perl<br />
use IO::Socket;<br />
if ($ARGV[1] eq '') {<br />
die("Usage: $0 IP_ADDRESS PORT\n\n");<br />
}<br />
</code></p>
<p style="margin-left: 28pt;"><code>$baddata = "GMON /"; # sets variable $baddata to "GMON /"<br />
$baddata .= "A" x 5000; # appends (.=) 5000 "A" characters to $baddata<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket = IO::Socket::INET-&gt;new( # setup TCP socket – $socket<br />
Proto =&gt; "tcp",<br />
PeerAddr =&gt; "$ARGV[0]", # command line variable 1 – IP Address<br />
PeerPort =&gt; "$ARGV[1]" # command line variable 2 – TCP port<br />
) or die "Cannot connect to $ARGV[0]:$ARGV[1]";<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket-&gt;recv($sd, 1024); # Receive 1024 bytes data from $socket, store in $sd<br />
print "$sd"; # print $sd variable<br />
$socket-&gt;send($baddata); # send $baddata variable via $socket<br />
</code></p>
<p>And run it</p>
<p style="margin-left: 28pt;"><code>C:\_Work&gt;perl gmon.pl 127.0.0.1 9999<br />
</code></p>
<p>An exception should occur. Now check the bottom of the stack as well as the SEH chain window.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE17.png" alt="" /></p>
<p>You should see that the SEH entry has been overwritten with 41414141, as has the pointer to the next SEH record. We have definitely overwritten the SEH entry here.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE18.png" alt="" /></p>
<p>A zoomed in view of the stack is shown below.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE19.png" alt="" /></p>
<p>Now try and pass the exception through to the program to be handled using <strong>Shift+F7/F8/F9</strong> key combination. You should get an access violation with EIP pointing to 41414141. Windows tried to handle the previous exception by passing control to our overwritten SEH entry of 41414141.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE20.png" alt="" /></p>
<p>The text in the bottom left hand corner shows the following.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE21.png" alt="" /></p>
<p>And the registers are set to values as shown below (note the value of EIP)</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE22.png" alt="" /></p>
<p>When this happens within a program you are debugging, you should know that you have a decent chance of writing an SEH exploit for that vulnerability, although as I mentioned earlier there are a few caveats which you have to watch out for that I will discuss in a future article.</p>
<p><span style="font-size: 14pt;"><strong><a name="commands"></a>Searching for commands<br />
</strong></span></p>
<p>One of the simplest ways in which to perform software exploitation is to use instructions located in specific areas of memory to redirect code execution to areas of memory that we can control. In the case of the vulnerabilities shown so far in this tutorial we have managed to set the EIP register to locations of our choosing both via directly overwriting a RETN address on the stack and by using an overwritten SEH entry to redirect execution via the windows error handling routines. If we want to use this control over EIP to redirect to our own code inserted within the application, the simplest way to proceed is to find instructions that can perform this redirection at known locations within memory.</p>
<p>The best place to look for these instructions is within the main executables code or within the code of an executable module that is reliably loaded with the main executable. We can see which modules we have to choose from by allowing the program to run normally and then checking the list of executable modules in OllyDbg.</p>
<p><strong>Note</strong>: This method of checking for loaded modules may result in us missing some delay loaded dlls. If you&#8217;re concerned about this you can run the executable through its paces a little to give the best opportunity for those dlls to get called before you check which modules are loaded. Just remember that if you choose an address from a delay loaded module you need to ensure that that module is loaded before any exploit that relies on it is triggered.</p>
<p>Let&#8217;s try this now. Restart vulnserver in the debugger and press <strong>F9</strong> to let it run. Now open the <strong>View</strong> menu and select the <strong>Executable modules</strong> option (or hit <strong>Alt-E</strong>). This will show you a list of executable modules currently loaded with the main executable.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE23.png" alt="" /></p>
<p>At this point you will most likely note that there are quite a few modules to choose from. Which ones should you start with first? The best way to know how to proceed here is to start with the goal in mind. We want a module that offers a location in memory where we can reliably find a particular instruction we can use to redirect code for our exploit. Basically, this boils down to the module including the instruction we want and there not being any characteristics of the module that will prevent that instruction from being used. Such characteristics could include a restricted value in the address, or various exploit protections such as SafeSEH or ASLR being enabled in the module.</p>
<p>I usually use the following process to order the loaded modules in terms of least to most usable, and I search the most usable modules for my desired instruction first.</p>
<p>Operating System supplied modules go to the bottom of the list. You can tell which modules are OS supplied by checking the full path of the module. Usually, they are located in the \Windows\system32\ folder. These modules are best avoided for a number of reasons. First, they change between OS versions, as well as service packs and sometimes even hotfixes, meaning that an instruction that you find in one version of the module may not be there in another version, meaning that your exploit will only work on very specific systems (ones that have the same OS version, service pack and perhaps even hotfixes as your sample system.) Second, these OS supplied modules are almost certainly going to be compiled using compiler based exploit prevention features, such as SafeSEH and ASLR. Basically, you should only be looking at OS supplied modules if you have no better options.</p>
<p>A module you can consider using is the main executable itself, which is quite often not subject to any compiler based exploit protections, especially when the application has been written by a third party developer and not Microsoft. Using the main executable has one major flaw however, in that it almost always starts with a zero byte. This is a problem because the zero byte is a string terminator in C/C++, and using zero bytes as part of strings used to overflow a buffer will often result in the string being terminated at that point, potentially preventing the buffer from being appropriately overflowed and breaking the exploit.</p>
<p>The best choice of module to use is one that comes with the application itself (assuming a third party application). These modules are often compiled without exploit protections and since they come with the application being exploited the module structure usually remains the same amongst copies of the application with the same version number. This gives you the ability to write an exploit which will most likely work across a number of different Windows versions, as long as the version of the program to be exploited remains the same.</p>
<p>In this case we have one module, essfunc.dll, which should be suitable for our uses. Double click on it to open it in the CPU view. The title bar should now end with the text &#8220;module essfunc&#8221; if you have properly selected the essfunc module. Let&#8217;s see how we can find useful instructions within this module.</p>
<p>The first thing we need to know is what command we want to search for. In the case of exploits, the most commonly used instructions are those that either JMP or CALL a particular register, or a POP, POP RET instruction. The JMP or CALL commands are used when a particular register points to a location in memory which we control, and the POP, POP, RET instructions are used when we write SEH exploits on Windows systems XP SP2 and up.</p>
<p>Assuming we want to search for a &#8220;JMP ESP&#8221; instruction, we can use one of two commands accessible via right clicking in the top left hand pane of the CPU View of the appropriate module.</p>
<p>The first command, accessible by right clicking on the top left pane and selecting <strong>Search for-&gt;Command</strong> allows us to search for one command at a time. After the first result is shown, highlighted in the CPU view, you can see subsequent results by clicking <strong>Ctrl-L</strong> or selecting <strong>Search for-&gt;Next</strong> from the right click menu.</p>
<p>Try this now. Select the <strong>Search for-&gt;Command</strong> option from the right click menu in the top left pane of the CPU view (make sure essfunc is the currently selected module – it should mention this in the title bar as shown in the screenshot below).</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE24.png" alt="" /></p>
<p>Then, in the Find command window that appears, type &#8220;JMP ESP&#8221; and hit <strong>Find</strong>.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE25.png" alt="" /></p>
<p>This will take you to the first instance of that command within the currently selected module. Now hit <strong>Ctrl-L</strong> to find the next instance.</p>
<p>The second command, accessible by right clicking on the top left pane and selecting <strong>Search for-&gt;All</strong><br />
<strong>commands</strong>, will open a new window listing all instances of that command within the currently selected module.</p>
<p>Try this now. Select the <strong>Search for-&gt;All commands</strong> option from the right click menu in the top left pane of the CPU view. In the Find all commands box, type &#8220;JMP ESP&#8221; and hit <strong>Find</strong>. A new window will then appear showing the complete list of JMP ESP commands found in the currently selected module.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE26.png" alt="" /></p>
<p>This demonstrates how we can look for a single instruction, but what do we do if we want to look for multiple commands in sequence, such as a POP, POP, RET? Well for this we can either use the right click options <strong>Search for-&gt;Sequence of commands</strong> or <strong>Search for-&gt;All sequences</strong>, to either search for individual instances or all instances of a particular command sequence.</p>
<p>Let&#8217;s try searching for all instances of POP, POP, RET sequences in essfunc.dll. Make sure that module is still selected in the CPU View, then right click on the top left hand pane and select <strong>Search for-&gt;All sequences</strong>. Then, in the find sequence of commands window that appears type the following:</p>
<p style="margin-left: 28pt;"><code>POP r32<br />
POP r32<br />
RETN<br />
</code></p>
<p>Where &#8220;r32&#8221; is shorthand for any 32 bit register (e.g. ESP, EAX, etc). See the following screenshot.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE27.png" alt="" /></p>
<p>Hit <strong>Find</strong> and you will be greeted with a &#8220;Found sequences&#8221; window showing you all the locations where that sequence of commands exists within the current module. Your currently selected position in the code will also be shown in the list in red to show you where those discovered commands are in relation to your current position.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE28.png" alt="" /></p>
<p>Double click on any of the entries in the list and you will be taken to that location in the CPU view, so you can see that all commands you elected to search for are actually present. (In the screenshot below, for example, we can see POP EBX, POP EBP, RETN).</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE29.png" alt="" /></p>
<p><span style="font-size: 14pt;"><strong><a name="memory"></a>Searching through memory<br />
</strong></span></p>
<p>In some circumstances when writing an exploit you will need to determine if data you have sent to an application has been captured and stored somewhere in memory. This type of condition is especially useful when you have found an exploitable vulnerability but you don&#8217;t have room to insert your full payload into the same set of data that causes the exception. By placing your payload data into another accessible area in the program&#8217;s memory, you can then use special purpose shellcode to find that payload elsewhere in memory and redirect execution to it.</p>
<p>You can search memory for particular values very easily in OllyDbg. Essentially, you need to insert the appropriate data into the program, pause the debugged program at an appropriate point in its execution, then open the OllyDbg Memory map view and use the Search function to see if the appropriate data is present. If your goal is to see if data stored in a programs memory can be utilized in a particular exploit, the best way to go about this is to send the data and pause the program in the debugger by actually causing the appropriate exception. Let&#8217;s see how this works.</p>
<p>This code below will create the same exception we used in trun.pl above, but before the crash is triggered it will also send some data (a giant string of &#8220;B&#8221; characters) to the application using the GDOG command from vulnserver. Save the following as sendextradata.pl.</p>
<p style="margin-left: 28pt;"><code>#!/usr/bin/perl<br />
use IO::Socket;<br />
if ($ARGV[1] eq '') {<br />
die("Usage: $0 IP_ADDRESS PORT\n\n");<br />
}<br />
$memdata = "GDOG "; #sets variable $memdata to "GDOG "<br />
$memdata .= "B" x 5000; # appends (.=) 5000 "B" characters to $memdata<br />
</code></p>
<p style="margin-left: 28pt;"><code>$baddata = "TRUN ."; # sets variable $baddata to "TRUN ."<br />
$baddata .= "A" x 5000; # appends (.=) 5000 "A" characters to $baddata<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket = IO::Socket::INET-&gt;new( # setup TCP socket – $socket<br />
Proto =&gt; "tcp",<br />
PeerAddr =&gt; "$ARGV[0]", # command line variable 1 – IP Address<br />
PeerPort =&gt; "$ARGV[1]" # command line variable 2 – TCP port<br />
) or die "Cannot connect to $ARGV[0]:$ARGV[1]";<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket-&gt;recv($sd, 1024); # Receive 1024 bytes data from $socket, store in $sd<br />
</code></p>
<p style="margin-left: 28pt;"><code>print "$sd"; # print $sd variable<br />
$socket-&gt;send($memdata); # send $memdata variable via $socket<br />
$socket-&gt;recv($sd, 1024); # Receive 1024 bytes data from $socket, store in $sd<br />
print "$sd"; # print $sd variable<br />
$socket-&gt;send($baddata); # send $baddata variable via $socket<br />
</code></p>
<p>Start up vulnserver.exe in OllyDbg and hit <strong>F9</strong> to allow the program to Run. Then run this script as follows.</p>
<p style="margin-left: 28pt;"><code>C:\_Work&gt;perl sendextradata.pl 127.0.0.1 9999<br />
</code></p>
<p>An exception should be triggered in the debugger. To now search for the additional data we sent to the program (that big string of upper case &#8220;B&#8221; characters), open the <strong>View</strong> menu and select <strong>Memory</strong>, or hit <strong>Alt-M</strong> to bring up the Memory map in OllyDbg.</p>
<p>Now right click on the Memory map and select <strong>Search</strong> from the Menu, or hit <strong>Ctrl-B</strong>.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE30.png" alt="" /></p>
<p>This will bring up the search window. Enter a large string of upper case B characters in the ASCII box, and be sure to tick the <strong>Case sensitive</strong> option near the bottom of the window. See the below screenshot.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE31.png" alt="" /></p>
<p>Now hit <strong>OK</strong>, and you should soon be greeted by a memory Dump window, showing a large number of B characters in a row. Expand the window a little to see just how many there are. See the screenshot below. In this particular shot, you can also see the beginning of the TRUN command that we used to cause the exception.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE32.png" alt="" /></p>
<p>Here we have confirmed that we have a way of inserting additional data into the application in such a way that it is still available in memory at the time we caused this particular exception. This means that if we needed to provide additional content to the application in order to complete an exploit for this vulnerable bug, we could use the method demonstrated in the sendextradata.pl script to provide that data.</p>
<p><span style="font-size: 14pt;"><strong><a name="memorydump"></a>Working in the memory dump<br />
</strong></span></p>
<p>The memory dump windows in OllyDbg are extremely useful when writing exploits, as they provide multiple ways in which to view and access the data stored in a programs memory. This section will look at a number of ways in which we can work in the memory dump windows in order to efficiently manipulate and process this data.</p>
<p>This section is made up of the following subsections:</p>
<ul>
<li>Different memory dump views</li>
<li>Following in memory dump</li>
<li>Copying data from the memory dump</li>
</ul>
<p><span style="font-size: 12pt;"><strong><em>Different memory dump views<br />
</em></strong></span></p>
<p>During exploit writing it can often be useful to be able to represent data in the debugger in a variety of different formats, and sometimes to copy that data out of the debugger for processing with other programs. Luckily, OllyDbg provides a number of different view formats for memory dump windows (both the one in the bottom left hand pane of the CPU view and the ones accessed by double clicking on entries in the Memory map). This gives us options in how we can view a programs executable code, the data generated by the program, and data supplied by a programs users, all of which will be stored in memory. In addition, the memory dump windows, as well as many of the other views in OllyDbg, allow data to be easily copied out to the clipboard, and sometimes written to a file on disk, to allow it to be easily used in other programs.</p>
<p>The different view modes in the memory dump windows are accessed via the right click menu. Let&#8217;s examine some of the views that will be most useful to us as exploit writers.</p>
<p>One of the most commonly used display modes for memory in OllyDbg, especially within the CPU view, is the &#8220;Hex/ASCII (8 bytes)&#8221; view, which shows both the Hex and ASCII representation of the data, with 8 bytes per row. You can see a screenshot of this view mode below, along with the menu option used to select it (right click, <strong>Hex-&gt;Hex/ASCII (8 bytes)</strong>). There is also a &#8220;Hex/ASCII (16 bytes)&#8221; view mode which is essentially the same but 16 bytes of data are shown per row as opposed to 8, and you can also choose to view the text in Unicode instead of ASCII. This screenshot is of a memory dump window opened from the Memory map, but remember this view mode also applies to the memory pane in the CPU view.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE33.png" alt="" /></p>
<p>The &#8220;Text&#8221; view represents the data as pure text, using either the ASCII (single byte) or Unicode (double byte) encoding format. The previous view showed the ASCII (or Unicode) representation of data as well, but did it alongside the Hex representation. If you need to show just the text (perhaps because you want to copy only the text and not the hex data), this is the mode you can choose. To select the &#8220;Text&#8221; view, right click and select the appropriate entry from the Text submenu. See the following screenshot to see how the ASCII (32 chars) text view looks, as well as the menu entry you can choose to select it.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE34.png" alt="" /></p>
<p>The &#8220;Disassemble&#8221; view is the last one we will examine. This interprets the data from memory as assembly code, much as shown in the top left hand pane of the CPU view. The screenshot below shows the &#8220;Disassemble&#8221; view along with the menu option used to select it (right click and choose <strong>Disassemble</strong> from the menu).</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE35.png" alt="" /></p>
<p>When you open a Memory dump window from the Memory map, OllyDbg will often choose one of the above views for you automatically based on the type of content it believes is contained within that area of memory. For example, it will use the &#8220;Disassemble&#8221; view for areas that are believed to contain executable code.</p>
<p><span style="font-size: 12pt;"><strong><em>Following in memory dump<br />
</em></strong></span></p>
<p>Directly clicking on various memory pages from the memory map allows us to go to any area in memory we like, but what if we want to view the contents of memory at locations stored in one of the CPU registers, or in entries from the stack? What if we want to view the code from the disassembler pane in the stack?</p>
<p>Well we can do this by right clicking on the appropriate register, stack entry or disassembled instruction in the CPU view, and selecting the &#8220;Follow in Dump&#8221; option. The memory dump pane in the CPU view will then show the section of memory beginning with the address represented by the item you selected.</p>
<p>Try this now, by restarting vulnserver in the debugger, right clicking on the first entry in the disassemble pane, and selecting <strong>Follow in Dump-&gt;Selection</strong>.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE36.png" alt="" /></p>
<p>The memory dump pane will then display the memory address of the instruction you just selected, with the bytes making up that instruction being highlighted.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE37.png" alt="" /></p>
<p>You can also select multiple instructions and try the same thing – the data representing all of the instructions you selected will be highlighted in the memory dump.</p>
<p>You can also use the <strong>Follow in Dump</strong> option on the stack. Right click on an <span style="text-decoration: underline;">address</span> of a stack entry (left hand column in the stack pane), to view that section of the stack in the memory dump. Right click on the <span style="text-decoration: underline;">value</span> of a stack entry (second column in the stack pane), to view the memory location that entry contains. Please note that in the case of stack entries, the <strong>Follow in Dump</strong> option will only be available if the stack entry contains a valid memory address.</p>
<p>The <strong>Follow in Dump</strong> option also works with CPU registers. Like with stack entries, the option will only appear if the register contains a valid memory address.</p>
<p>Try the <strong>Follow in Dump</strong> option yourself on the stack and on the CPU registers so you get a feel for how it works.</p>
<p>One of the most important uses of this <strong>Follow in Dump</strong> option when writing exploits is to assist in finding stack entries or CPU registers that point to areas of memory we control when an exception occurs. This will give a pointer to how we can direct code execution into those memory areas. For example, if we see that when an exception occurs, the ESP register points to memory containing data we sent to the application, we could use a &#8220;JMP ESP&#8221; instruction to redirect code execution to that location.</p>
<p>Another potential use of this option is to allow us to easily view, select and copy instructions being executed by the CPU in different ways – a capability given to us by the flexibility of the display options of the memory dump view as opposed to some of the other views in OllyDbg. This can be very useful when we want to confirm shellcode we have sent to an application has not been mangled during transfer.</p>
<p><span style="font-size: 12pt;"><strong><em>Copying data from the memory dump<br />
</em></strong></span></p>
<p>There are two different ways in which selected data can be copied out of the memory dump that I would like to cover here.</p>
<p>The first method copies the data in a textual format, much as it is displayed in the debugger itself. When using this method, the output depends on the view mode you have chosen. If you are using the &#8220;Hex/ASCII (8 bytes)&#8221; view mode, you will get the address, the hex dump, and the ASCII representation, but if you are using the &#8220;Disassembly&#8221; view, you will get the address, the hex dump, the disassembly and a comment. As I said, it&#8217;s basically a text representation of what you see on screen.</p>
<p>To copy in this way, select some data using the mouse, then right click and select <strong>Copy-&gt;To clipboard</strong> or <strong>Copy-&gt;To file</strong>, depending on where you want the data to go. To get the data into the right format, you should obviously set your view mode, as described earlier, to the appropriate setting. You will find that most of the display windows in OllyDbg also offer some variation of this option, so if you want a text copy of pretty much anything you see on screen, you can probably get it via selecting the data and right clicking.</p>
<p>As an example of what this looks like, here is a sample of text copied from the memory dump in disassemble mode.</p>
<p style="margin-left: 28pt;"><code>00401130 &gt; $ 55 PUSH EBP<br />
00401131 89E5 MOV EBP,ESP<br />
00401133 83EC 18 SUB ESP,18<br />
00401136 C70424 0100000&gt;MOV DWORD PTR SS:[ESP],1<br />
</code></p>
<p>The second method for copying data is the binary copy. This copy method is only available in the memory dump and the disassembler views, and essentially copies to the clipboard a space delimited representation of the hex values for each byte selected. This is available by selecting some data in the memory dump, right clicking and selecting <strong>Binary-&gt;Binary copy</strong>. The following shows the text generated by performing a binary copy on the same data that was used to produce the example text based copy above.</p>
<p style="margin-left: 28pt;"><code>55 89 E5 83 EC 18 C7 04 24 01 00 00 00<br />
</code></p>
<p>Accessing the data in these formats can prove to be very useful when writing exploits. I often use the binary copy format to feed the data into a script that checks to see if shellcode sent to a program has been mangled.</p>
<p><a name="relative"></a><span style="font-size: 14pt;"><strong>Editing code, memory and registers<br />
</strong></span></p>
<p>One particularly cool feature of OllyDbg allows you to edit the values of memory, registers and the stack while a program is being debugged. This is extremely useful when writing exploits or shellcode as it allows you to quickly tweak data in memory after an exception if you realize you have made a mistake in any data or shellcode already provided to the application. It also provides a really quick way of finding opcodes for particular instructions if you need to add some custom shellcode to an exploit.</p>
<p>To demonstrate how this can work, we will use the following skeleton exploit code – save as skeletonexploit.pl.</p>
<p style="margin-left: 28pt;"><code>#!/usr/bin/perl<br />
use IO::Socket;<br />
if ($ARGV[1] eq '') {<br />
die("Usage: $0 IP_ADDRESS PORT\n\n");<br />
}<br />
</code></p>
<p style="margin-left: 28pt;"><code>$baddata = "TRUN ."; # sets variable $baddata to "TRUN ."<br />
$baddata .= "\x90" x 2006; # append 2006 \x90 bytes to $baddata<br />
$baddata .= pack('V1', 0x625011AF); # address of "JMP ESP" instruction from essfunc, little endian<br />
$baddata .= "\xcc" x 100; # append 100 \xcc INT3 breakpoints to $baddata<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket = IO::Socket::INET-&gt;new( # setup TCP socket – $socket<br />
Proto =&gt; "tcp",<br />
PeerAddr =&gt; "$ARGV[0]", # command line variable 1 – IP Address<br />
PeerPort =&gt; "$ARGV[1]" # command line variable 2 – TCP port<br />
) or die "Cannot connect to $ARGV[0]:$ARGV[1]";<br />
</code></p>
<p style="margin-left: 28pt;"><code>$socket-&gt;recv($sd, 1024); # Receive 1024 bytes data from $socket, store in $sd<br />
print "$sd"; # print $sd variable<br />
$socket-&gt;send($baddata); # send $baddata variable via $socket<br />
</code></p>
<p>This code is essentially the beginnings of an exploit for the vulnerability associated with the first exception we looked at earlier in this guide. When use against vulnserver running in the debugger, it should redirect code execution to the first of 100 &#8220;\xCC&#8221; characters sent to the program.</p>
<p>Don&#8217;t worry about how I wrote this code for the moment, or how the redirection to the INT3 instruction actually happened, I will cover that in a future article. For now, just restart Vulnserver in the debugger, use <strong>F9</strong> to start it running, then run the script as follows:</p>
<p style="margin-left: 28pt;"><code>C:\_Work&gt;perl skeletonexploit.pl 127.0.0.1 9999<br />
</code></p>
<p>Your debugger should pause execution, with the disassemble pane showing something like the below.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE38.png" alt="" /></p>
<p>All those &#8220;\xCC&#8221; characters we sent to the program using the skeletonexploit.pl script are shown right there in the debugger, and our program is actually running them as code. If we wanted to, we could replace the &#8220;\xCC&#8221; characters in our skeletonexploit.pl script with code that would perform some other function, but at the moment what we want to do is use this opportunity to show how we can edit data directly within the debugger. The &#8220;\xCC&#8221; is of course the opcode for an INT3 debugger trap instruction, as mentioned during the earlier section of this tutorial on assembly, and that is why the debugger paused when it executed the first of these instructions.</p>
<p>The first code editing method we will try is direct assembling, where we select an instruction and provide some assembly code to be placed in that location. If the assembly code we provide takes up more space than the instruction we selected, additional following instructions will also be overwritten, and if the final instruction overwritten has leftover bytes (e.g. if the final instruction is 4 bytes long but we only need two of those bytes to complete the instruction we add), any spare space will be filled with NOPs if the <strong>Fill with NOP&#8217;s</strong> checkbox is left selected.</p>
<p>To try this, double click on the currently selected INT3 instruction (make sure you click on the instruction itself, not the address, opcode or comment columns, as this will have a different effect). In the Assemble window that appears, type the following.</p>
<p style="margin-left: 28pt;"><code>ADD EAX, 5<br />
</code></p>
<p>See the following screenshot.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE39.png" alt="" /></p>
<p>Hit the <strong>Assemble</strong> button, and then <strong>Cancel</strong> to get rid of the next Assemble window that appears. You should now see something like the following in your disassembler pane. The new instruction is shown in red.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE40.png" alt="" /></p>
<p>If you were curious to know the opcodes that compromise this assembly instruction, you would now know what they were – &#8220;\x83\xC0\x05&#8221; – check the second column from the left in the disassembler pane. This has even been separated in the display somewhat, with a space between the &#8220;C0&#8221; and the &#8220;05&#8221;, which indicates &#8220;\x83\xC0&#8221; is the &#8220;ADD EAX&#8221;, and &#8220;\x05&#8221; is the value to add (in hex format). The ability to quickly discover opcodes for given assembly instructions, so you can use them in your exploits, is one of the ways this code editing feature benefits us as exploit writers.</p>
<p>Take a note of the value stored in the EAX register, and then hit the <strong>F7</strong> key to step through execution of this newly added instruction. You should see then that the value of EAX changes by 5, and the EAX register will be colored red to indicate that its value has changed during the execution of the last instruction. See the following screenshot.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE41.png" alt="" /></p>
<p>The second code editing method we will try to use is a direct binary edit of data in the disassemble pane. This can be a quick way for us to translate opcode values to their equivalent assembly language instructions, and can also allow us to modify values of existing instructions.</p>
<p>Let&#8217;s try this now. Left click to select the next instruction in the disassembler pane following the &#8220;ADD EAX, 5&#8221; instruction we just added (this instruction should have its address highlighted with a black background to indicate it will be the next instruction executed by the CPU). The right click, and from the menu that appears select <strong>Binary</strong>-&gt;<strong>Edit</strong>, or you can hit <strong>Ctrl-E</strong>.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE42.png" alt="" /></p>
<p>In the Edit code box that appears, replace the existing hex data of &#8220;CC&#8221; with &#8220;54&#8221;, as shown below. From our assembly lesson earlier in this tutorial, we know that the opcode of &#8220;\x54&#8221; translates to a &#8220;PUSH ESP&#8221; instruction.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE43.png" alt="" /></p>
<p>Hit <strong>OK</strong>. Sure enough a PUSH ESP instruction should appear in our disassembler pane. Now select the next INT3 instruction, immediately following the one we just edited, and perform another binary edit, this time replacing &#8220;CC&#8221; with &#8220;C3&#8221;. As we learned earlier, this opcode represents a &#8220;RETN&#8221;. Hit <strong>OK</strong>. Your disassembler pane should resemble the following screenshot.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE44.png" alt="" /></p>
<p>Now press <strong>F7</strong> to execute the PUSH ESP instruction. You should notice the value of ESP will get pushed onto the stack. Now press <strong>F7</strong> again. The RETN instruction will execute, which will POP the top entry off the stack and redirect execution to</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE45.png" alt="" /></p>
<p>That was all very well and good, but I&#8217;m sure you are wondering now why should you bother with binary editing when direct assembling seems so much easier. Well there is at least one area in which the use of opcodes is much more efficient — relative JMPs and CALLs.</p>
<p>Let&#8217;s say we want to add code to perform a JMP 8 bytes ahead. If you remember from our earlier lesson though, JMP instructions were specified using an absolute address in assembly. To save us from having to calculate the address 8 bytes ahead, we can just directly enter the opcode.</p>
<p>Select the top &#8220;INT3&#8221; and the &#8220;ADD, EAX, 5&#8221; commands in the disassembler pane, then right click and select <strong>Binary-&gt;Edit</strong> from the menu. The following will appear.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE46.png" alt="" /></p>
<p>Edit the hex values in the bottom box to &#8220;\xEB\x08\x90\x90&#8221;. This is &#8220;\xEB\x08&#8221; for the &#8220;JMP 8&#8221;, with two NOPs added to the end. See below.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE47.png" alt="" /></p>
<p>Hit <strong>OK</strong>. Your disassembler pane will show as below.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE48.png" alt="" /></p>
<p>OK, it has taken the opcodes we provided and interpreted this as a &#8220;JMP SHORT&#8221; and provided an absolute address in memory to jump to – we did not need to calculate the address ourselves in order to add this code to the debugger.</p>
<p>As well as being useful for relative JMPs and CALLs, we can also use this ability of OllyDbg to disassemble binary data any time we have a need to find the assembly equivalent of particular byte values. This can be useful when we need to find which instructions will bypass character restrictions, in order to achieve goals like decoding shellcode or forming a NOP slide.</p>
<p>While I have demonstrated the editing of data only in the disassembler pane, it also works elsewhere in the CPU view, allowing you to edit register values, flag values, stack values as well as any data you can access from the memory dump pane. In the memory dump and disassembler panes, you even have the ability to do binary copies and pastes if the need arises. These features can really come in handy when you are writing and testing custom shellcode.</p>
<p>One important caveat to mention regarding editing data in the debugger in this way is that any changes made in this manner do not apply outside the debugging session. This is useful as supporting functionality when actually creating an exploit, but cannot be used in the actual finished product.</p>
<p><span style="font-size: 14pt;"><strong><a name="plugins"></a>Help in calculating relative address differences<br />
</strong></span></p>
<p>If you need to calculate distance for a relative JMP or CALL statement, or determine the size of an area in memory to see if it&#8217;s big enough for shellcode, you may be able to make use of OllyDbgs relative memory addressing feature.</p>
<p>Double click on an address entry anywhere in OllyDbg, and the address column will change from displaying absolute memory addresses to displaying the relative offset of each entry from the address initially clicked upon.</p>
<p>The screenshot below shows the disassembler pane after I double clicked on the second address from the top – the one holding the first red NOP instruction. That particular address was then marked with the &#8220;==&gt;&#8221; indicator, and the other addresses are marked with their relative distance from that position. The entry highlighted in grey is where the top JMP SHORT instruction will land (8 bytes from the start of the instruction following the JMP).</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE49.png" alt="" /></p>
<p>This relative addressing trick also works in the memory dump views and the stack pane. Try it out when you need to calculate memory differences!</p>
<p><span style="font-size: 14pt;"><strong>Plugins<br />
</strong></span></p>
<p>OllyDbg features a plugin architecture that allows third parties to add functionality to the debugger by providing the necessary code in a dll file which can be placed in the OllyDbg directory.</p>
<p>There are a number of OllyDbg plugins available for download from the OpenRCE site at the following URL: <a href="http://www.openrce.org/downloads/browse/OllyDbg_Plugins" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.openrce.org/downloads/browse/OllyDbg_Plugins', 'http://www.openrce.org/downloads/browse/OllyDbg_Plugins');">http://www.openrce.org/downloads/browse/OllyDbg_Plugins</a></p>
<p>In this section, I will briefly cover the use of one plugin that is particularly useful when writing SEH exploits – OllySSEH.</p>
<p>This plugin is available here</p>
<div class="download-cta-clearfix">
  <a class="download-cta icon save-s" href="#download" rel="modal:open">Download</a>
</div>
<p>and allows you to easily see which modules loaded with an application can be used to provide overwrite addresses when writing an SEH exploit.</p>
<p>To install the plugin, simply take the OllySSEH.dll file from the \ollysseh\Project\Release\ directory in the zip file, and copy it to the OllyDbg main program directory. Then restart OllyDbg.</p>
<p>Once installed, the functionality provided by the plugin can be accessed via the <strong>Plugins</strong> menu, <strong>SafeSEH</strong>-&gt;<strong>Scan /SafeSEH Modules</strong> option.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE50.png" alt="" /></p>
<p>To use the plugin effectively, you start your target program and use the <strong>F9</strong> key to allow it to run in the browser. Modules set to load with the program will be loaded into memory and the debugger, allowing them to be scanned by the plugin. Once the program is running, use the <strong>Plugins</strong> menu, <strong>SafeSEH</strong>-&gt;<strong>Scan /SafeSEH Modules</strong> option to scan the modules.</p>
<p>Doing this for vulnserver.exe shows the following output.</p>
<p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/022811_1948_InDepthSEHE51.png" alt="" /></p>
<p>The entries in red, which have a SEH mode of &#8220;/SafeSEH OFF&#8221; are most suitable for use with SEH exploits – any address from these modules can be used as an SEH overwrite address.</p>
<p>These OllyDbg plugins will not work in Immunity Debugger nor will they work in OllyDbg version 2. Immunity Debugger has its own Python engine, and a number of Python based plugin scripts have been provided that allow similar types of information to be gathered.</p>
<p>You should keep your eye out for other useful OllyDbg plugins, which may help in your exploitation work.</p>
<p>The OllyDbg program will be useful as we work through future articles exploiting vulnerabilities in the Vulnserver program.</p>
<div class='ig_inline_container ig_the_content ig_after'></div>
     
      <nav class="series-pagination">
        <ul>
                      <li class="prev">
              <a href="http://resources.infosecinstitute.com/debugging-fundamentals-for-exploit-development/#article" rel="prev">Prev: Debugging Fundamentals for Exploit Development</a>
            </li>
                    
                  </ul>
      </nav>
      
    </article>
    
    <section class="post-author large">
  
  <div class="image">
    <img alt='' src='http://1.gravatar.com/avatar/762533a1ea465761a75f8a5a65823113?s=96&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/762533a1ea465761a75f8a5a65823113?s=192&amp;d=mm&amp;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' />
  </div>
  
  <div class="name">
    <span>Author</span>
    <h5>
      <a href="http://resources.infosecinstitute.com/author/lupin">Stephen Bradshaw</a>
    </h5>
  </div>
  
  <div class="description">
    Stephen Bradshaw is security researcher for InfoSec Institute and an IT Security Specialist in Australia, with a focus on the areas of penetration testing and incident detection and response.
  </div>
  
    
</section>    
    <ul class="random-posts ">
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//PCI-237x237-c-default.jpg');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/pci-dss-3-2-is-coming-are-you-ready/" title="PCI-DSS 3.2 is Coming: Are You Ready?">
        <h3>PCI-DSS 3.2 is Coming: Are You&hellip;</h3>
      </a>
    </li>
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//050316_2316_PublicKeyIn13-237x237-c-default.png');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/public-key-infrastructure-pki/" title="Public Key Infrastructure (PKI)">
        <h3>Public Key Infrastructure (PKI)</h3>
      </a>
    </li>
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//050216_2256_SNMPPentest81-237x237-c-default.png');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/snmp-pentesting/" title="SNMP Pentesting">
        <h3>SNMP Pentesting</h3>
      </a>
    </li>
      <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//042816_1940_MasteringMo2-237x237-c-default.png');">
      <a class="icon post-l" href="http://resources.infosecinstitute.com/mastering-mobile-forensics/" title="Mastering Mobile Forensics">
        <h3>Mastering Mobile Forensics</h3>
      </a>
    </li>
  </ul>    
    <div class="comments">
  
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-13815">
        <div id="dsq-comment-header-13815" class="dsq-comment-header">
            <cite id="dsq-cite-13815">
                <span id="dsq-author-user-13815">john</span>
            </cite>
        </div>
        <div id="dsq-comment-body-13815" class="dsq-comment-body">
            <div id="dsq-comment-message-13815" class="dsq-comment-message"><p>Great stuff, very well explained and easy to follow compared to other stuff on internet, so congrats and well done.. u make a good teacher&#8230; am wondering when u are going to have other things in future tutorials/. thanks john</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-13834">
        <div id="dsq-comment-header-13834" class="dsq-comment-header">
            <cite id="dsq-cite-13834">
http://grey-corner.blogspot.com/                <span id="dsq-author-user-13834">Stephen Bradshaw</span>
            </cite>
        </div>
        <div id="dsq-comment-body-13834" class="dsq-comment-body">
            <div id="dsq-comment-message-13834" class="dsq-comment-message"><p>john</p>
<p>Thanks for your comments.  In response to your question I have firm plans for at least another seven tutorials, which I will release as quickly as I can churn them out (taking into account other commitments like a full time job, eating, sleeping, etc).  The next one will be focusing on writing a basic stack overflow exploit.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-13913">
        <div id="dsq-comment-header-13913" class="dsq-comment-header">
            <cite id="dsq-cite-13913">
                <span id="dsq-author-user-13913">sav</span>
            </cite>
        </div>
        <div id="dsq-comment-body-13913" class="dsq-comment-body">
            <div id="dsq-comment-message-13913" class="dsq-comment-message"><p>Stephen, this stuff is great, a good tutorial on OllyDbg is unprecedented! I&#8217;m looking forward to more tutorials! </p>
<p>I am especially interested in interpreting the stack layout. The VC2010 compiler introduces a lot of code to even the simplest C program with only C Runtime Library statically linked into it, and I&#8217;m having trouble understanding the flow of code.</p>
<p>Another thing I was wondering about is: where does OllyDbg initially break if you open an executable? I figured it&#8217;s the ModuleEntryPoint, but there are already things on the stack, so something must have happened before that.</p>
<p>Regards<br />
sav</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-13919">
        <div id="dsq-comment-header-13919" class="dsq-comment-header">
            <cite id="dsq-cite-13919">
http://none                <span id="dsq-author-user-13919">Andrew</span>
            </cite>
        </div>
        <div id="dsq-comment-body-13919" class="dsq-comment-body">
            <div id="dsq-comment-message-13919" class="dsq-comment-message"><p>Exelente tutorial bro te felicito muy buena documentacion me gusta como complementas lo  de tu blog con otras cosas que nos facilitan aun mas la busqueda de vulnerabilidades</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-14087">
        <div id="dsq-comment-header-14087" class="dsq-comment-header">
            <cite id="dsq-cite-14087">
http://grey-corner.blogspot.com/                <span id="dsq-author-user-14087">Stephen Bradshaw</span>
            </cite>
        </div>
        <div id="dsq-comment-body-14087" class="dsq-comment-body">
            <div id="dsq-comment-message-14087" class="dsq-comment-message"><p>sav &#8211; Thanks for the comment!  I wasn&#8217;t sure how useful an OllyDbg tutorial would be to people, but I wanted to write it anyway to prevent me from having to go over the debugging skills separately in the forthcoming exploit tutorials I am planning.  It&#8217;s good to hear that its appreciated.</p>
<p>I&#8217;m currently in the process of writing a basic stack overflow tutorial for the first vulnerability in Vulnserver, and this does step through how the stack overflow actually happens, so hopefully this will help a little in understanding the workings of the stack.</p>
<p>The first pause location in OllyDbg can be configured to use one of three locations under Options-&gt;Debugging options-&gt;Events tab.  The default is WinMain if the location is known.</p>
<p>Andrew &#8211; Gracias</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-14460">
        <div id="dsq-comment-header-14460" class="dsq-comment-header">
            <cite id="dsq-cite-14460">
                <span id="dsq-author-user-14460">john</span>
            </cite>
        </div>
        <div id="dsq-comment-body-14460" class="dsq-comment-body">
            <div id="dsq-comment-message-14460" class="dsq-comment-message"><p>Hi great stuff Stephen, when is the next turorial due, or how can i know .thanks john</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-14517">
        <div id="dsq-comment-header-14517" class="dsq-comment-header">
            <cite id="dsq-cite-14517">
http://grey-corner.blogspot.com/                <span id="dsq-author-user-14517">Stephen Bradshaw</span>
            </cite>
        </div>
        <div id="dsq-comment-body-14517" class="dsq-comment-body">
            <div id="dsq-comment-message-14517" class="dsq-comment-message"><p>john</p>
<p>Best case &#8211; within the next week or so.  Keep an eye on the home page of the resources site here, and I will also post links on my blog.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="post pingback">
        <p>Pingback: <a href='http://infosec.wpengine.com/stack-based-buffer-overflow-tutorial-part-1-%e2%80%94-introduction/' rel='external nofollow' class='url'>Stack Based Buffer Overflow Tutorial, part 1 — Introduction | &nbsp;InfoSec Resources</a>()</p>
    </li>
    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-19684">
        <div id="dsq-comment-header-19684" class="dsq-comment-header">
            <cite id="dsq-cite-19684">
                <span id="dsq-author-user-19684">dabenno</span>
            </cite>
        </div>
        <div id="dsq-comment-body-19684" class="dsq-comment-body">
            <div id="dsq-comment-message-19684" class="dsq-comment-message"><p>thx please go on</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="post pingback">
        <p>Pingback: <a href='http://infosec.wpengine.com/seh-exploit/' rel='external nofollow' class='url'>SEH Based Overflow Exploit Tutorial | &nbsp;InfoSec Resources</a>()</p>
    </li>
    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-22299">
        <div id="dsq-comment-header-22299" class="dsq-comment-header">
            <cite id="dsq-cite-22299">
http://www.phocean.net                <span id="dsq-author-user-22299">phocean</span>
            </cite>
        </div>
        <div id="dsq-comment-body-22299" class="dsq-comment-body">
            <div id="dsq-comment-message-22299" class="dsq-comment-message"><p>I just found this article as I have been working hard recently to learn assembly and shellcoding.<br />
Congratulations and many thanks, it helped me a lot.<br />
And after reading many articles and books, I can tell yours is one of the clearest and the most instructive.<br />
Good job, keep it up!</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-odd thread-alt depth-1" id="dsq-comment-22876">
        <div id="dsq-comment-header-22876" class="dsq-comment-header">
            <cite id="dsq-cite-22876">
http://grey-corner.blogspot.com/                <span id="dsq-author-user-22876">Stephen Bradshaw</span>
            </cite>
        </div>
        <div id="dsq-comment-body-22876" class="dsq-comment-body">
            <div id="dsq-comment-message-22876" class="dsq-comment-message"><p>Thanks for the comment phocean</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-even depth-1" id="dsq-comment-23685">
        <div id="dsq-comment-header-23685" class="dsq-comment-header">
            <cite id="dsq-cite-23685">
                <span id="dsq-author-user-23685">Charlie</span>
            </cite>
        </div>
        <div id="dsq-comment-body-23685" class="dsq-comment-body">
            <div id="dsq-comment-message-23685" class="dsq-comment-message"><p>Could you maybe provide a better plain text or simply .txt file links for all your perl code. I keep getting script errors when copy-pasteing because of the text formatting of this web page and it&#8217;s fairly annoying. Particularly the double quotes being unrecognized.</p>
</div>
        </div>

    <ul class="children">
    <li class="comment odd alt depth-2" id="dsq-comment-719274">
        <div id="dsq-comment-header-719274" class="dsq-comment-header">
            <cite id="dsq-cite-719274">
                <span id="dsq-author-user-719274">Jesse</span>
            </cite>
        </div>
        <div id="dsq-comment-body-719274" class="dsq-comment-body">
            <div id="dsq-comment-message-719274" class="dsq-comment-message"><p>Like Charlie I also ran into errors when working with basicclient.pl.  I can not get past this point although I verified the correctness of the basicclient.pl and have tested other sample pl sscripts and they work fine.  I&#8217;m leaning towards the IO:SOCKET statement as the soource since the errors do not point to the code in the basicclient.pl script.</p>
<p>Thank you in advance for any support, advice, or recommendations.</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-26331">
        <div id="dsq-comment-header-26331" class="dsq-comment-header">
            <cite id="dsq-cite-26331">
                <span id="dsq-author-user-26331">7h3rAm</span>
            </cite>
        </div>
        <div id="dsq-comment-body-26331" class="dsq-comment-body">
            <div id="dsq-comment-message-26331" class="dsq-comment-message"><p>Thanks a lot for an amazingly simple tutorial.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-29291">
        <div id="dsq-comment-header-29291" class="dsq-comment-header">
            <cite id="dsq-cite-29291">
                <span id="dsq-author-user-29291">viv</span>
            </cite>
        </div>
        <div id="dsq-comment-body-29291" class="dsq-comment-body">
            <div id="dsq-comment-message-29291" class="dsq-comment-message"><p>Well you pretty much boiled down the internal workings of olly to its simplest level.thks..</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-32615">
        <div id="dsq-comment-header-32615" class="dsq-comment-header">
            <cite id="dsq-cite-32615">
                <span id="dsq-author-user-32615">TriTango</span>
            </cite>
        </div>
        <div id="dsq-comment-body-32615" class="dsq-comment-body">
            <div id="dsq-comment-message-32615" class="dsq-comment-message"><p>These are amazing articles, please make more. =]</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-42946">
        <div id="dsq-comment-header-42946" class="dsq-comment-header">
            <cite id="dsq-cite-42946">
                <span id="dsq-author-user-42946">san</span>
            </cite>
        </div>
        <div id="dsq-comment-body-42946" class="dsq-comment-body">
            <div id="dsq-comment-message-42946" class="dsq-comment-message"><p>amazing &amp; excellent tutorial</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-59928">
        <div id="dsq-comment-header-59928" class="dsq-comment-header">
            <cite id="dsq-cite-59928">
                <span id="dsq-author-user-59928">Nate</span>
            </cite>
        </div>
        <div id="dsq-comment-body-59928" class="dsq-comment-body">
            <div id="dsq-comment-message-59928" class="dsq-comment-message"><p>Thanks Steve and please keep up the good work</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-94516">
        <div id="dsq-comment-header-94516" class="dsq-comment-header">
            <cite id="dsq-cite-94516">
                <span id="dsq-author-user-94516">Ignacio</span>
            </cite>
        </div>
        <div id="dsq-comment-body-94516" class="dsq-comment-body">
            <div id="dsq-comment-message-94516" class="dsq-comment-message"><p>Muchas gracias Lupin por esta serie de articulos :)</p>
<p>Just as a note: at least in Windows 7, the original OllySSEH.dll crashes when you try to run the plugin in ollydbg.<br />
The solution it&#8217;s pointed out in <a href="http://seclists.org/fulldisclosure/2009/Nov/16" onclick="__gaTracker('send', 'event', 'outbound-comment', 'http://seclists.org/fulldisclosure/2009/Nov/16', 'http://seclists.org/fulldisclosure/2009/Nov/16');" rel="nofollow">http://seclists.org/fulldisclosure/2009/Nov/16</a></p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-105409">
        <div id="dsq-comment-header-105409" class="dsq-comment-header">
            <cite id="dsq-cite-105409">
http://ÿþ                <span id="dsq-author-user-105409">Ashley Belz</span>
            </cite>
        </div>
        <div id="dsq-comment-body-105409" class="dsq-comment-body">
            <div id="dsq-comment-message-105409" class="dsq-comment-message"><p>Wow! this cartoon type YouTube video I have viewed when I was in primary level and at the present I am in school and seeing that over again here.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-117799">
        <div id="dsq-comment-header-117799" class="dsq-comment-header">
            <cite id="dsq-cite-117799">
                <span id="dsq-author-user-117799">Rey Perez</span>
            </cite>
        </div>
        <div id="dsq-comment-body-117799" class="dsq-comment-body">
            <div id="dsq-comment-message-117799" class="dsq-comment-message"><p>Is it me or should this say&#8230;</p>
<p>if ($ARGV[1] eq &#8220;equal &#8220;) {</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-176820">
        <div id="dsq-comment-header-176820" class="dsq-comment-header">
            <cite id="dsq-cite-176820">
http://Ihavebeenexploringforalittlebitforanyhighqualityarticlesorblogpostsonthissortofarea                <span id="dsq-author-user-176820">Gass926@gmail.com</span>
            </cite>
        </div>
        <div id="dsq-comment-body-176820" class="dsq-comment-body">
            <div id="dsq-comment-message-176820" class="dsq-comment-message"><p>I’d always want to be update on new content on this site , saved to fav! .</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-180880">
        <div id="dsq-comment-header-180880" class="dsq-comment-header">
            <cite id="dsq-cite-180880">
                <span id="dsq-author-user-180880">alok</span>
            </cite>
        </div>
        <div id="dsq-comment-body-180880" class="dsq-comment-body">
            <div id="dsq-comment-message-180880" class="dsq-comment-message"><p>wow  a wonderful guide, keep up the good work.    Cheers.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-186998">
        <div id="dsq-comment-header-186998" class="dsq-comment-header">
            <cite id="dsq-cite-186998">
                <span id="dsq-author-user-186998">athar</span>
            </cite>
        </div>
        <div id="dsq-comment-body-186998" class="dsq-comment-body">
            <div id="dsq-comment-message-186998" class="dsq-comment-message"><p>very helpful information.. would you please tell us how to edit a combo list listed in the exe i have been trying hard to do that. please mail me waiting for the earnest reply. <a href="mailto:atharrs@gmail.com">atharrs@gmail.com</a></p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-211701">
        <div id="dsq-comment-header-211701" class="dsq-comment-header">
            <cite id="dsq-cite-211701">
http://double-dragon.blogspot.com                <span id="dsq-author-user-211701">hanggara</span>
            </cite>
        </div>
        <div id="dsq-comment-body-211701" class="dsq-comment-body">
            <div id="dsq-comment-message-211701" class="dsq-comment-message"><p>One of the best exploit development tutorial. I&#8217;m still 20 years old, it looks difficult for me. But I won&#8217;t give up that easy.</p>
<p>I hope someday I can be your student, and have a great skill like you Mr. Bradshaw.</p>
<p>Best regards : hanggara<br />
Indonesian</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-261485">
        <div id="dsq-comment-header-261485" class="dsq-comment-header">
            <cite id="dsq-cite-261485">
                <span id="dsq-author-user-261485">David2012</span>
            </cite>
        </div>
        <div id="dsq-comment-body-261485" class="dsq-comment-body">
            <div id="dsq-comment-message-261485" class="dsq-comment-message"><p>Mr. Bradshaw, this is one of the most professionally written tutorials I have seen for a long long time. I want to follow all your tuts past and future. Pl keep me posted on my e-mail, if it can be done.</p>
<p>Thanx a million times for your effort.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-838148">
        <div id="dsq-comment-header-838148" class="dsq-comment-header">
            <cite id="dsq-cite-838148">
                <span id="dsq-author-user-838148">idrcelab</span>
            </cite>
        </div>
        <div id="dsq-comment-body-838148" class="dsq-comment-body">
            <div id="dsq-comment-message-838148" class="dsq-comment-message"><p>Very nice and clear tutorial, thank you Mr Bradshaw :).</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-1191695">
        <div id="dsq-comment-header-1191695" class="dsq-comment-header">
            <cite id="dsq-cite-1191695">
http://N/A                <span id="dsq-author-user-1191695">Dave</span>
            </cite>
        </div>
        <div id="dsq-comment-body-1191695" class="dsq-comment-body">
            <div id="dsq-comment-message-1191695" class="dsq-comment-message"><p>Hi Just to help anyone out who is having problems with the shell code. For me from windows xp s1 even to windows 7 i HAD to use \ on the XCC breakpoints or they just showed up as regular ascii text instead of code. So hopefully i helped someone out. Cheers</p>
</div>
        </div>

    </li><!-- #comment-## -->
            </ul>


        </div>

    </div>


</div>  
  </div>

        </div>
      </section>
      
              <footer class="site-footer">
  
  <div class="ctas full">
    
    <div class="col-3-3 wrapper">
      
      <div class="col-1-3">
        <h6>About InfoSec</h6>
        <p>InfoSec Institute is the best source for high quality <a href="http://www.infosecinstitute.com" style="color:#fff;">information security training</a>. We have been training Information Security and IT Professionals since 1998 with a diverse lineup of relevant training courses. In the past 16 years, over 50,000 individuals have trusted InfoSec Institute for their professional development needs! </p>

      </div>
      
      <div class="col-1-3">
        <h6>Connect with us</h6>
        <p>Stay up to date with <a href="http://www.infosecinstitute.com" style="color:#fff;">InfoSec Institute</a> and <a href="http://www.intenseschool.com" style="color:#fff;">Intense School</a> - at info@infosecinstitute.com</p>

        <ul class="footer-social">
  <li>
    <div class="fb-like" data-href="http://resources.infosecinstitute.com" data-width="90" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false"></div>
  </li>
  <li>
    <a class="twitter-follow-button" href="https://twitter.com/infosecedu" data-show-count="false" data-lang="en">Follow @infosecedu</a>
  </li>
</ul>      </div>
      
      <div class="col-1-3">
        <form action="/newsletter/signup" method="post" class="mailchimp has-loader" novalidate>
  
  <aside>
    <h6>Join our newsletter</h6>
    <p>Get the latest news, updates & offers straight to your inbox.</p>

  </aside>
  
  <fieldset>
    <input type="email" title="Email address" value="" name="EMAIL" placeholder="Enter your email">
    <input type="submit" value="Subscribe" class="generic-cta green">
    <input type="text" name="b_2593cfe26893087ed36e00fe3_ba06ce498c" tabindex="-1" value="">
  </fieldset>
  
</form>      </div>
      
    </div>
    
  </div>
  
  <div class="navigation full">
    
    <div class="col-3-3 wrapper">
      
      <nav class="footer">
        <ul>
                  </ul>
      </nav>

      <div class="copyright">&copy; InfoSec Resources 2016</div>
      
    </div>
    
  </div>

</footer>            
    </main>
    
      <div class="modal">
  <div class="modal-inner">
    <a rel="modal:close">Close</a>
    <div class="modal-content"></div>
  </div>
</div>

<div id="modal-hidden">
                <div id="download">
  <div class="pardot form">
    <h4 class="pardot-title">File download</h4>
    <form id="download-form" action="https://go.pardot.com/l/12882/2014-12-11/cqhcw" method="post"><input type="hidden" name="entry_title" value="Tricks for Exploit Development">
      <input type="hidden" name="download_title" value="ollysseh">
      <input type="hidden" name="resources_training" value="">

      
      <input type="hidden" name="url" value="http://resources.infosecinstitute.com/in-depth-seh-exploit-writing-tutorial-using-ollydbg/">
      <input type="hidden" name="entry_id" value="582">
      <input type="hidden" name="entry_url" value="http://resources.infosecinstitute.com/in-depth-seh-exploit-writing-tutorial-using-ollydbg/">
      <input type="hidden" name="entry_type" value="Article">

      <ul>
        <li data-required>
          <label>First Name</label>
          <input name="first_name">
        </li>
        <li data-required>
          <label>Last Name</label>
          <input name="last_name">
        </li>
        <li data-required>
          <label>Work Phone Number</label>
          <input name="phone">
        </li>
        <li data-required>
          <label>Work Email Address</label>
          <input name="email">
        </li>
        <li>
          <label>Job Title</label>
          <input name="job_title">
        </li>
                  <li class="training-fund">
            <label>How will you fund your training?</label>
            <div class="dd">
              <select name="training_fund">
                                  <option value="No current plan">No current plan</option>
                                  <option value="Employer Paid">Employer Paid</option>
                                  <option value="GI Bill">GI Bill</option>
                                  <option value="Tuition Assistance">Tuition Assistance</option>
                                  <option value="Self Pay">Self Pay</option>
                                  <option value="Other">Other</option>
                              </select>
            </div>
          </li>
                          <li class="training-why">
            <label>Why Take This Training?</label>
            <div class="dd">
              <select name="training_why">
                                  <option value="I'm not interested in training" title="I'm not interested in training">I'm not interested in training</option>
                                  <option value="To get certified - company mandated" title="To get certified - company mandated">To get certified - company mandated</option>
                                  <option value="To get certified - my own reasons" title="To get certified - my own reasons">To get certified - my own reasons</option>
                                  <option value="To improve my skillset - get a promotion" title="To improve my skillset - get a promotion">To improve my skillset - get a promotion</option>
                                  <option value="To improve my skillset- for a new job" title="To improve my skillset- for a new job">To improve my skillset- for a new job</option>
                                  <option value="Other" title="Other">Other</option>
                              </select>
            </div>
          </li>
                          <li class="training-timeline">
            <label>What is your timeline for training?</label>
            <div class="dd">
              <select name="training_timeline">
                                  <option value="I have no current timeline for training">I have no current timeline for training</option>
                                  <option value="Within a month">Within a month</option>
                                  <option value="1-3 months">1-3 months</option>
                                  <option value="3-6 months">3-6 months</option>
                                  <option value="6-12 months">6-12 months</option>
                                  <option value="Over 1 year">Over 1 year</option>
                              </select>
            </div>
          </li>
                <li class="full">
          <input type="submit" class="generic-cta green" value="Download files">
        </li>
      </ul>

      <p>InfoSec institute respects your privacy and will never use your personal information for anything other than to notify you of your requested course pricing. We will never sell your information to third parties. You will not be spammed.</p>

      <div style="position:absolute; left:-9999px; top: -9999px;">
        <label for="pardot_extra_field">Comments</label>
        <input type="text" id="pardot_extra_field" name="pardot_extra_field">
      </div>

    </form>
  </div>
</div>            <div id="skillset-modal">
  <div class="skillset window">
    <h4>What is Skillset?</h4>
    <aside>
      
      <div class="left">
        <h3>Skillset</h3>
        <h5>Practice tests & assessments.</h5>
      </div>
      
      <div class="right">
        <p>Practice for certification success with the Skillset library of over 100,000 practice test questions. We analyze your responses and can determine when you are ready to sit for the test. Along your journey to exam readiness, we will:</p>
<p></p>
<p>1. Determine which required skills your knowledge is sufficient<br />
2. Which required skills you need to work on<br />
3. Recommend specific skills to practice on next<br />
4. Track your progress towards a certification exam</p>

      </div>
      
    </aside>
  </div>
</div>    </div>      
    <script src="//platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>

<script>
window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));
</script>

<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=552038044933986";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script src="https://apis.google.com/js/platform.js" async defer></script>      
      <script>var postID = 582;</script>
    
    <script type='text/javascript'>
    			jQuery(function() {
    				jQuery( window ).on( 'init.icegram', function( e, ig ) {
				        jQuery('.ig_inline_container:empty').remove();
				    });
    			});
    		 </script>
<style type="text/css">
.ig_hide .wpcf7-response-output,
.ig_form_container .screen-reader-response{
	display: none !important;
}
.ig_show .ig_form_container.layout_bottom .wpcf7-response-output,
.ig_show .ig_form_container.layout_right .wpcf7-response-output,
.ig_show .ig_form_container.layout_left .wpcf7-response-output{
	background-color: #FFF;
	color: #444;
	position: absolute;
}
.ig_sidebar .ig_form_bottom.ig_show .ig_form_container.layout_bottom .wpcf7-response-output{
	bottom: 0;
}
.ig_overlay.ig_form_bottom.ig_show .ig_form_container.layout_bottom .wpcf7-response-output,
.ig_action_bar.ig_bottom.ig_show .ig_form_container.layout_right .wpcf7-response-output,
.ig_action_bar.ig_bottom.ig_show .ig_form_container.layout_left .wpcf7-response-output{
	bottom: 100%;
}
</style>

<script type="text/javascript">
jQuery(function() {
  	jQuery( window ).on( "init.icegram", function(e, ig) {
	  	// Find and init all CF7 forms within Icegram messages/divs and init them
	  	if(ig){
		  	jQuery.each(ig.messages, function(i, msg){

		  		jQuery(msg.el).find('form input[name=_wpcf7]').each(function(){
			  		var form = jQuery(this).closest('form');
			  		if(form && !form.hasClass('ig_form_init_done')){
			  			if(form.closest('.ig_form_container').length > 0){
				  			if(form.parent().find('.screen-reader-response').length == 0){
				  				form.before('<div class="screen-reader-response"></div>')
				  			}
				  			if(form.find('wpcf7-response-output').length == 0){
				  				form.append('<div class="wpcf7-response-output wpcf7-display-none"></div>')
				  			}
					  		form.closest('.ig_form_container').attr('id', form.find('input[name=_wpcf7_unit_tag]').val()); //_wpcf7_unit_tag
			  			}
			  			form.wpcf7InitForm();
			  			form.addClass('ig_form_init_done');
			  		}
		  		});

		  	});
	  	}

  	}); // init.icegram
	
	// Dismiss response text/div when shown within icegram form container
	jQuery('body').on('click', '.ig_form_container .wpcf7-response-output', function(e) {
			jQuery(e.target).slideUp();
	});
	// Handle CTA function(s) after successful submission of form
  	jQuery( window ).on('wpcf7:mailsent', function(e) {
  		if( typeof icegram !== 'undefined'){
		  	var msg_id = (jQuery(e.target.closest('[id^=icegram_message_]')).attr('id') || '').split('_').pop() || 0 ;
		  	var ig_msg = icegram.get_message_by_id(msg_id) || undefined;
		  	if(ig_msg && ig_msg.data.cta === 'form_via_ajax' && ig_msg.data.cta_option_form_via_ajax == 'hide_on_success'){
				ig_msg.hide();
		  	}
  		}
	});

});
</script>

			<script type="text/javascript">
<!--
piCId = '1951';
piAId = '13882';


(function() {
	function async_load(){
		var s = document.createElement('script'); s.type = 'text/javascript';
		s.src = ('https:' == document.location.protocol ? 'https://pi' : 'http://cdn') + '.pardot.com/pd.js';
		var c = document.getElementsByTagName('script')[0]; c.parentNode.insertBefore(s, c);
	}
	if(window.attachEvent) { window.attachEvent('onload', async_load); }
	else { window.addEventListener('load', async_load, false); }
})();
-->
</script><script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.5'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/app.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"platform":"wordpress@4.3.3","language":"","remote_auth_s3":"W10= 826358b3aef3fbd81ce20ac347dfb4f18a073b72 1462459106","api_key":"1TA9XhBKpqfZxr6kJiBvCescmAiajXtudB0o4aJYPZguLsFA5bUOtWPGbsoOAiku","sso":{"name":"InfoSec Resources","button":false,"url":"http:\/\/resources.infosecinstitute.com\/wp-login.php","logout":"http:\/\/resources.infosecinstitute.com\/wp-login.php?action=logout","width":"800","height":"700"}},"disqusIdentifier":"582 http:\/\/infosec.wpengine.com\/?p=582","disqusShortname":"infosecinstituteresources","disqusTitle":"Tricks for Exploit Development","disqusUrl":"http:\/\/resources.infosecinstitute.com\/in-depth-seh-exploit-writing-tutorial-using-ollydbg\/","options":{"manualSync":false},"postId":"582"};
/* ]]> */
</script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/disqus-comment-system/media/js/disqus.js?ver=4.3.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"infosecinstituteresources"};
/* ]]> */
</script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.3.3'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/js/jquery/jquery.js?ver=1.11.3'></script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var icegram_pre_data = {"ajax_url":"http:\/\/resources.infosecinstitute.com\/wp-admin\/admin-ajax.php","post_obj":{"is_home":false,"page_id":582,"action":"display_messages","shortcodes":[],"cache_compatibility":"yes","device":"laptop"}};
/* ]]> */
</script>
<script type='text/javascript' src='http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/icegram/assets/js/main.js?ver=1.9.13'></script>

    
  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"40195a0833","applicationID":"8563997","transactionName":"b1NRMRdTChAEBRFaDlYZcgYRWwsNShUMXQZUUw==","queueTime":0,"applicationTime":2366,"atts":"QxRSR19JGR4=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
  
</html>