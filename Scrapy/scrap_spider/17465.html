
<!doctype html><head>
    <title>You Can Run, but You Can&#039;t Hide (SSH and other open services) - SANS Internet Storm Center </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-control" content="no-cache" />
    <meta property="og:site_name" content="SANS Internet Storm Center" />
    <meta property="og:locale" content="en_US" />
    <meta name="DESCRIPTION" content="SANS Internet Storm Center - A global cooperative cyber threat / internet security monitor and alert system. Featuring daily handler diaries with summarizing and analyzing new threats to networks and internet security events."/>
    <meta name="AUTHOR" content="SANS Internet Storm Center"/>
    <meta name="KEYWORDS" content="isc, sans, internet, security, threat, worm, virus, phishing, hacking, vulnerability"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/iscfavicon.ico" />
    <link rel="canonical" href="https://isc.sans.edu%2Fforums%2Findex.html" />
    <link type="text/css" rel="stylesheet" href="/css/screen.css" /><!-- this is not the comment you are looking for d3678a5df8 -->
</head><body class="isc">
<div id="container">
  <div id="topWrapper">
    <div class="g">
      <span class="threatLevel">
        Threat Level: <a href="/infocon.html">green</a>
      </span>
      <span class="currentHandler">
        Handler on Duty: <a title="Brad Duncan" href="/handler_list.html#brad-duncan">Brad Duncan</a>
      </span>
    </div>

  </div>
	<h1>
    <a href="/">SANS ISC: You Can Run, but You Can't Hide (SSH and other open services) - SANS Internet Storm Center  <span></span></a>
    <ul class="site-selector">
      <li class="site-switcher"><a href="#"><span class="hidden">SANS Site Network</span></a>
        <ul class="sites">
          <li class="current-site">Current Site</li>
          <li class="isc"><a href="https://isc.sans.edu">
            <span></span>
            Internet Storm Center
          </a></li>
          <li class="selector-help">Other SANS Sites
            <a href="https://www.sans.org/help/site-network"><span class="hidden">Help</span></a>
          </li>
          <li class="sti"><a href="http://www.sans.edu">
            <span></span>
            Graduate Degree Programs
          </a></li>
          <li class="sans"><a href="http://www.sans.org">
            <span></span>
            Security Training
          </a></li>
          <li class="giac"><a href="http://www.giac.org">
            <span></span>
            Security Certification
          </a></li>
          <li class="awareness"><a href="http://www.securingthehuman.org">
            <span></span>
            Security Awareness Training
          </a></li>
          <li class="pentest"><a href="http://pen-testing.sans.org">
            <span></span>
            Penetration Testing
          </a></li>
          <li class="ics"><a href="http://ics.sans.org">
            <span></span>
            Industrial Control Systems
          </a></li>
          <li class="cyber-defense"><a href="http://cyber-defense.sans.org">
            <span></span>
            Cyber Defense Foundations
          </a></li>
          <li class="forensics"><a href="http://computer-forensics.sans.org">
            <span></span>
            Computer Forensics
          </a></li>
          <li class="ssi"><a href="http://software-security.sans.org">
            <span></span>
            Software Security
          </a></li>
          <li class="sic"><a href="http://sic.sans.org">
            <span></span>
            Government OnSite Training
          </a></li>
        </ul>
      </li>
    </ul>
    SANS ISC InfoSec Forums
	</h1>
	<form id="headerSearch" name="searchform" action="/search.html" method="post">
        <input type="text" name="q" placeholder="Keyword, Domain, Port, IP or Header" />
        <input type="submit" value="Search" />
	</form>
    <form id="headerLogin" method="post" action="/login.html" name="loginform">
        <input type="hidden" name="token" value="dea921df6a0f3cae1c57c0c1de8735651e8acf85" />
        <input type="text" name="email" placeholder="Email" />
        <input type="password" name="pw" autocomplete="off" placeholder="Password" />
        <input type="submit" value="Log In" /><br />
        <a href="/register.html">Sign Up for Free!</a> &nbsp; <a href="/resetpassword.html">Forgot Password?</a>
	</form>
	<div id="smallHeaderLogin">
	    <a href="/login.html">Log In</a> or <a href="/register.html">Sign Up for Free</a>!
	</div>
	<div id="content">
		<div class="wrapper">
                                <div class="beforeForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/Taking+care+when+publishing+Citrix+services+inside+the+corporate+network+or+to+the+Internet/17471/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/Learning+from+the+breaches+that+happens+to+others/17477/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div>
                                <table class="postList">
                                <caption>You Can Run, but You Can't Hide (SSH and other open services)</caption>
                                        <tr class="postWrapper">
                                            <td class="content">
                                                <div class="ss-container">
                                                    <ul class="ss-share">
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-facebook" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F17465" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-twitter" title="Share on Twitter" href="http://twitter.com/share?text=You%20Can%20Run%2C%20but%20You%20Can%27t%20Hide%20%28SSH%20and%20other%20open%20services%29&amp;url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F17465&amp;via=SANS_ISC" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-google" title="Share on Google+" href="http://plus.google.com/share?url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F17465" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div><p>
	In any study of internet traffic, you&#39;ll notice that one of the top activities of attackers is to mount port scans looking for open SSH servers, usually followed by sustained brute-force attacks.&nbsp; On customer machines that I&#39;ve worked on, anything with an open port tcp/22 for SSH, SFTP (FTP over SSH) or SCP will have so many login attempts on these ports that using the system logs to troubleshoot any other problem on the system can become very difficult.</p>
<p>
	We&#39;ve written this up many times, and often one of the initial things people do - thinking that this will protect them - is move their SSH service to some other port.&nbsp; Often people will choose 2222, 222 or some &quot;logical&quot; variant as their new home for SSH, this really just takes away the background noise of automated attacks, real attackers will still find your service.&nbsp; We&#39;ve covered this phenomena and real options for protecting open services like SSH in the past (google for <strong>ssh inurl:isc.sans.edu</strong> for a list)</p>
<p>
	What got me thinking about this was a bit of &quot;data mining&quot; I did the other night in the Dshield database using the reporting interfaces on the ISC site, as well as our API.&nbsp; Port 22 traffic of course remains near the top of our list of ports being attacked:<br />
	<strong>https://isc.sans.edu/port.html?startdate=2013-01-01&amp;enddate=2014-01-16&amp;port=22&amp;yname=sources&amp;y2name=targets</strong></p>
<p>
	<img alt="" src="https://isc.sans.edu/diaryimages/images/port_22.png" style="width: 832px; height: 823px;" /></p>
<p>
	However, this past week we saw an unusual spike in TCP port 222:<br />
	<strong>https://isc.sans.edu/api/topports/records/10/2014-01-13</strong><br />
	and<br />
	<strong>https://isc.sans.edu/api/topports/records/10/2014-01-14</strong></p>
<p>
	<img alt="" src="https://isc.sans.edu/diaryimages/images/port_222_api.png" style="width: 589px; height: 516px;" /></p>
<p>
	&nbsp;</p>
<p>
	On the 14th, port 222 actually topped our list.&nbsp; This event only lasted 2 days, and was primarily sourced by only two IP addresses.&nbsp; Note the other spike in December.</p>
<p>
	<strong>https://isc.sans.edu/port.html?port=222</strong></p>
<p>
	<img alt="" src="https://isc.sans.edu/diaryimages/images/port_222.png" style="width: 825px; height: 827px;" /></p>
<p>
	&nbsp;</p>
<p>
	This looked like a full internet scan for port 222, sourced from these two addresses (I won&#39;t call them out here).&nbsp; Looking closer at the IP&#39;s, they didn&#39;t look like anything special, in fact one was in a DSL range, so two days for a full scan is about right, given the fast scanning tools we have these days and bandwidth a home user will usually have.</p>
<p>
	<strong>The moral of the story?</strong>&nbsp; No matter where you move your listening TCP ports to, there is someone who is scanning that port looking for your open service.&nbsp; Using a &quot;logical&quot; approach to picking a new port number (for instance, 222 for scp or ssh, 2323 for telnet and so on) just makes the job easier for the attacker.&nbsp; And that&#39;s just accounting for automated tools doing indiscriminate scanning.&nbsp; If your organization is being targetted, a full port scan on your entire IP range takes only a few minutes to set up and will complete within an hour - even if it&#39;s on a &quot;low and slow&quot; timer (to avoid your IPS or to keep the log entry count down), it&#39;ll likely be done within a day or two.&nbsp; Moving your open service to a non-standard port is no protection at all if you are being targetted.</p>
<p>
	If you don&#39;t absolutely need to have a service on the public internet, close the port.&nbsp; If you need to offer the service, put it behind a VPN so that only authorized folks can get to it.&nbsp; And in almost all cases, you don&#39;t need that SSH port (whatever the port number is) open to the entire internet.&nbsp; Restricting it to a known list of IP addresses or better yet, putting it behind a VPN is by far the best way to go.&nbsp; If you <strong>MUST </strong>have &quot;common target&quot; services like SSH open to the internet, use certificates rather than or in addition to simple credentials, and consider implementing rate limiting services such as fail2ban, so that once the brute-force attacks start, you&#39;ve got a method to &quot;shun&quot; the attacker (though neither of these measures will protect you from a basic port scan).</p>
<p>
	===============<br />
	Rob VandenBrink<br />
	Metafore</p>
</div>
                                                <div>Tags: API, SSH</div>
                                            </td><td class="user">
                                            Rob VandenBrink<br />
                                                <img src="/gravatar_cache/cache/isc/42d88ad48accc79aa66628f304d21d2d" /><br />
                                                <span>382 Posts</span><br /><span>ISC Handler</span></td>
                                        </tr>
                                        <tr class="postFooter">
                                            <td class="actions">
                                                <a href="/forums/diary/reply/17465/">Reply</a>
                                        <a href="/forums/diary/subscribe/17465/">Subscribe</a>
                                            </td>
                                            <td class="time">
                                                2 years  ago
                                            </td>
                                        </tr>
                                    <tr class="postWrapper" id="29309">
                                        <td class="content">
                                            <div>Just to be clear though, port re-location for high traffic attack services is STILL a good idea. It does NOT reduce the risk from a targeted attack, but it DOES lower threat event frequency and often dramatically. This is a good thing, and in the case of one of your examples, should return your system logs back to a useable state for actual troubleshooting and other (even security) uses. <br />
Port re-location DOES make the job of detection and monitoring significantly easier in many cases. This benefit alone makes it a worthwhile move.<br />
However, I still agree, re-location is a last resort. Removal, compensating controls and hardening should always come first.</div>
                                        </td>
                                        <td class="user">
                                            Anonymous<br />
                                            <img src="/gravatar_cache/cache/isc/eea604738d3bb8c1028f21d41fec9c8d" /><br />
                                            <span>3 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29309">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="29312">
                                        <td class="content">
                                            <div>I've always found that requiring a client-side certificate on the device port does wonders. You don't have to mess with any configurations that might be reset to the default by upgrades and if someone tries to connect to the port and doesn't have the proper certificate, their connection gets dropped. End of problem.</div>
                                        </td>
                                        <td class="user">
                                            Anonymous<br />
                                            <img src="/gravatar_cache/cache/isc/071ce532cc8c1dcd5da0591459273f54" /><br />
                                            <span>190 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29312">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="29315">
                                        <td class="content">
                                            <div>Public key only for auth pretty much negates these scans. The old axiom &quot;security through obscurity is not security&quot;... is true, but moving off of port 22 to a non-obvious different port cuts down on the noise that is logged, making it easier to spot targeted attacks vs the random background &quot;script kiddy&quot; noise, and is worth doing for that reason alone in my opinion. One of the first things I would do (after enabling public key only auth) is move ports. Simple and easy to do and really no downside, so why not?</div>
                                        </td>
                                        <td class="user">
                                            Anonymous<br />
                                            <img src="/gravatar_cache/cache/isc/61fd585d475c5d6cfde3ea6e12c18c34" /><br />
                                            <span>1 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29315">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="29324">
                                        <td class="content">
                                            <div><blockquote><cite>Quoting <a href="/forums/diary/You+Can+Run+but+You+Cant+Hide+SSH+and+other+open+services/17465/1#29312">Anonymous</a>:</cite>I've always found that requiring a client-side certificate on the device port does wonders. </blockquote><br />
<br />
Yup.  Or requring a strong 2-factor authentication... <img src="/images/forums/smilies/Smile.png" alt=":-)" /></div>
                                        </td>
                                        <td class="user">
                                            Brent<br />
                                            <img src="/gravatar_cache/cache/isc/78a6bcd3c5f31937383c2be3ab24bcd2" /><br />
                                            <span>98 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29324">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="29327">
                                        <td class="content">
                                            <div>What comes to mind is closing off port 22 completely, and not allowing SSH from the world on any part.<br />
<br />
For a small number of systems used for SSH-based offsite access  to get into the network....  <br />
Port knocking, or rather....  fwknop<br />
http://www.cipherdyne.org/fwknop/</div>
                                        </td>
                                        <td class="user">
                                            Mysid<br />
                                            <img src="/gravatar_cache/cache/isc/abb6bbc9e4ada2971b6e6cd677b9766e" /><br />
                                            <span>144 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29327">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="29342">
                                        <td class="content">
                                            <div>Could this be happening by researchers who report out on scanning the Internet and the findings? I happen to know of at least one very prominent name in the security business who does this. Perhaps this may be an item to consider to filter out findings that are not as they seem.</div>
                                        </td>
                                        <td class="user">
                                            Anonymous<br />
                                            <img src="/gravatar_cache/cache/isc/4918dff1563a9ff23f975f1930594d7a" /><br />
                                            <span>2 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29342">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="29354">
                                        <td class="content">
                                            <div>We relocated ssh ports on about sixty client Internet-facing devices just to reduce log clutter, not as a security method. We were shocked to see attacks dropped from hundreds an hour to zero a year. I was surprised to see no scans. I expected the script kiddies to drop out; I just didn't expect to see no one else. We saw the same complete elimination of connection attempts whether it was SSH, VNC or RDC. We did see a few HTTP scans, but more than 99% connections of those simply stopped. We do do many of the other security methods mentioned, however, I was amazed to see security through obscurity working so well. <img src="/images/forums/smilies/Smile.png" alt=":-)" /><br />
<br />
I am not complaining, just bemused.</div>
                                        </td>
                                        <td class="user">
                                            Rastech<br />
                                            <img src="/gravatar_cache/cache/isc/e6b200056748193aad4eb9cfbd77f93c" /><br />
                                            <span>17 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29354">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="29357">
                                        <td class="content">
                                            <div>While security researchers must contribute some traffic, I doubt it is appreciable.<br />
<br />
Out of the last 65,000 SSH probes we logged, 62,000 were from China, 3,000 from schools, dark net, and places such as Ukraine, Kazakhstan, etc, and only a fraction from &quot;known&quot; addresses. Some of those could be security researchers, but I doubt much.</div>
                                        </td>
                                        <td class="user">
                                            Rastech<br />
                                            <img src="/gravatar_cache/cache/isc/e6b200056748193aad4eb9cfbd77f93c" /><br />
                                            <span>17 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/17465/">Reply</a>
                                            <a href="/forums/diary/quote/29357">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 years  ago
                                        </td>
                                    </tr>
                                </table>
                                <div class="afterForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/Taking+care+when+publishing+Citrix+services+inside+the+corporate+network+or+to+the+Internet/17471/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/Learning+from+the+breaches+that+happens+to+others/17477/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div><p><a href="/register.html">Sign Up for Free</a> or <a href="/login.html">Log In</a> to start participating in the conversation!</p>
        </div>
    </div>
    <div id="navigation">
        <ul>
            <li><a href="/contact.html">Contact Us</a>
                <ul>
                    <li class="first"><a href="/about.html">About Us</a></li>
                    <li><a href="/handler_list.html">Handlers</a></li>
                    <li><a href="/events">Events</a></li>
                </ul>
            </li>
            <li><a href="/diaryarchive.html">Diary</a></li>
            <li><a href="/podcast.html">Podcasts</a></li>
            <li><a href="/jobs">Jobs</a></li>
            <li><a href="/newssummary.html">News</a></li>
            <li><a href="/tools/">Tools</a>
                <ul>
                    <li class="first"><a href="/howto.html">DShield Sensor</a></li>
                    <li><a href="/404project/">404Project</a></li>
                    <li><a href="/glossary.html">InfoSec Glossary</a></li>
                    <li><a href="/webhoneypot/index.html">Webhoneypot</a></li>
                    <li><a href="/fightback.html">Fightback</a></li>
                </ul>
            </li>
            <li><a href="/reports.html">Data</a>
                <ul>
                    <li><a href="/ssh.html">SSH Scanning Activity</a></li>
                    <li><a href="/crls.html">SSL CRL Activity</a></li>
                    <li><a href="/port.html">TCP/UDP Port Activity</a></li>
                    <li><a href="/httpheaders/">HTTP Header Activity</a></li>
                    <li><a href="/threatfeed.html">Threat Feeds Activity</a></li>
                    <li><a href="/threatmap.html">Threat Feeds Map</a></li>
                    <li><a href="/suspicious_domains.html">Suspicious Domains</a></li>
                    <li><a href="/presentations/">Presentations &amp; Papers</a></li>
                    <li><a href="/links.html">Useful InfoSec Links</a></li>
                    <li><a href="/poll.html">InfoSec Poll Results</a></li>
                </ul>
            </li>
            <li class="active"><a href="/forums/">Forums</a>
                <ul>
                    <li><a href="/forums/Auditing/">Auditing</a></li>
                    <li><a href="/forums/Diary+Discussions/">Diary Discussions</a></li>
                    <li><a href="/forums/Forensics/">Forensics</a></li>
                    <li><a href="/forums/General+Discussion/">General Discussions</a></li>
                    <li><a href="/forums/Industry+News/">Industry News</a></li>
                    <li><a href="/forums/Network+Security/">Network Security</a></li>
                    <li><a href="/forums/Penetration+Testing/">Penetration Testing</a></li>
                    <li><a href="/forums/Software+Security/">Software Security</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="sidebar">
        <p>Have you heard our daily podcast covering the latest <a href="/podcast.html">information security threats</a>?</p>
        <iframe width="160" height="600" src="https://www.sans.org/banners/isc_ss.php" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>
	</div>
</div>
<div id="footer">
	<ul id="socialIconsFoot">
        <li><a href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A">YouTube<span></span></a></li>
        <li class="twitter"><a href="http://twitter.com/sans_isc">Twitter<span></span></a></li>
        <li class="linkedin"><a href="http://www.linkedin.com/groups?gid=35470">LinkedIn<span></span></a></li>
        <li class="rss"><a href="/xml.html">ISC Feed<span></span></a></li>
	</ul>
	<a class="sans" href="https://www.sans.edu/"><span></span></a>
	<ul id="footLinks">
        <li><a href="http://www.cafepress.com/stormcenter">Shop</a></li>
        <li><a href="/linkback.html">Link To Us</a></li>
        <li><a href="/about.html">About Us</a></li>
        <li><a href="/handler_list.html">Handlers</a></li>
        <li><a href="/privacy.html">Privacy Policy</a></li>
        <li><a href="#top">Back To Top</a></li>
	</ul>
	<strong>Developers:</strong> We have an <a href="/api/">API</a> for you! &nbsp; <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="/images/cc.png" /></a>
</div>
</body></html>