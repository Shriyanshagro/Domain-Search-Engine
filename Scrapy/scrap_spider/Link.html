<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8"/>
<title>Link/cut tree - Wikipedia, the free encyclopedia</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Link/cut_tree","wgTitle":"Link/cut tree","wgCurRevisionId":686474654,"wgRevisionId":686474654,"wgArticleId":9328337,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Link/cut_tree","wgRelevantArticleId":9328337,"wgRequestId":"VysxLApAMFUAAIkqU7oAAABV","wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"preview":false,"publish":false},"wgBetaFeaturesFeatures":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","usePageImages":true,"usePageDescriptions":true},"wgMFMode":"stable","wgMFLazyLoadImages":false,"wgMFLazyLoadReferences":false,"wgPreferredVariant":"en","wgRelatedArticles":null,"wgRelatedArticlesUseCirrusSearch":true,"wgRelatedArticlesOnlyUseCirrusSearch":false,"wgULSAcceptLanguageList":["en-us"],"wgULSCurrentAutonym":"English","wgFlaggedRevsParams":{"tags":{"status":{"levels":1,"quality":2,"pristine":3}}},"wgStableRevisionId":null,"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}","wgNoticeProject":"wikipedia","wgCentralNoticeCategoriesUsingLegacy":["Fundraising","fundraising"],"wgCentralAuthMobileDomain":true,"wgWikibaseItemId":"Q6554218","wgVisualEditorToolbarScrollOffset":0,"wgMinervaMenuData":{"discovery":[{"name":"home","components":[{"text":"Home","href":"/wiki/Main_Page","class":"mw-ui-icon mw-ui-icon-before mw-ui-icon-home ","data-event-name":"home"}]},{"name":"random","components":[{"text":"Random","href":"/wiki/Special:Random/#/random","class":"mw-ui-icon mw-ui-icon-before mw-ui-icon-random ","id":"randomButton","data-event-name":"random"}]},{"name":"nearby","components":[{"text":"Nearby","href":"/wiki/Special:Nearby","class":"mw-ui-icon mw-ui-icon-before mw-ui-icon-nearby nearby","data-event-name":"nearby"}],"class":"jsonly"}],"personal":[{"name":"watchlist","components":[{"text":"Watchlist","href":"/w/index.php?title=Special:UserLogin\u0026returnto=Special%3AWatchlist\u0026warning=mobile-frontend-watchlist-purpose","class":"mw-ui-icon mw-ui-icon-before mw-ui-icon-watchlist ","data-event-name":"watchlist"}],"class":"jsonly"},{"name":"settings","components":[{"text":"Settings","href":"/w/index.php?title=Special:MobileOptions\u0026returnto=Link%2Fcut+tree","class":"mw-ui-icon mw-ui-icon-before mw-ui-icon-mobileoptions ","data-event-name":"settings"}]},{"name":"auth","components":[{"text":"Log in","href":"/w/index.php?title=Special:UserLogin\u0026returnto=Link%2Fcut+tree\u0026returntoquery=welcome%3Dyes","class":"mw-ui-icon mw-ui-icon-before mw-ui-icon-anonymous-white ","data-event-name":"login"}],"class":"jsonly"}],"sitelinks":[{"name":"about","components":[{"text":"About Wikipedia","href":"/wiki/Wikipedia:About","class":""}]},{"name":"disclaimers","components":[{"text":"Disclaimers","href":"/wiki/Wikipedia:General_disclaimer","class":""}]}]},"wgMinervaTocEnabled":true});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup","skins.minerva.scripts.top","ext.centralNotice.bannerController.mobile","ext.centralauth.centralautologin","ext.quicksurveys.init"]);});</script>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=ext.gadget.switcher%7Cext.math.styles%7Cmediawiki.raggett%7Cmediawiki.ui.button%2Cicon%7Cskins.minerva.base.reset%2Cstyles%7Cskins.minerva.content.styles%7Cskins.minerva.icons.images%7Cskins.minerva.tablet.styles&amp;only=styles&amp;skin=minerva&amp;target=mobile"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<script async="" src="/w/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=minerva&amp;target=mobile"></script>
<meta name="generator" content="MediaWiki 1.27.0-wmf.22"/>
<meta name="referrer" content="origin-when-cross-origin"/>
<meta name="viewport" content="initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0, width=device-width"/>
<link rel="alternate" href="android-app://org.wikipedia/http/en.m.wikipedia.org/wiki/Link/cut_tree"/>
<link rel="apple-touch-icon" href="/static/apple-touch/wikipedia.png"/>
<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=Link/cut_tree&amp;action=edit"/>
<link rel="edit" title="Edit this page" href="/w/index.php?title=Link/cut_tree&amp;action=edit"/>
<link rel="apple-touch-icon" href="/static/apple-touch/wikipedia.png"/>
<link rel="shortcut icon" href="/static/favicon/wikipedia.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="//en.wikipedia.org/w/api.php?action=rsd"/>
<link rel="copyright" href="//creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="canonical" href="https://en.wikipedia.org/wiki/Link/cut_tree"/>
<link rel="dns-prefetch" href="//meta.wikimedia.org" />
</head>
<body class="mediawiki ltr sitedir-ltr stable skin-minerva action-view">

<div id="mw-mf-viewport">
	<nav id="mw-mf-page-left" class="navigation-drawer view-border-box">
		
	</nav>
	<div id="mw-mf-page-center">
		<div class="banner-container">
			<div id="siteNotice"></div>

		</div>
		<div class="header">
			<div><a title="Open main menu" href="/wiki/Special:MobileMenu" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-mainmenu main-menu-button" id="mw-mf-main-menu-button">Open main menu</a></div><form action="/w/index.php" class="search-box"><input type="search" name="search" placeholder="Search Wikipedia" title="Search Wikipedia [f]" accesskey="f" id="searchInput" class="search" autocomplete="off"/><input type="submit" name="fulltext" value="Search" title="Search Wikipedia for this text" class="mw-ui-button mw-ui-progressive fulltext-search no-js-only"/></form><div></div>
		</div>
		<div id="content" class="mw-body">
			<div class="pre-content heading-holder"><ul id="page-actions" class="hlist jsonly"><li id="ca-edit" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled" title="Edit the lead section of this page."><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=0">Edit this page</a></li><li id="ca-watch" class="mw-ui-icon mw-ui-icon-element icon-32px watch-this-article"><a is_js_only="1" href="/w/index.php?title=Special:UserLogin&amp;returnto=Link%2Fcut+tree" title="Add this page to your watchlist [w]" accesskey="w"></a></li></ul><h1 id="section_0">Link/cut tree</h1></div><div id="bodyContent" class="content"><div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mf-section-0"><table class="metadata plainlinks ambox ambox-style ambox-No_footnotes" role="presentation"><tr><td class="mbox-image">
<div style="width:52px"><img alt="" src="//upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Text_document_with_red_question_mark.svg/40px-Text_document_with_red_question_mark.svg.png" width="40" height="40" data-file-width="48" data-file-height="48"></div>
</td>
<td class="mbox-text"><span class="mbox-text-span">This article includes a <a href="/wiki/Wikipedia:Citing_sources" title="Wikipedia:Citing sources">list of references</a>, related reading or <a href="/wiki/Wikipedia:External_links" title="Wikipedia:External links">external links</a>, <b>but its sources remain unclear because it lacks <a href="/wiki/Wikipedia:Citing_sources#Inline_citations" title="Wikipedia:Citing sources">inline citations</a></b>. <span class="hide-when-compact">Please <a href="/wiki/Wikipedia:WikiProject_Fact_and_Reference_Check" title="Wikipedia:WikiProject Fact and Reference Check">improve</a> this article by introducing more precise citations.</span> <small><i>(October 2015)</i></small> <small class="hide-when-compact"><i>(<a href="/wiki/Help:Maintenance_template_removal" title="Help:Maintenance template removal">Learn how and when to remove this template message</a>)</i></small></span></td>
</tr></table><table class="infobox" style="width:22em"><tr><th colspan="2" style="text-align:center;font-size:125%;font-weight:bold">Link/cut tree</th>
</tr><tr><th scope="row">Type</th>
<td><a href="/wiki/Tree" title="Tree">Tree</a></td>
</tr><tr><th scope="row">Invented</th>
<td>1982</td>
</tr><tr><th scope="row">Invented by</th>
<td>
<div class="plainlist">
<ul><li><span class="nowrap"><a href="/wiki/Daniel_Dominic_Sleator" title="Daniel Dominic Sleator" class="mw-redirect">Daniel Dominic Sleator</a></span></li>
<li><a href="/wiki/Robert_Endre_Tarjan" title="Robert Endre Tarjan" class="mw-redirect">Robert Endre Tarjan</a></li>
</ul></div>
</td>
</tr><tr><th colspan="2" style="text-align:center;background:#D6D6F5"><a href="/wiki/Time_complexity" title="Time complexity">Time complexity</a> in <a href="/wiki/Big_O_notation" title="Big O notation">big O notation</a></th>
</tr><tr><td colspan="2" style="text-align:center">
<table><tr style="vertical-align:top"><th scope="col"></th>
<th scope="col">Average</th>
<th scope="col">Worst case</th>
</tr><tr style="vertical-align:top"><td><b>Link</b></td>
<td>O(log n)</td>
<td>amortized O(log n)</td>
</tr><tr style="vertical-align:top"><td><b>Cut</b></td>
<td>O(log n)</td>
<td>amortized O(log n)</td>
</tr><tr style="vertical-align:top"><td><b>Path</b></td>
<td>O(log n)</td>
<td>amortized O(log n)</td>
</tr><tr style="vertical-align:top"><td><b>FindRoot</b></td>
<td>O(log n)</td>
<td>amortized O(log n)</td>
</tr></table></td>
</tr></table><p>A <b>link/cut tree</b> is a <a href="/wiki/Data_structure" title="Data structure">data structure</a> for representing a <a href="/wiki/Forest_(graph_theory)" title="Forest (graph theory)" class="mw-redirect">forest</a>, a set of <a href="/wiki/Rooted_tree" title="Rooted tree" class="mw-redirect">rooted trees</a>, and offers the following operations:</p>
<ul><li>Add a tree consisting of a single node to the forest.</li>
<li>Given a node in one of the trees, disconnect it (and its subtree) from the tree of which it is part.</li>
<li>Attach a node to another node as its child.</li>
<li>Given a node, find the root of the tree to which it belongs. By doing this operation on two distinct nodes, one can check whether they belong to the same tree.</li>
</ul><p>The represented forest may consist of very deep trees, so if we represent the forest as a plain collection of <a href="/wiki/Parent_pointer_tree" title="Parent pointer tree">parent pointer trees</a>, it might take us a long time to find the root of a given node. However, if we represent each tree in the forest as a link/cut tree, we can find which tree an element belongs to in O(log(n)) amortized time. Moreover, we can quickly adjust the collection of link/cut trees to changes in the represented forest. In particular, we can adjust it to merge (link) and split (cut) in <a href="/wiki/Big_O_notation" title="Big O notation">O</a>(<a href="/wiki/Logarithm" title="Logarithm">log</a>(n)) <a href="/wiki/Amortized_analysis" title="Amortized analysis">amortized</a> time.</p>
<p>Link/cut trees divide each tree in the represented forest into vertex-disjoint paths, where each path is represented by an auxiliary tree (often <a href="/wiki/Splay_trees" title="Splay trees" class="mw-redirect">splay trees</a>, though the original paper predates splay trees and thus uses biased binary search trees). The nodes in the auxiliary trees are keyed by their depth in the corresponding represented tree. In one variation, <i>Naive Partitioning</i>, the paths are determined by the most recently accessed paths and nodes, similar to <a href="/wiki/Tango_Trees" title="Tango Trees" class="mw-redirect">Tango Trees</a>. In <i>Partitioning by Size</i> paths are determined by the heaviest child (child with the most children) of the given node. This gives a more complicated structure, but reduces the cost of the operations from amortized O(log n) to worst case O(log n). It has uses in solving a variety of network flow problems and to jive data sets.</p>
<p>In the original publication, <a href="/wiki/Daniel_Sleator" title="Daniel Sleator">Sleator</a> and <a href="/wiki/Robert_Tarjan" title="Robert Tarjan">Tarjan</a> referred to link/cut trees as “dynamic trees”, or "dynamic dyno trees".</p>
<p></p>
<div id="toc" class="toc-mobile"><h2>Contents</h2></div></div><h2 class="section-heading in-block"><div class="mw-ui-icon mw-ui-icon-element indicator"></div><span class="mw-headline" id="Structure">Structure</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=1" title="Edit section: Structure" data-section="1" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h2><div class="mf-section-1">
<p>We take a tree where each node has an arbitrary degree of unordered nodes and split it into paths. We call this the <i>represented tree</i>. These paths are represented internally by auxiliary trees (here we will use splay trees), where the nodes from left to right represent the path from root to the last node on the path. Nodes that are connected in the represented tree that are not on the same preferred path (and therefore not in the same auxiliary tree) are connected via a <i>path-parent pointer</i>. This pointer is stored in the root of the auxiliary tree representing the path.</p>
<div class="thumb tright">
<div class="thumbinner" style="width:473px;"><a href="/wiki/File:LinkCutAccess1.png" class="image"><img alt="" src="//upload.wikimedia.org/wikipedia/commons/a/aa/LinkCutAccess1.png" width="471" height="133" class="thumbimage" data-file-width="471" data-file-height="133"></a>
<div class="thumbcaption">Demonstrating how nodes are stored by depth in the link-cut tree</div>
</div>
</div>
<h3 class="in-block"><span class="mw-headline" id="Preferred_Paths">Preferred Paths</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=2" title="Edit section: Preferred Paths" data-section="2" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h3>
<p>When an access to a node <i>v</i> is made on the <i>represented tree</i>, the path that is taken becomes the <b>preferred path</b>. The <b>preferred child</b> of a node is the last child that was on the access path, or null if the last access was to <i>v</i> or if no accesses were made to this particular branch of the tree. A <b>preferred edge</b> is the edge that connects the <b>preferred child</b> to <i>v</i>.</p>
<p>In an alternate version, preferred paths are determined by the heaviest child.</p>
<div class="thumb tright">
<div class="thumbinner" style="width:562px;"><a href="/wiki/File:Linkcuttree1.png" class="image"><img alt="" src="//upload.wikimedia.org/wikipedia/commons/9/98/Linkcuttree1.png" width="560" height="349" class="thumbimage" data-file-width="560" data-file-height="349"></a>
<div class="thumbcaption">Showing how a link cut tree transforms preferred paths into a forest of trees.</div>
</div>
</div>
</div><h2 class="section-heading in-block"><div class="mw-ui-icon mw-ui-icon-element indicator"></div><span class="mw-headline" id="Operations">Operations</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=3" title="Edit section: Operations" data-section="3" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h2><div class="mf-section-2">
<p>The operations we are interested in are FindRoot(Node v), Cut(Node v), Link(Node v, Node w), and Path(Node v). Every operation is implemented using the Access(Node v) subroutine. When we <i>access</i> a vertex <i>v</i>, the preferred path of the represented tree is changed to a path from the root <i>R</i> of the represented tree to the node <i>v</i>. If a node on the access path previously had a preferred child <i>u</i>, and the path now goes to child <i>w</i>, the old <i>preferred edge</i> is deleted (changed to a <i>path-parent pointer</i>), and the new path now goes through <i>u</i>.</p>
<h3 class="in-block"><span class="mw-headline" id="Access">Access</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=4" title="Edit section: Access" data-section="4" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h3>
<p>After performing an access to node <i>v</i>, it will no longer have any preferred children, and will be at the end of the path. Since nodes in the auxiliary tree are keyed by depth, this means that any nodes to the right of <i>v</i> in the auxiliary tree must be disconnected. In a splay tree this is a relatively simple procedure; we splay at <i>v</i>, which brings <i>v</i> to the root of the auxiliary tree. We then disconnect the right subtree of <i>v</i>, which is every node that came below it on the previous preferred path. The root of the disconnected tree will have a path-parent pointer, which we point to <i>v</i>.</p>
<p>We now walk up the represented tree to the root <i>R</i>, breaking and resetting the preferred path where necessary. To do this we follow the path-parent pointer from <i>v</i> (since <i>v</i> is now the root, we have direct access to the path-parent pointer). If the path that <i>v</i> is on already contains the root <i>R</i> (since the nodes are keyed by depth, it would be the left most node in the auxiliary tree), the path-parent pointer will be null, and we are done the access. Otherwise we follow the pointer to some node on another path <i>w</i>. We want to break the old preferred path of <i>w</i> and reconnect it to the path <i>v</i> is on. To do this we splay at <i>w</i>, and disconnect its right subtree, setting its path-parent pointer to <i>w</i>. Since all nodes are keyed by depth, and every node in the path of <i>v</i> is deeper than every node in the path of <i>w</i> (since they are children of <i>w</i> in the represented tree), we simply connect the tree of <i>v</i> as the right child of <i>w</i>. We splay at <i>v</i> again, which, since <i>v</i> is a child of the root <i>w</i>, simply rotates <i>v</i> to root. We repeat this entire process until the path-parent pointer of <i>v</i> is null, at which point it is on the same preferred path as the root of the represented tree <i>R</i>.</p>
<div class="thumb tright">
<div class="thumbinner" style="width:416px;"><a href="/wiki/File:LinkCutAccess2.png" class="image"><img alt="" src="//upload.wikimedia.org/wikipedia/commons/7/72/LinkCutAccess2.png" width="414" height="117" class="thumbimage" data-file-width="414" data-file-height="117"></a>
<div class="thumbcaption">During an access old preferred paths are broken and replaced with path-parent pointers, while the accessed node is splayed to the root of the tree</div>
</div>
</div>
<h3 class="in-block"><span class="mw-headline" id="FindRoot">FindRoot</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=5" title="Edit section: FindRoot" data-section="5" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h3>
<p>FindRoot refers to finding the root of the represented tree that contains the node <i>v</i>. Since the <i>access</i> subroutine puts <i>v</i> on the preferred path, we first execute an access. Now the node <i>v</i> is on the same preferred path, and thus the same auxiliary tree as the root <i>R</i>. Since the auxiliary trees are keyed by depth, the root <i>R</i> will be the leftmost node of the auxiliary tree. So we simply choose the left child of <i>v</i> recursively until we can go no further, and this node is the root <i>R</i>. The root may be linearly deep (which is worst case for a splay tree), we therefore splay it so that the next access will be quick.</p>
<h3 class="in-block"><span class="mw-headline" id="Cut">Cut</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=6" title="Edit section: Cut" data-section="6" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h3>
<p>Here we would like to cut the represented tree at node <i>v</i>. First we access <i>v</i>. This puts all the elements lower than <i>v</i> in the represented tree as the right child of <i>v</i> in the auxiliary tree. All the elements now in the left subtree of <i>v</i> are the nodes higher than <i>v</i> in the represented tree. We therefore disconnect the left child of <i>v</i> (which still maintains an attachment to the original represented tree through its path-parent pointer). Now <i>v</i> is the root of a represented tree. Accessing <i>v</i> breaks the preferred path below <i>v</i> as well, but that subtree maintains its connection to <i>v</i> through its path-parent pointer.</p>
<h3 class="in-block"><span class="mw-headline" id="Link">Link</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=7" title="Edit section: Link" data-section="7" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h3>
<p>If <i>v</i> is a tree root and <i>w</i> is a vertex in another tree, link the trees containing <i>v</i> and <i>w</i> by adding the edge(v, w), making <i>w</i> the parent of <i>v</i>. To do this we access both <i>v</i> and <i>w</i> in their respective trees, and make <i>w</i> the left child of <i>v</i>. Since <i>v</i> is the root, and nodes are keyed by depth in the auxiliary tree, accessing <i>v</i> means that <i>v</i> will have no left child in the auxiliary tree (since as root it is the minimum depth). Adding <i>w</i> as a left child effectively makes it the parent of <i>v</i> in the represented tree.</p>
<h3 class="in-block"><span class="mw-headline" id="Path">Path</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=8" title="Edit section: Path" data-section="8" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h3>
<p>For this operation we wish to do some aggregate function over all the nodes (or edges) on the path to <i>v</i> (such as "sum" or "min" or "max" or "increase", etc.). To do this we access <i>v</i>, which gives us an auxiliary tree with all the nodes on the path from root <i>R</i> to node <i>v</i>. The data structure can be augmented with data we wish to retrieve, such as min or max values, or the sum of the costs in the subtree, which can then be returned from a given path in constant time.</p>
<div class="thumb tright">
<div class="thumbinner" style="width:258px;"><a href="/wiki/File:Pseudo-code.png" class="image"><img alt="" src="//upload.wikimedia.org/wikipedia/commons/4/4d/Pseudo-code.png" width="256" height="426" class="thumbimage" data-file-width="256" data-file-height="426"></a>
<div class="thumbcaption">Pseudo-code for link-cut tree operations</div>
</div>
</div>
</div><h2 class="section-heading in-block"><div class="mw-ui-icon mw-ui-icon-element indicator"></div><span class="mw-headline" id="Analysis">Analysis</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=9" title="Edit section: Analysis" data-section="9" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h2><div class="mf-section-3">
<p>Cut and link have O(1) cost, plus that of the access. FindRoot has an O(log n) amortized upper bound, plus the cost of the access. The data structure can be augmented with additional information (such as the min or max valued node in its subtrees, or the sum), depending on the implementation. Thus Path can return this information in constant time plus the access bound.</p>
<p>So the it remains to bound the <i>access</i> to find our running time.</p>
<p>Access makes use of splaying, which we know has an O(log n) amortized upper bound. So the remaining analysis deals with the number of times we need to splay. This is equal to the number of preferred child changes (the number of edges changed in the preferred path) as we traverse up the tree.</p>
<p>We bound <i>access</i> by using a technique called <b>Heavy-Light Decomposition</b>.</p>
<h3 class="in-block"><span class="mw-headline" id="Heavy-Light_Decomposition">Heavy-Light Decomposition</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=10" title="Edit section: Heavy-Light Decomposition" data-section="10" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h3>
<div role="note" class="hatnote relarticle mainarticle">Main article: <a href="/wiki/Heavy_path_decomposition" title="Heavy path decomposition">Heavy path decomposition</a></div>
<p>This technique calls an edge heavy or light depending on the number of nodes in the subtree. <i>Size(v)</i> represents the number of nodes in the subtree of <i>v</i> in the represented tree. An edge is called <i>heavy</i> if size(v) &gt; <span class="frac nowrap"><sup>1</sup>⁄<sub>2</sub></span> size(parent(v)). Thus we can see that each node can have at most 1 <i>heavy</i> edge. An edge that is not a <i>heavy</i> edge is referred to as a <i>light</i> edge.</p>
<p>The <i>light-depth</i> refers to the number of light edges on a given path from root to vertex <i>v</i>. <i>Light-depth</i> <img class="mwe-math-fallback-image-inline tex" alt="\leq " src="//upload.wikimedia.org/math/4/9/d/49dc1443f33cf63082d6e193dd2af78f.png"> lg <i>n</i> because each time we traverse a light-edge we decrease the number of nodes by at least a factor of 2 (since it can have at most half the nodes of the parent).</p>
<p>So a given edge in the represented tree can be any of four possibilities: <i>heavy-preferred</i>, <i>heavy-unpreferred</i>, <i>light-preferred</i> or <i>light-unpreferred</i>.</p>
<p>First we prove an <img class="mwe-math-fallback-image-inline tex" alt="O(\log^{2} n)" src="//upload.wikimedia.org/math/5/4/a/54a142f4f2720a3ae5ba25ace2303b27.png"> upper bound.</p>
<h4 class="in-block"><span class="mw-headline" id="O.28log_2_n.29_upper_bound">O(log <sup>2</sup> n) upper bound</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=11" title="Edit section: O(log 2 n) upper bound" data-section="11" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h4>
<p>The splay operation of the access gives us log <i>n</i>, so we need to bound the number of accesses to log <i>n</i> to prove the O(log <sup>2</sup> <i>n</i>) upper bound.</p>
<p>Every change of preferred edge results in a new preferred edge being formed. So we count the number of preferred edges formed. Since there are at most log <i>n</i> edges that are light on any given path, there are at most log <i>n</i> light edges changing to preferred.</p>
<p>The number of heavy edges becoming preferred can be O(n) for any given operation, but it is O(log n) amortized. Over a series of executions we can have <i>n</i>-1 heavy edges become preferred (as there are at most <i>n</i>-1 heavy edges total in the represented tree), but from then on the number of heavy edges that become preferred is equal to the number of heavy edges that became unpreferred on a previous step. For every heavy edge that becomes unpreferred a light edge must become preferred. We have seen already that the number of light edges that can become preferred is at most log <i>n</i>. So the number of heavy edges that become preferred for <i>m</i> operations is <i>m(log n) + (n - 1)</i>. Over enough operations (<i>m &gt; n-1</i>) this averages to O(log n).</p>
<h4 class="in-block"><span class="mw-headline" id="Improving_to_O.28log_n.29_upper_bound">Improving to O(log n) upper bound</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=12" title="Edit section: Improving to O(log n) upper bound" data-section="12" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h4>
<p>We have bound the number of preferred child changes at O(log n), so if we can show that each preferred child change has cost O(1) amortized we can bound the <i>access</i> operation at O(log n). This is done using the <a href="/wiki/Potential_method" title="Potential method">potential method</a>.</p>
<p>Let s(v) be the number of nodes under <i>v</i> in the tree of auxiliary trees. Then the potential function <img class="mwe-math-fallback-image-inline tex" alt="\Phi = \sum_{v} \log{s(v)}" src="//upload.wikimedia.org/math/a/9/c/a9cd9babe2b7e382a0a25e3691ffd626.png">. We know that the amortized cost of splaying is bounded by:</p>
<p><img class="mwe-math-fallback-image-inline tex" alt="cost(splay(v)) \leq 3 \left( \log{s(root(v))} - \log{s(v)} \right) + 1" src="//upload.wikimedia.org/math/4/1/7/41728297f7dbafe7b92162c42035a226.png"></p>
<p>We know that after splaying, <i>v</i> is the child of its path-parent node <i>w</i>. So we know that:</p>
<p><img class="mwe-math-fallback-image-inline tex" alt=" s(v) \leq s(w) " src="//upload.wikimedia.org/math/c/0/9/c09b08e6437ede3b289f0281e1868ad6.png"></p>
<p>We use this inequality and the amortized cost of access to achieve a telescoping sum that is bounded by:</p>
<p><img class="mwe-math-fallback-image-inline tex" alt=" 3\left(\log{s(R)} - \log{s(v)}\right) " src="//upload.wikimedia.org/math/f/8/c/f8c8d6207acff47643260ab0b96550a4.png"> <i>+ O(# of preferred child changes)</i></p>
<p>where <i>R</i> is the root of the represented tree, and we know the number of preferred child changes is O(log n). s(<i>R</i>) = <i>n</i>, so we have O(log n) amortized.</p>
</div><h2 class="section-heading in-block"><div class="mw-ui-icon mw-ui-icon-element indicator"></div><span class="mw-headline" id="Application">Application</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=13" title="Edit section: Application" data-section="13" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h2><div class="mf-section-4">
<p>Link/cut trees can be used to solve the <a href="/wiki/Dynamic_connectivity" title="Dynamic connectivity">dynamic connectivity</a> problem for acyclic graphs. Given two nodes x and y, they are connected if and only if FindRoot(x) = FindRoot(y). Another data structure that can be used for the same purpose is <a href="/wiki/Euler_tour_tree" title="Euler tour tree" class="mw-redirect">Euler tour tree</a>.</p>
<p>In solving the <a href="/wiki/Maximum_flow_problem" title="Maximum flow problem">maximum flow problem</a>, link/cut trees can be used to improve the running time of <a href="/wiki/Dinic%27s_algorithm" title="Dinic's algorithm">Dinic's algorithm</a> from <img class="mwe-math-fallback-image-inline tex" alt="O(V^2 E)" src="//upload.wikimedia.org/math/5/3/2/5321e09d73abc9170644b976e32e4363.png"> to <img class="mwe-math-fallback-image-inline tex" alt="O(VE \log V)" src="//upload.wikimedia.org/math/e/e/8/ee80854dc07b66e632debc19d5a558c5.png">.</p>
</div><h2 class="section-heading in-block"><div class="mw-ui-icon mw-ui-icon-element indicator"></div><span class="mw-headline" id="See_also">See also</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=14" title="Edit section: See also" data-section="14" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h2><div class="mf-section-5">
<ul><li><a href="/wiki/Splay_tree" title="Splay tree">Splay tree</a></li>
<li><a href="/wiki/Potential_method" title="Potential method">Potential method</a></li>
</ul></div><h2 class="section-heading in-block"><div class="mw-ui-icon mw-ui-icon-element indicator"></div><span class="mw-headline" id="Further_reading">Further reading</span><span><a href="/w/index.php?title=Link/cut_tree&amp;action=edit&amp;section=15" title="Edit section: Further reading" data-section="15" class="mw-ui-icon mw-ui-icon-element mw-ui-icon-edit-enabled edit-page">Edit</a></span></h2><div class="mf-section-6">
<div class="refbegin" style="">
<ul><li><cite class="citation book">Sleator, D. D.; Tarjan, R. E. (1983). "A Data Structure for Dynamic Trees". <a rel="nofollow" class="external text" href="http://www.cs.cmu.edu/~sleator/papers/dynamic-trees.pdf"><i>Proceedings of the thirteenth annual ACM symposium on Theory of computing - STOC '81</i></a> <span style="font-size:85%;">(PDF)</span>. p. 114. <a href="/wiki/Digital_object_identifier" title="Digital object identifier">doi</a>:<a rel="nofollow" class="external text" href="//dx.doi.org/10.1145%2F800076.802464">10.1145/800076.802464</a>.</cite><span title="ctx_ver=Z39.88-2004&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ALink%2Fcut+tree&amp;rft.atitle=A+Data+Structure+for+Dynamic+Trees&amp;rft.aufirst=D.+D.&amp;rft.aulast=Sleator&amp;rft.au=Tarjan%2C+R.+E.&amp;rft.btitle=Proceedings+of+the+thirteenth+annual+ACM+symposium+on+Theory+of+computing+-+STOC+%2781&amp;rft.date=1983&amp;rft.genre=bookitem&amp;rft_id=http%3A%2F%2Fwww.cs.cmu.edu%2F~sleator%2Fpapers%2Fdynamic-trees.pdf&amp;rft_id=info%3Adoi%2F10.1145%2F800076.802464&amp;rft.pages=114&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook" class="Z3988"><span style="display:none;"> </span></span></li>
<li><cite class="citation journal">Sleator, D. D.; Tarjan, R. E. (1985). <a rel="nofollow" class="external text" href="http://www.cs.cmu.edu/~sleator/papers/self-adjusting.pdf">"Self-Adjusting Binary Search Trees"</a> <span style="font-size:85%;">(PDF)</span>. <i><a href="/wiki/Journal_of_the_ACM" title="Journal of the ACM">Journal of the ACM</a></i> <b>32</b> (3): 652. <a href="/wiki/Digital_object_identifier" title="Digital object identifier">doi</a>:<a rel="nofollow" class="external text" href="//dx.doi.org/10.1145%2F3828.3835">10.1145/3828.3835</a>.</cite><span title="ctx_ver=Z39.88-2004&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ALink%2Fcut+tree&amp;rft.atitle=Self-Adjusting+Binary+Search+Trees&amp;rft.aufirst=D.+D.&amp;rft.aulast=Sleator&amp;rft.au=Tarjan%2C+R.+E.&amp;rft.date=1985&amp;rft.genre=article&amp;rft_id=http%3A%2F%2Fwww.cs.cmu.edu%2F~sleator%2Fpapers%2Fself-adjusting.pdf&amp;rft_id=info%3Adoi%2F10.1145%2F3828.3835&amp;rft.issue=3&amp;rft.jtitle=Journal+of+the+ACM&amp;rft.pages=652&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.volume=32" class="Z3988"><span style="display:none;"> </span></span></li>
<li><cite class="citation journal"><a href="/wiki/Andrew_V._Goldberg" title="Andrew V. Goldberg">Goldberg, A. V.</a>; <a href="/wiki/Robert_Tarjan" title="Robert Tarjan">Tarjan, R. E.</a> (1989). "Finding minimum-cost circulations by canceling negative cycles". <i><a href="/wiki/Journal_of_the_ACM" title="Journal of the ACM">Journal of the ACM</a></i> <b>36</b> (4): 873. <a href="/wiki/Digital_object_identifier" title="Digital object identifier">doi</a>:<a rel="nofollow" class="external text" href="//dx.doi.org/10.1145%2F76359.76368">10.1145/76359.76368</a>.</cite><span title="ctx_ver=Z39.88-2004&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ALink%2Fcut+tree&amp;rft.atitle=Finding+minimum-cost+circulations+by+canceling+negative+cycles&amp;rft.aufirst=A.+V.&amp;rft.aulast=Goldberg&amp;rft.au=Tarjan%2C+R.+E.&amp;rft.date=1989&amp;rft.genre=article&amp;rft_id=info%3Adoi%2F10.1145%2F76359.76368&amp;rft.issue=4&amp;rft.jtitle=Journal+of+the+ACM&amp;rft.pages=873&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.volume=36" class="Z3988"><span style="display:none;"> </span></span> — Application to min-cost circulation</li>
<li><a rel="nofollow" class="external text" href="http://courses.csail.mit.edu/6.851/spring12/scribe/L19.pdf">Link-Cut trees</a> in: lecture notes in advanced data structures, Spring 2012, lecture 19. Prof. Erik Demaine, Scribes: Scribes: Justin Holmgren (2012), Jing Jian (2012), Maksim Stepanenko (2012), Mashhood Ishaque (2007).</li>
<li><a rel="nofollow" class="external free" href="http://compgeom.cs.uiuc.edu/~jeffe/teaching/datastructures/2006/notes/07-linkcut.pdf">http://compgeom.cs.uiuc.edu/~jeffe/teaching/datastructures/2006/notes/07-linkcut.pdf</a></li>
</ul></div>
</div><noscript><img src="//en.wikipedia.org/wiki/Special:CentralAutoLogin/start?type=1x1&amp;mobile=1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" /></noscript></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://en.wikipedia.org/w/index.php?title=Link/cut_tree&amp;oldid=686474654">https://en.wikipedia.org/w/index.php?title=Link/cut_tree&amp;oldid=686474654</a>"</div>
</div><div class="post-content" id="page-secondary-actions"></div><div class="last-modified-bar view-border-box post-content">
	<div id="mw-mf-last-modified" class="truncated-text">
		<a href="/wiki/Special:History/Link/cut_tree"
			data-user-name="Qwertyus"
			data-user-gender="unknown"
			data-timestamp="1445247640">
			Last edited on 19 October 2015, at 09:40
		</a>
	</div>
</div>
		</div>
		<div id="footer" class="post-content"><ul class="footer-info"><li id="footer-info-mobile-switcher"><h2><img src="/static/images/mobile/wikipedia-wordmark-en.png" alt="Wikipedia&lt;sup&gt;®&lt;/sup&gt;" height="15" width="97"/><sup>®</sup></h2>
<ul>
	<li>Mobile</li><li><a id="mw-mf-display-toggle" href="//en.wikipedia.org/w/index.php?title=Link/cut_tree&amp;mobileaction=toggle_view_desktop">Desktop</a></li>
</ul></li><li id="footer-info-mobile-license">Content is available under <a class="external" rel="nofollow" href="//creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a> unless otherwise noted.</li></ul><ul class="footer-places"><li id="footer-places-terms-use"><a href="//m.wikimediafoundation.org/wiki/Terms_of_Use">Terms of Use</a></li><li id="footer-places-privacy"><a href="//wikimediafoundation.org/wiki/Privacy_policy" title="wmf:Privacy policy">Privacy</a></li></ul></div>
	</div>
</div>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"mobile.usermodule":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.user","skins.minerva.watchstar","skins.minerva.scripts","skins.minerva.editor","skins.minerva.toggling","mobile.site","ext.centralNotice.choiceData","ext.eventLogging.subscriber","ext.gadget.switcher","ext.visualEditor.targetLoader","ext.wikimediaEvents","ext.navigationTiming","schema.UniversalLanguageSelector"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":60,"wgHostname":"mw1250"});});</script>		</body>
		</html>
		